(window.webpackJsonp=window.webpackJsonp||[]).push([[2,13],{LZwC:function(e,t,r){e.exports=r.p+"883d226e79ab6a8bfe0352d3fc092da5.png"},RnhZ:function(e,t,r){var n={"./af":"K/tc","./af.js":"K/tc","./ar":"jnO4","./ar-dz":"o1bE","./ar-dz.js":"o1bE","./ar-kw":"Qj4J","./ar-kw.js":"Qj4J","./ar-ly":"HP3h","./ar-ly.js":"HP3h","./ar-ma":"CoRJ","./ar-ma.js":"CoRJ","./ar-sa":"gjCT","./ar-sa.js":"gjCT","./ar-tn":"bYM6","./ar-tn.js":"bYM6","./ar.js":"jnO4","./az":"SFxW","./az.js":"SFxW","./be":"H8ED","./be.js":"H8ED","./bg":"hKrs","./bg.js":"hKrs","./bm":"p/rL","./bm.js":"p/rL","./bn":"kEOa","./bn.js":"kEOa","./bo":"0mo+","./bo.js":"0mo+","./br":"aIdf","./br.js":"aIdf","./bs":"JVSJ","./bs.js":"JVSJ","./ca":"1xZ4","./ca.js":"1xZ4","./cs":"PA2r","./cs.js":"PA2r","./cv":"A+xa","./cv.js":"A+xa","./cy":"l5ep","./cy.js":"l5ep","./da":"DxQv","./da.js":"DxQv","./de":"tGlX","./de-at":"s+uk","./de-at.js":"s+uk","./de-ch":"u3GI","./de-ch.js":"u3GI","./de.js":"tGlX","./dv":"WYrj","./dv.js":"WYrj","./el":"jUeY","./el.js":"jUeY","./en-SG":"zavE","./en-SG.js":"zavE","./en-au":"Dmvi","./en-au.js":"Dmvi","./en-ca":"OIYi","./en-ca.js":"OIYi","./en-gb":"Oaa7","./en-gb.js":"Oaa7","./en-ie":"4dOw","./en-ie.js":"4dOw","./en-il":"czMo","./en-il.js":"czMo","./en-nz":"b1Dy","./en-nz.js":"b1Dy","./eo":"Zduo","./eo.js":"Zduo","./es":"iYuL","./es-do":"CjzT","./es-do.js":"CjzT","./es-us":"Vclq","./es-us.js":"Vclq","./es.js":"iYuL","./et":"7BjC","./et.js":"7BjC","./eu":"D/JM","./eu.js":"D/JM","./fa":"jfSC","./fa.js":"jfSC","./fi":"gekB","./fi.js":"gekB","./fo":"ByF4","./fo.js":"ByF4","./fr":"nyYc","./fr-ca":"2fjn","./fr-ca.js":"2fjn","./fr-ch":"Dkky","./fr-ch.js":"Dkky","./fr.js":"nyYc","./fy":"cRix","./fy.js":"cRix","./ga":"USCx","./ga.js":"USCx","./gd":"9rRi","./gd.js":"9rRi","./gl":"iEDd","./gl.js":"iEDd","./gom-latn":"DKr+","./gom-latn.js":"DKr+","./gu":"4MV3","./gu.js":"4MV3","./he":"x6pH","./he.js":"x6pH","./hi":"3E1r","./hi.js":"3E1r","./hr":"S6ln","./hr.js":"S6ln","./hu":"WxRl","./hu.js":"WxRl","./hy-am":"1rYy","./hy-am.js":"1rYy","./id":"UDhR","./id.js":"UDhR","./is":"BVg3","./is.js":"BVg3","./it":"bpih","./it-ch":"bxKX","./it-ch.js":"bxKX","./it.js":"bpih","./ja":"B55N","./ja.js":"B55N","./jv":"tUCv","./jv.js":"tUCv","./ka":"IBtZ","./ka.js":"IBtZ","./kk":"bXm7","./kk.js":"bXm7","./km":"6B0Y","./km.js":"6B0Y","./kn":"PpIw","./kn.js":"PpIw","./ko":"Ivi+","./ko.js":"Ivi+","./ku":"JCF/","./ku.js":"JCF/","./ky":"lgnt","./ky.js":"lgnt","./lb":"RAwQ","./lb.js":"RAwQ","./lo":"sp3z","./lo.js":"sp3z","./lt":"JvlW","./lt.js":"JvlW","./lv":"uXwI","./lv.js":"uXwI","./me":"KTz0","./me.js":"KTz0","./mi":"aIsn","./mi.js":"aIsn","./mk":"aQkU","./mk.js":"aQkU","./ml":"AvvY","./ml.js":"AvvY","./mn":"lYtQ","./mn.js":"lYtQ","./mr":"Ob0Z","./mr.js":"Ob0Z","./ms":"6+QB","./ms-my":"ZAMP","./ms-my.js":"ZAMP","./ms.js":"6+QB","./mt":"G0Uy","./mt.js":"G0Uy","./my":"honF","./my.js":"honF","./nb":"bOMt","./nb.js":"bOMt","./ne":"OjkT","./ne.js":"OjkT","./nl":"+s0g","./nl-be":"2ykv","./nl-be.js":"2ykv","./nl.js":"+s0g","./nn":"uEye","./nn.js":"uEye","./pa-in":"8/+R","./pa-in.js":"8/+R","./pl":"jVdC","./pl.js":"jVdC","./pt":"8mBD","./pt-br":"0tRk","./pt-br.js":"0tRk","./pt.js":"8mBD","./ro":"lyxo","./ro.js":"lyxo","./ru":"lXzo","./ru.js":"lXzo","./sd":"Z4QM","./sd.js":"Z4QM","./se":"//9w","./se.js":"//9w","./si":"7aV9","./si.js":"7aV9","./sk":"e+ae","./sk.js":"e+ae","./sl":"gVVK","./sl.js":"gVVK","./sq":"yPMs","./sq.js":"yPMs","./sr":"zx6S","./sr-cyrl":"E+lV","./sr-cyrl.js":"E+lV","./sr.js":"zx6S","./ss":"Ur1D","./ss.js":"Ur1D","./sv":"X709","./sv.js":"X709","./sw":"dNwA","./sw.js":"dNwA","./ta":"PeUW","./ta.js":"PeUW","./te":"XLvN","./te.js":"XLvN","./tet":"V2x9","./tet.js":"V2x9","./tg":"Oxv6","./tg.js":"Oxv6","./th":"EOgW","./th.js":"EOgW","./tl-ph":"Dzi0","./tl-ph.js":"Dzi0","./tlh":"z3Vd","./tlh.js":"z3Vd","./tr":"DoHr","./tr.js":"DoHr","./tzl":"z1FC","./tzl.js":"z1FC","./tzm":"wQk9","./tzm-latn":"tT3J","./tzm-latn.js":"tT3J","./tzm.js":"wQk9","./ug-cn":"YRex","./ug-cn.js":"YRex","./uk":"raLr","./uk.js":"raLr","./ur":"UpQW","./ur.js":"UpQW","./uz":"Loxo","./uz-latn":"AQ68","./uz-latn.js":"AQ68","./uz.js":"Loxo","./vi":"KSF8","./vi.js":"KSF8","./x-pseudo":"/X5v","./x-pseudo.js":"/X5v","./yo":"fzPg","./yo.js":"fzPg","./zh-cn":"XDpg","./zh-cn.js":"XDpg","./zh-hk":"SatO","./zh-hk.js":"SatO","./zh-tw":"kOpN","./zh-tw.js":"kOpN"};function a(e){var t=o(e);return r(t)}function o(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=o,e.exports=a,a.id="RnhZ"},b1Nn:function(e,t,r){"use strict";r.r(t);var n,a,o=r("vOnD"),i=r("q1tI"),c=r.n(i),l=r("i8i4"),s=r.n(l),u=r("iC7s"),d=r("q1z7"),p=r.n(d),f=r("Fi5S");function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e){e[e.Standard=0]="Standard",e[e.Small=1]="Small"}(n||(n={})),function(e){e.TogglePreview="togglePreview",e.ToggleSettingsSidebar="toggleSettingsSidebar",e.OpenSettingsSidebar="openSettingsSidebar",e.CloseSettingsSidebar="closeSettingsSidebar",e.CloseMagMenu="closeMagMenu",e.OpenMagMenu="openMagMenu",e.SetMagMenuOrientation="setMagMenuOrientation",e.SetMagMenu="setMagMenu",e.SetControlsOnTop="setControlsOnTop",e.ToggleTrash="toggleTrash",e.TogglePageSettings="togglePageSettings",e.SetProjectSettingsState="setProjectSettingsState",e.SetOldProjectSettingsState="setOldProjectSettingsState",e.ToggleHelpPopup="toggleHelpPopup",e.ToggleUserTemplatesModal="toggleUserTemplatesModal",e.ToggleRmTemplatesModal="toggleRmTemplatesModal",e.SetPageActionsPopup="setPageActionsPopup",e.ToggleGridSize="toggleGridSize",e.TogglePageSelection="togglePageSelection",e.SetDragging="setDragging",e.SetReadyToPublish="setReadyToPublish",e.SetAddingPage="setAddingPage",e.ToggleTeamworkModal="toggleTeamworkModal",e.SetNotice="setNotice"}(a||(a={}));var v=c.a.createContext({}),w={};try{var j=localStorage.getItem("rm_pageSettings");w=JSON.parse(j||"{}")}catch(e){}var S,O=function(e){var t=e.magModel,r=e.router,o=e.children,l={inPreview:!!r.previewMode,isSettingsOpened:p.a.history.getFragment().indexOf("/contents/")>-1,isMagMenuOpen:!1,isTrashOpened:!1,isPageSettingsOpened:!1,isProjectSettingsOpened:!1,isOldProjectSettingsOpened:!1,isHelpPopupOpened:!1,isUserTemplatesModalShown:!1,isRmTemplatesModalShown:!1,isPageActionsPopupOpenedFor:!1,gridSize:w.gridSize||n.Standard,selectedPages:{},isDragging:!1,magMenuOrientation:t.attributes.opts.viewertype,magMenuOn:t.attributes.opts.menubutton,controlsOnTop:t.attributes.opts.controlsontop,readyToPublish:!0,addingPage:!1,isTeamworkModalOpened:!1},s=function(e,t){var r=h({},e.selectedPages);return r[t]?delete r[t]:r[t]=!0,r},u=m(Object(i.useReducer)((function(e,t){switch(t.type){case a.TogglePreview:var r=!e.inPreview;return h(h({},e),{},{inPreview:r,isSettingsOpened:!r&&e.isSettingsOpened,readyToPublish:!r&&e.readyToPublish,notice:void 0});case a.ToggleSettingsSidebar:var o=e.isSettingsOpened;return h(h({},e),{},{isSettingsOpened:!e.isSettingsOpened,notice:o?void 0:e.notice});case a.OpenSettingsSidebar:return h(h({},e),{},{isSettingsOpened:!0});case a.CloseSettingsSidebar:return h(h({},e),{},{isSettingsOpened:!1,notice:void 0});case a.OpenMagMenu:return h(h({},e),{},{isMagMenuOpen:!0});case a.CloseMagMenu:return h(h({},e),{},{isMagMenuOpen:!1});case a.SetMagMenuOrientation:return h(h({},e),{},{magMenuOrientation:t.orientation});case a.SetMagMenu:return h(h({},e),{},{magMenuOn:t.isOn});case a.SetControlsOnTop:return h(h({},e),{},{controlsOnTop:t.onTop});case a.ToggleTrash:return h(h({},e),{},{isTrashOpened:!e.isTrashOpened});case a.TogglePageSettings:return h(h({},e),{},{isPageSettingsOpened:!e.isPageSettingsOpened});case a.SetProjectSettingsState:return h(h({},e),{},{isProjectSettingsOpened:t.payload});case a.SetOldProjectSettingsState:return h(h({},e),{},{isOldProjectSettingsOpened:t.payload});case a.ToggleHelpPopup:return h(h({},e),{},{isHelpPopupOpened:!e.isHelpPopupOpened});case a.ToggleUserTemplatesModal:return h(h({},e),{},{isUserTemplatesModalShown:!e.isUserTemplatesModalShown});case a.ToggleRmTemplatesModal:return h(h({},e),{},{isRmTemplatesModalShown:!e.isRmTemplatesModalShown});case a.SetPageActionsPopup:return h(h({},e),{},{isPageActionsPopupOpenedFor:t.payload});case a.ToggleGridSize:return h(h({},e),{},{gridSize:e.gridSize===n.Standard?n.Small:n.Standard});case a.TogglePageSelection:return h(h({},e),{},{selectedPages:s(e,t.payload)});case a.SetDragging:return h(h({},e),{},{isDragging:t.payload});case a.SetReadyToPublish:return h(h({},e),{},{readyToPublish:t.ready});case a.SetAddingPage:return h(h({},e),{},{addingPage:t.inProgress});case a.ToggleTeamworkModal:return h(h({},e),{},{isTeamworkModalOpened:t.payload});case a.SetNotice:return h(h({},e),{},{notice:t.notice});default:return e}}),l),2),d=u[0],g=u[1];Object(i.useEffect)((function(){localStorage.setItem("rm_pageSettings",JSON.stringify({gridSize:d.gridSize}))}),[d.gridSize]),Object(i.useEffect)((function(){!d.isSettingsOpened&&p.a.history.getFragment().indexOf("/contents/")>-1&&r.navigate("edit/".concat(r.mag.get("num_id"),"/").concat(r.getCurrentPageNum(),"/"),{replace:!0}),f.a.trigger(d.isSettingsOpened?"constructorSettings:open":"constructorSettings:close"),r.isSettingsOpened=d.isSettingsOpened}),[d.isSettingsOpened]);var b=Object(i.useCallback)((function(){g({type:a.OpenMagMenu})}),[]),y=Object(i.useCallback)((function(){g({type:a.CloseMagMenu})}),[]),j=Object(i.useCallback)((function(e,t){t.viewertype!==d.magMenuOrientation&&g({type:a.SetMagMenuOrientation,orientation:t.viewertype}),t.menubutton!==d.magMenuOn&&g({type:a.SetMagMenu,isOn:t.menubutton}),t.controlsontop!==d.controlsOnTop&&g({type:a.SetControlsOnTop,onTop:t.controlsontop})}),[d.magMenuOrientation,d.magMenuOn,d.controlsOnTop]);Object(i.useEffect)((function(){return f.a.on("magMenu:open",b),f.a.on("magMenu:close",y),function(){f.a.off("magMenu:open",b),f.a.off("magMenu:close",y)}}),[b,y]),Object(i.useEffect)((function(){return f.a.listenTo(t,"change:opts",j),function(){f.a.stopListening(t,"change:opts",j)}}),[j,j]);var S=Object(i.useCallback)((function(){g({type:a.SetReadyToPublish,ready:!0})}),[]);Object(i.useEffect)((function(){return f.a.listenTo(r,"previewMag:load:success",S),function(){f.a.stopListening(r,"previewMag:load:success",S)}}),[S]);return c.a.createElement(v.Provider,{value:h(h({},d),{},{dispatch:g,setPageVisibility:function(e,r){return new Promise((function(n,a){var o=t.getPage(e);o||n(),o.save({hidden:r}).done((function(e){n(e)})).fail((function(e){a(e.responseJSON)}))}))}})},o)},x=function(e,t,r,n){var a=r.findIndex((function(t){return t.num===e})),o=a>=0?r[a]:null,i=e+1,c=null;if(o&&o.children&&o.children.length)if(n[o._id]&&n[o._id].collapsed)c=o._id;else{var l=r[a+1];i=l?l.num:o.children[o.children.length-1].num+1}if(!o){var s=t.find((function(t){return t.num===e}));s&&(c=s.parentPage)}return{newPageNum:i,newPageParentId:c}},E=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return t.map((function(t){return t.children?{id:t._id,parentId:r,items:e(t.children,t._id)}:{id:t._id,parentId:r}}))},_=r("wEEd");!function(e){e.Top="top",e.Right="right",e.Bottom="bottom",e.Left="left"}(S||(S={}));var P=Object(o.e)(u.m).withConfig({displayName:"Popup___StyledBox"})(["background-color:rgba(40,40,40,0.92);transform:",";transition:0.3s transform ease;"],(function(e){return e._css})),C=Object(o.e)(u.m).withConfig({displayName:"Popup___StyledBox2"})(["display:",";",""],(function(e){return e._css2}),(function(e){return e._css3})),k=Object(i.forwardRef)((function(e,t){var r=e.isShown,n=e.coords,a=e.width,o=e.height,l=e.zIndex,d=e.transform,p=e.placement,f=e.rootElement,m=e.children;if(!r)return null;var g=Object(i.useMemo)((function(){var e="";switch(p){case S.Bottom:e="bottom: -16px; left: 24px; transform: rotate(90deg);";break;case S.Right:e="bottom: calc(50% - 12px); right: -8px;"}return e}),[p]);return(s.a.createPortal(c.a.createElement(P,{ref:t,width:"number"==typeof a?"".concat(a,"px"):"auto",height:"number"==typeof o?"".concat(o,"px"):"auto",position:"absolute",top:"number"==typeof n.top?"".concat(n.top,"px"):"auto",right:"number"==typeof n.right?"".concat(n.right,"px"):"auto",bottom:"number"==typeof n.bottom?"".concat(n.bottom,"px"):"auto",left:"number"==typeof n.left?"".concat(n.left,"px"):"auto",zIndex:l||8e3,borderRadius:"m",_css:d||"none"},m,c.a.createElement(C,{position:"absolute",_css2:p?"block":"none",_css3:g},c.a.createElement(u.Bb,{color:"black"}))),f||document.body))}));k.displayName="Popup";var I=k,A=r("K6JF"),R=r("f5n+"),T=function(){var e=Object(i.useContext)(v),t=new A.a,r=new R.a({isAutoShow:!1});return c.a.createElement(u.C,{width:"100%",height:"100%",flexDirection:"column",justifyContent:"space-between",alignItems:"flex-start",px:3,py:15},c.a.createElement(u.n,{"aria-labelledby":"start-quick-tour",color:"white",textStyle:"subheading",onClick:function(){window.RM.analytics&&window.RM.analytics.sendEvent("Constructor Help Open","Tour open"),r.show(),e.dispatch({type:a.ToggleHelpPopup})}},"Quick tour"),c.a.createElement(u.n,{"aria-labelledby":"show-shortcuts",color:"white",textStyle:"subheading",onClick:function(r){r.preventDefault(),window.RM.analytics&&window.RM.analytics.sendEvent("Constructor Help Open","Learn shortcuts"),t.show(),e.dispatch({type:a.ToggleHelpPopup})}},"Shortcuts"),c.a.createElement(u.n,{"aria-labelledby":"open-help",color:"white",textStyle:"subheading",as:"a",href:"https://help.readymag.com",target:"_blank",onClick:function(e){e.preventDefault(),window.RM.analytics&&window.RM.analytics.sendEvent("Constructor Help Open","Help R/m"),window.open("https://help.readymag.com","_blank")}},"Help page"),c.a.createElement(u.n,{"aria-labelledby":"open-learn",color:"white",textStyle:"subheading",as:"a",href:"https://readymag.com/learn/",target:"_blank",onClick:function(e){e.preventDefault(),window.RM.analytics&&window.RM.analytics.sendEvent("Constructor Help Open","Learn R/m"),window.open("https://readymag.com/learn/","_blank")}},"Learn Readymag"))};function M(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}Object(o.e)((function(e){e.isPending;var t=M(e,["isPending"]);return(c.a.createElement(u.q,t))})).withConfig({displayName:"SettingsHead__InlineCollaborator"})(["&&{display:inline-block;vertical-align:top;margin-bottom:12px;}[title]{opacity:",";transition:0.1s opacity;}&:hover [title]{opacity:1;}"],(function(e){return e.isPending?"0.5":"1"}));var N,D=Object(o.e)(u.n).withConfig({displayName:"SettingsHead___StyledButton"})(["z-index:1;order:2;text-decoration:none;&:hover{opacity:0.8;z-index:10;}.user-avatar-settings-add-collab{width:56px;height:56px;border:1px solid #e3e3e3;vertical-align:top;}"]),z=Object(o.e)(u.n).withConfig({displayName:"SettingsHead___StyledButton2"})(["z-index:2;order:1;text-decoration:none;&:hover{.user-avatar-settings-sidebar{opacity:0.8;}}.user-avatar-settings-sidebar{width:56px;height:56px;border:1px solid #e3e3e3;vertical-align:top;}"]),U=Object(o.e)(u.hb).withConfig({displayName:"SettingsHead___StyledRoundButton"})(["order:3;"]),F=Object(o.e)(u.n).withConfig({displayName:"SettingsHead___StyledButton3"})(["order:4;"]),B=function(e){var t,r,n=e.projectSettingsPanel,o=Object(i.useContext)(Qc),l=Object(i.useContext)(v),s=Object(u.Ub)({watchingClick:l.isHelpPopupOpened,callback:function(){l.dispatch({type:a.ToggleHelpPopup})}});Object(i.useEffect)((function(){l.isProjectSettingsOpened?(n.show(),n.once("hide",(function(){l.dispatch({type:a.SetProjectSettingsState,payload:!1})}))):n.shown&&n.hide()}),[l.isProjectSettingsOpened]);return c.a.createElement(u.m,{p:"8px 16px 7px 16px"},c.a.createElement(u.C,{alignItems:"center",justifyContent:"flex-start",position:"relative"},o.isOwner&&c.a.createElement(D,{"aria-labelledby":"add-collaborator",as:"a",ml:-20,mr:"4px",onClick:function(){l.dispatch({type:a.ToggleTeamworkModal,payload:!0})}},1===o.projectTeam.length?c.a.createElement(u.gb,{className:"user-avatar-settings-add-collab",url:o.projectTeam[0].pic,name:o.projectTeam[0].name||o.projectTeam[0].email,type:"settingsUser"}):c.a.createElement(u.gb,{name:"",className:"user-avatar-settings-add-collab",type:"settingsUser"},c.a.createElement(u.zb,{textStyle:"subheading",mt:"-5px",color:"black",pl:o.projectTeam.length>0?"6px":0,letterSpacing:"-2px"},"+"),o.projectTeam.length>0&&c.a.createElement(u.zb,{textStyle:"subheading",color:"black"},o.projectTeam.length))),c.a.createElement(z,{"aria-labelledby":"open-profile",as:"a",href:o.isOwner?"/".concat(o.project.user.uri)+(o.project.folder?"/f/".concat(o.project.folder.uri):""):"/shared/".concat(o.project.user.uri),mr:"4px"},c.a.createElement(u.gb,{url:null===(t=window.RM.constructorRouter.me)||void 0===t?void 0:t.get("pic"),name:null===(r=window.RM.constructorRouter.me)||void 0===r?void 0:r.get("name"),className:"user-avatar-settings-sidebar",type:"settingsUser"})),c.a.createElement(U,{"aria-labelledby":"open-project-settings",size:54,color:"darkGray","data-hovered":l.isProjectSettingsOpened,onClick:function(){return l.dispatch({type:a.SetProjectSettingsState,payload:!l.isProjectSettingsOpened})}},c.a.createElement(u.lb,{width:34,height:30,color:"white"})),c.a.createElement(F,{"aria-labelledby":"open-help-popup",position:"absolute",right:8,color:"darkGray",textStyle:"small",onClick:function(e){e.preventDefault(),e.stopPropagation(),l.dispatch({type:a.ToggleHelpPopup})}},"Help")),c.a.createElement(I,{width:224,height:156,isShown:l.isHelpPopupOpened,coords:{top:16,right:8},ref:s,rootElement:o.popupContainer},c.a.createElement(T,null)))},L=Object(o.e)(u.C).withConfig({displayName:"ExternalSettingsHead___StyledFlex"})(["font-family:-apple-system,system-ui,BlinkMacSystemFont,'Segoe UI',Roboto,Ubuntu,Arial,sans-serif;visibility:",";"],(function(e){return e._css})),G=Object(o.e)(u.hb).withConfig({displayName:"ExternalSettingsHead___StyledRoundButton"})(["z-index:2;text-decoration:none;border:1px solid rgba(184,184,184,0.4) !important;&:hover{border:1px solid rgba(184,184,184,0.4);opacity:0.96;}&:active{border:1px solid rgba(184,184,184,0.4);}.user-avatar-settings-sidebar,.user-avatar-settings-sidebar > div{width:54px;height:54px;background-color:",";vertical-align:top;}"],(function(e){return e._css2})),H=Object(o.e)(u.n).withConfig({displayName:"ExternalSettingsHead___StyledButton"})(["z-index:1;order:2;text-decoration:none;&:hover{z-index:10;}.user-avatar-settings-add-collab{width:56px;height:56px;border:1px solid #e3e3e3;vertical-align:top;}"]),W=function(){var e,t,r=Object(i.useContext)(Qc),n=Object(i.useContext)(v);return c.a.createElement(c.a.Fragment,null,c.a.createElement(L,{height:56,position:"absolute",top:24,right:"100%",mr:"16px",opacity:n.isSettingsOpened?1:0,_css:n.isSettingsOpened?"visible":"hidden"},c.a.createElement(G,{"aria-labelledby":"open-profile",size:56,color:"white",hoverColor:"white",activeColor:"white",as:"a",m:"0",href:r.isOwner?"/".concat(r.project.user.uri)+(r.project.folder?"/f/".concat(r.project.folder.uri):""):"/shared/".concat(r.project.user.uri),_css2:u.Rb.white},c.a.createElement(u.gb,{url:null===(e=window.RM.constructorRouter.me)||void 0===e?void 0:e.get("pic"),name:null===(t=window.RM.constructorRouter.me)||void 0===t?void 0:t.get("name"),className:"user-avatar-settings-sidebar"})),r.isOwner&&c.a.createElement(H,{"aria-labelledby":"add-collaborator",as:"a",ml:-20,mr:"4px",onClick:function(){n.dispatch({type:a.ToggleTeamworkModal,payload:!0})}},1===r.projectTeam.length?c.a.createElement(u.gb,{className:"user-avatar-settings-add-collab",url:r.projectTeam[0].pic,name:r.projectTeam[0].name||r.projectTeam[0].email,type:"settingsUser"}):c.a.createElement(u.gb,{name:"",className:"user-avatar-settings-add-collab",type:"settingsUser"},c.a.createElement(u.zb,{textStyle:"subheading",mt:"-5px",color:"black",pl:r.projectTeam.length>0?"6px":0,letterSpacing:"-2px"},"+"),r.projectTeam.length>0&&c.a.createElement(u.zb,{textStyle:"subheading",color:"black"},r.projectTeam.length)))))},V=r("wd/R"),Y=r.n(V),$=r("tZHv"),X=function(e){return e.is_published?e.changed?"Unpublished changes":"Published ".concat(Y()(e.published).format("MMM D, YYYY")):"Unpublished"};!function(e){e.Unpublished="unpublished",e.SameAsPublished="sameAsPublished",e.UnpublishedChanges="unpublishedChanges"}(N||(N={}));var q,K=function(e){return e.is_published?e.changed?N.UnpublishedChanges:N.SameAsPublished:N.Unpublished},J=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=$.a.readymag_host.split("//")[1],n=e.domain,a=e.user.domain,o=t?"".concat($.a.readymag_host.split("//")[0],"//"):"",i=a||(n||"".concat(r,"/").concat(e.user.uri));return o+i};!function(e){e.canInjectCode="can_inject_code",e.canExportPDF="can_export_pdf",e.canExportCode="can_export_code",e.canUseShots="can_use_shots"}(q||(q={}));var Z,Q=r("+IKJ"),ee=r("hB7q");!function(e){e.ecommerce="type-publish-ecommerce",e.freePublishLimit="type-publish-limit",e.unconfirmedEmail="type-publish-noemail",e.customCode="type-code-injection",e.shots="type-widget-shots",e.pdfExport="type-export-pdf",e.htmlExport="type-export-code"}(Z||(Z={}));var te=function e(t){var r=t.message,n=t.tag,a=t.type;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.message=r,this.tag=n,this.type=a||"error"};function re(){return(re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function ne(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var ae=Object(o.e)(u.n).withConfig({displayName:"ConfirmButton___StyledButton"})(["transition:opacity 0.2s ease;&:hover{opacity:0.96;background:",";color:",";}"],(function(e){return e._css}),(function(e){return e._css2})),oe=function(e){var t=e.children,r=e["aria-labelledby"],n=e.width,a=e.onClick,o=e.bg,i=e.color,l=e.danger,s=e.dangerOnHover,d=ne(e,["children","aria-labelledby","width","onClick","bg","color","danger","dangerOnHover"]),p=l?u.Rb.tomato:o||u.Rb.white,f=l?u.Rb.white:i||u.Rb.black;return c.a.createElement(ae,re({"aria-labelledby":r,width:n||80,height:32,lineHeight:"30px",textStyle:"small",bg:p,color:f,borderRadius:"xl",cursor:"pointer",border:"1px solid rgba(128, 128, 128, 0.16)"},d,{onClick:a,_css:s?u.Rb.tomato:p,_css2:s?u.Rb.white:f}),t)};function ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ce(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ce(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var le=Object(o.e)(u.m).withConfig({displayName:"MorePublishMenu___StyledBox"})(["transform:translate(-3px);"]),se=Object(o.e)(u.V).withConfig({displayName:"MorePublishMenu___StyledMenuItem"})(["display:flex;justify-content:center;"]),ue=Object(o.e)(u.m).withConfig({displayName:"MorePublishMenu___StyledBox2"})(["transform:rotate(90deg);"]),de=function(e){var t=e.m,r=Object(i.useContext)(Qc),n=Object(i.useContext)(v),o=K(r.project),l=ie(Object(i.useState)(!1),2),d=l[0],p=l[1],f=ie(Object(i.useState)(!1),2),m=f[0],g=f[1],b=Object(i.useCallback)((function(){n.dispatch({type:a.SetNotice,notice:void 0});try{r.showPDFExportModal()}catch(e){if(!(e instanceof te))throw e;n.dispatch({type:a.SetNotice,notice:e})}}),[]),h=Object(i.useCallback)((function(){try{r.checkHTMLExportPermission(),p(!0)}catch(e){if(!(e instanceof te))throw e;n.dispatch({type:a.SetNotice,notice:e})}}),[]),y=document.querySelector("body > .popups");return c.a.createElement(c.a.Fragment,null,c.a.createElement(u.T,{onStateChange:function(e){return!e.isOpen&&g(!1)},transitionConfig:{duration:0},target:c.a.createElement(u.hb,{size:56,color:"darkGray",m:t},c.a.createElement(u.Eb,{color:"white"})),placement:"top"},c.a.createElement(le,{position:"relative",bg:Object(Q.e)(.08,u.Rb.black),borderRadius:"m",p:"10px 0 18px",mb:12,width:224,textAlign:"center"},c.a.createElement(u.V,{textStyle:"regular",lineHeight:"32px",height:"32px",color:"white",onClick:b},"Export to PDF"),c.a.createElement(u.V,{textStyle:"regular",lineHeight:"32px",height:"32px",color:"white",onClick:h},"Export to HTML"),o===N.UnpublishedChanges&&c.a.createElement(se,{textStyle:"regular",color:"white",lineHeight:"32px",height:"32px",onClick:function(e){e.stopPropagation(),g(!0)}},m?c.a.createElement(c.a.Fragment,null,c.a.createElement(oe,{dangerOnHover:!0,onClick:r.restoreToPublished},"Restore"),c.a.createElement(oe,{m:"0 0 0 20px",onClick:function(e){e.stopPropagation(),g(!1)}},"Cancel")):"Restore to last published"),o!==N.Unpublished&&c.a.createElement(u.V,{textStyle:"regular",lineHeight:"32px",height:"32px",color:"white",onClick:r.unpublish},"Unpublish"),c.a.createElement(ue,{position:"absolute",bottom:-16,right:32},c.a.createElement(u.Bb,{color:"black"})))),d&&y?s.a.createPortal(c.a.createElement(ee.default,{numId:r.project.num_id,email:r.project.user.email}),y):null)};function pe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return fe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function me(e,t,r,n,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,a)}function ge(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){me(o,n,a,i,c,"next",e)}function c(e){me(o,n,a,i,c,"throw",e)}i(void 0)}))}}var be=Object(o.e)(u.rb).withConfig({displayName:"PublishSection___StyledStyledLink"})(["display:block;width:144px;height:56px;text-align:center;"]),he=Object(o.e)(u.zb).withConfig({displayName:"PublishSection___StyledText"})(["display:block;height:56px;width:100%;"]),ye=function(){var e=Object(i.useContext)(Qc),t=Object(i.useContext)(v),r=K(e.project),n=Object(i.useCallback)((function(){!e.hasPermission(q.canInjectCode)&&e.hasCustomCode()?t.dispatch({type:a.SetNotice,notice:{message:"Injected Code and Shots will not work in Published project.",tag:Z.customCode}}):!e.hasPermission(q.canUseShots)&&e.hasShots()&&t.dispatch({type:a.SetNotice,notice:{message:"Injected Code and Shots will not work in Published project.",tag:Z.shots}})}),[]),o=Object(i.useCallback)((function(){!e.publishInProgress&&r!==N.SameAsPublished&&t.dispatch({type:a.SetNotice,notice:void 0})}),[e.publishInProgress,r]),l=r===N.UnpublishedChanges||r===N.SameAsPublished,s=Object(i.useCallback)(ge(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r===N.SameAsPublished||e.publishInProgress){n.next=20;break}return t.dispatch({type:a.SetNotice,notice:void 0}),n.prev=2,n.next=5,e.publishWithNotice();case 5:n.next=20;break;case 7:if(n.prev=7,n.t0=n.catch(2),!(n.t0 instanceof te&&"warning"===n.t0.type)){n.next=15;break}return n.next=12,e.publishWithNotice({skipWarnings:!0});case 12:t.dispatch({type:a.SetNotice,notice:n.t0}),n.next=20;break;case 15:if(!(n.t0 instanceof te)){n.next=19;break}t.dispatch({type:a.SetNotice,notice:n.t0}),n.next=20;break;case 19:throw n.t0;case 20:case"end":return n.stop()}}),n,null,[[2,7]])}))),[r,e.publishInProgress]),d="".concat($.a.readymag_host,"/").concat(e.project.user.uri,"/").concat(e.project.uri,"/"),p=!e.isPublishError&&!e.publishInProgress&&r===N.SameAsPublished,f=pe(Object(i.useState)(!1),2),m=f[0],g=f[1];return c.a.createElement(u.C,{width:"100%",height:88,px:16,justifyContent:"space-between",alignItems:"center"},c.a.createElement(c.a.Fragment,null,p?c.a.createElement(be,{onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)},href:d,textStyle:"regular",color:"tomato",lineHeight:"52px",justifyContent:"center",alignItems:"center",userSelect:"none"},m?"Open":"Published"):c.a.createElement(u.n,{variant:"clean",width:l?144:"100%",height:56,borderRadius:30,bg:"tomato",color:"white",textStyle:"regular",onClick:s,onMouseEnter:n,onMouseLeave:o},e.publishInProgress?c.a.createElement(u.m,{width:56,m:"auto"},c.a.createElement(u.R,{bgColor:"transparent"})):c.a.createElement(he,{lineHeight:"52px"},e.isPublishError?"Error":r===N.Unpublished?"Publish":"Republish")),l&&c.a.createElement(de,{m:"0 0 0 8px"})))},ve=r("za5s");function we(e,t,r,n,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,a)}function je(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Se(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Se(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Oe=Object(o.e)(u.m).withConfig({displayName:"LinkSettings___StyledBox"})(["white-space:nowrap;text-overflow:ellipsis;overflow:hidden;"]),xe=o.e.label.withConfig({displayName:"LinkSettings___StyledLabel"})(["",";"],(function(e){return e._css})),Ee=Object(o.e)(u.I).withConfig({displayName:"LinkSettings___StyledInlineInput"})(["&:focus{border:none;}&::placeholder{color:",";}&:disabled{color:",";}"],(function(e){return e._css2}),(function(e){return e._css3})),_e=c.a.memo((function(e){var t=e.isProjectSettingsOpened,r=e.projectNumId,n=e.publishState,a=e.projectUri,o=e.fullProjectLink,l=e.urlDomainString,s=e.loadUserProjectsLinks,d=e.saveProjectUri,p=je(Object(i.useState)([]),2),f=p[0],m=p[1],g=je(Object(i.useState)(!1),2),b=g[0],h=g[1];Object(i.useEffect)((function(){t&&(b||(h(!0),s().then((function(e){m(e),h(!1)})).finally((function(){h(!1)}))))}),[t]);var y=je(Object(i.useState)((function(){return a})),2),v=y[0],w=y[1],j=je(Object(i.useState)(null),2),S=j[0],O=j[1],x=Object(i.useRef)(null),E=je(Object(i.useState)("Copy link"),2),_=E[0],P=E[1],C=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,navigator.permissions.query({name:"clipboard-write"});case 4:if(r=e.sent,"granted"!==(n=r.state)&&"prompt"!==n){e.next=11;break}return e.next=9,navigator.clipboard.writeText(o);case 9:P("Copied"),setTimeout((function(){P("Copy link")}),2500);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),console.warn(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})),function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){we(o,n,a,i,c,"next",e)}function c(e){we(o,n,a,i,c,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}();return c.a.createElement(c.a.Fragment,null,c.a.createElement(Oe,{width:"100%",mt:10},c.a.createElement(xe,{htmlFor:"project-link",title:l,_css:Object(ve.themeGet)("textStyles.small")},"".concat(l,"/")),c.a.createElement(Ee,{ref:x,mt:"4px",name:"project-link",id:"project-link",type:"text",color:"black",fontSize:"regular",spellCheck:!1,autoComplete:"off",autoCorrect:"off",disabled:b,placeholder:r.toString(),value:v,onKeyDown:function(e){13===e.keyCode&&(e.preventDefault(),e.currentTarget.blur())},onChange:function(e){var t=function(e){var t=e;return[{regex:/(_)/gi,replacer:"-"},{regex:/([^a-zA-Z0-9-])/gi,replacer:""},{regex:/(-{2,})/gi,replacer:"-"}].forEach((function(e){t.match(e.regex)&&(t=t.replace(e.regex,e.replacer))})),t}(e.currentTarget.value),n=function(e,t,r){var n=e.toLowerCase();return n?/(^-)|(-$)/.test(n)?new Error("The link should not start or end with a hyphen"):"info"===n?new Error("Sorry, info is not acceptable"):n&&n.length>128?new Error("128 symbols max"):/^[0-9]+$/.test(n)&&n!==t.toString()?new Error("The link should not contain only numbers"):r.reduce((function(e,t){return e&&n!==t.uri}),!0)?void 0:new Error("You already have a project with this link"):new Error("The link should not be empty")}(t,r,f);n?(console.warn(n.message),O(n.message)):S&&O(null),w(t)},onBlur:function(){S?("The link should not be empty"===S?(w(r.toString()),d(r.toString())):w(a),O(null)):d(v)},_css2:u.Rb.darkGray,_css3:u.Rb.gray})),n===N.Unpublished?null:c.a.createElement(u.C,{width:"100%",height:40,mt:"2px",justifyContent:"space-between"},c.a.createElement(u.n,{width:92,height:40,variant:"bordered",textStyle:"small",onClick:C},_),c.a.createElement(u.n,{width:90,height:38,variant:"bordered",as:"a",href:o,target:"_blank",textStyle:"small",lineHeight:"38px"},"Open")))}));_e.displayName="LinkSettings";var Pe=r("QuYs"),Ce=function(e){var t=e.p,r=e.m,n=e.children;return(c.a.createElement(u.m,{width:"100%",p:t||"12px 24px",m:r||"0",borderRadius:"m",bg:"white",textAlign:"center"},n))},ke=r("LDvm"),Ie=r("OTSC"),Ae=r("tyue"),Re=r.n(Ae);function Te(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var Me=Object(o.e)(u.C).withConfig({displayName:"Hint___StyledFlex"})(["&:hover{background:",";}"],(function(e){return e._css})),Ne=function(e){var t=e.text,r=e.variant,n=void 0===r?"text":r,a=e.hintWidth,o=e.hintModifiers,i=Te(e,["text","variant","hintWidth","hintModifiers"]),l="readable"===n;return c.a.createElement(u.m,i,c.a.createElement(u.Cb,{modifiers:o||{preventOverflow:{enabled:!0}},text:t,width:a||160,height:"auto",p:"8px 12px",whiteSpace:"normal",delay:0,indent:4,color:l?u.Rb.black:u.Rb.white,bg:l?u.Rb.white:Object(Q.e)(.04,u.Rb.darkGray),border:l?"1px solid ".concat(Object(Q.e)(.92,u.Rb.black)):void 0},c.a.createElement(Me,{justifyContent:"center",alignItems:"center",border:"1px solid",borderColor:Object(Q.e)(.92,u.Rb.black),borderRadius:12,width:24,height:24,cursor:"auto",_css:l?u.Rb.white:"none"},c.a.createElement(u.zb,{textStyle:"small",color:"gray",cursor:"default"},"?"))))};function De(e,t,r,n,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,a)}function ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ue(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ue(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Fe=Object(o.e)(u.I).withConfig({displayName:"PrivacySettings___StyledInlineInput"})(["&:focus{border:none;}&::placeholder{color:",";}&:disabled{color:",";}"],(function(e){return e._css}),(function(e){return e._css2})),Be=Object(o.e)(u.m).withConfig({displayName:"PrivacySettings___StyledBox"})(["opacity:",";"],(function(e){return e._css3})),Le=Object(o.e)(u.C).withConfig({displayName:"PrivacySettings___StyledFlex"})(["&:hover{& svg{color:",";}}&:active{background-color:",";& svg{color:",";}}animation:"," 2s infinite linear;@keyframes loadingindicatoranimation{from{transform:rotateZ(0deg);}to{transform:rotateZ(360deg);}}"],(function(e){return e._css4}),(function(e){return e._css5}),(function(e){return e._css6}),(function(e){return e._css7})),Ge=Object(o.e)(u.hb).withConfig({displayName:"PrivacySettings___StyledRoundButton"})(["&:hover{& svg{color:",";}}&:active{background-color:",";& svg{color:",";}}"],(function(e){return e._css8}),(function(e){return e._css9}),(function(e){return e._css10})),He=c.a.memo((function(e){var t=e.projectNumId,r=e.isPublished,n=e.disabled,a=e.setProjectPrivacy,o=e.saveBgImage,l=e.saveProjectOptions,s=e.isPrivate,d=e.password,p=e.passwordBackground,f=e.isOwner,m=e.ownerEmail,g=ze(Object(i.useState)((function(){return s})),2),b=g[0],h=g[1],y=ze(Object(i.useState)(!1),2),v=y[0],w=y[1],j=ze(Object(i.useState)((function(){return d})),2),S=j[0],O=j[1],x=ze(Object(i.useState)((function(){return p})),2),E=x[0],_=x[1],P=Object(i.useRef)(null),C=function(){return Object(ke.F)(t).then((function(e){return Ie.default.facebookGraphRefresh(e)}))},k=ze(Object(i.useState)(!1),2),I=k[0],A=k[1],R=ze(Object(i.useState)(!1),2),T=R[0],M=R[1],N=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(A(!1),!(t.size>$.a.UPLOAD_IMAGE_SIZE_LIMIT)){e.next=4;break}return window.alert($.a.MSG_UPLOAD_IMAGE_SIZE_ERROR),e.abrupt("return");case 4:if(!T){e.next=6;break}return e.abrupt("return");case 6:return M(!0),e.prev=7,e.next=10,Object(ke.M)("password-bg",t);case 10:(r=e.sent)&&r.picture&&r.picture.url&&(_(r.picture.url),o(r.picture.url).fail((function(){_(p)})).always((function(){M(!1)}))),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),M(!1);case 17:case"end":return e.stop()}}),e,null,[[7,14]])})),function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){De(o,n,a,i,c,"next",e)}function c(e){De(o,n,a,i,c,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),D=f?c.a.createElement(c.a.Fragment,null,"Please"," ",c.a.createElement(u.rb,{href:"/settings#change-plan",target:"_blank",textStyle:"small",isActive:!0,onClick:function(){Pe.d.sendEvent(Pe.b.PrivacyAlertUpgrade)}},"upgrade")," ","your account to use password protection.",c.a.createElement("br",null),c.a.createElement(u.rb,{href:"/pricing",target:"_blank",textStyle:"small",color:"black"},"See the pricing")):c.a.createElement(c.a.Fragment,null,c.a.createElement(u.zb,{textStyle:"small",color:"black"},"Please upgrade owner’s account to use password protection."),c.a.createElement("br",null),c.a.createElement(u.rb,{href:"mailto:".concat(m),textStyle:"small",isActive:!0},"Contact owner")),z=n&&!b;return c.a.createElement(c.a.Fragment,null,c.a.createElement(u.C,{width:"100%",height:24,mb:b?"4px":"16px",justifyContent:"space-between"},c.a.createElement(u.zb,{textStyle:"small",lineHeight:"24px",color:z?Object(Q.e)(.04,u.Rb.black):"black"},"Protect with password"),z?c.a.createElement(Ne,{hintWidth:192,hintModifiers:{preventOverflow:{enabled:!0,padding:24}},variant:"readable",text:D}):c.a.createElement(u.wb,{backgroundChecked:"green",checked:b,onChange:function(){if(!v){var e=!b;h(e),(e&&d||!e)&&(w(!0),a({isPrivate:e}).then((function(){e&&l({sharebutton:!1})})).catch((function(){h(!e)})).finally((function(){w(!1)}))),r&&C(),window.RM.analytics&&window.RM.analytics.sendEvent("Password Toggle",e?"on":"off")}},disabled:n})),n&&b&&c.a.createElement(Ce,{m:"0 0 16px"},c.a.createElement(u.zb,{textStyle:"small",color:"black"},"Please note that if you remove the password, you won’t be able to set it back again as your current subscription plan doesn’t support password protection.")),b&&c.a.createElement(u.m,{width:"100%"},c.a.createElement(Fe,{ref:P,name:"project-password",id:"project-password",type:"text",mb:"4px",color:"black",fontSize:"regular",spellCheck:!1,autoComplete:"off",autoCorrect:"off",placeholder:"Set password",value:S,onKeyDown:function(e){13===e.keyCode&&(e.preventDefault(),e.currentTarget.blur())},onChange:function(e){var t;O((t=e.currentTarget.value,/[^\x00-\x7f]/.test(t)?t.replace(/[^\x00-\x7f]/g,""):t))},onBlur:function(){if(s){if(S!==d&&S){w(!0);var e=!d;a({isPrivate:!0,password:S}).finally((function(){w(!1),e&&C()})),S&&Pe.d.sendEvent(Pe.b.SetProjectPassword)}}else O(d)},_css:u.Rb.darkGray,_css2:u.Rb.gray}),c.a.createElement(u.zb,{textStyle:"small"},"Password page background"),c.a.createElement(Be,{width:192,height:125,mt:"4px",mb:16,position:"relative",onDragEnter:function(){I||A(!0)},onDragLeave:function(){I&&A(!1)},_css3:I?.8:1},c.a.createElement(u.B,{accept:"image/*",dropFile:!0,readFileData:!1,onChange:N},c.a.createElement(c.a.Fragment,null,c.a.createElement(u.m,{width:192,height:125,bg:"darkGrey",borderRadius:"s",position:"relative",cursor:"pointer",boxShadow:"0 1px 1px rgba(64, 64, 64, 0.32)"},c.a.createElement(u.v,{width:"100%",height:"100%",borderRadius:"s",backgroundImage:"url(".concat(E||Re.a,")"),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"})),!I&&c.a.createElement(u.C,{width:96,height:32,position:"absolute",left:0,right:0,bottom:9,m:"auto",justifyContent:"space-around"},c.a.createElement(Le,{width:32,height:32,justifyContent:"center",alignItems:"center",border:"1px solid rgba(128, 128, 128, 0.16)",borderRadius:"round",bg:"white",cursor:T?"default":"pointer",_css4:u.Rb.tomato,_css5:u.Rb.tomato,_css6:u.Rb.white,_css7:T?"loadingindicatoranimation":"none"},c.a.createElement(u.fb,{color:"black"})),E&&c.a.createElement(Ge,{size:32,color:"white",hoverColor:"white",activeColor:"tomato",outline:!0,onClick:function(e){e.preventDefault(),e.stopPropagation(),T||(M(!0),_(void 0),o("").fail((function(){_(p)})).always((function(){M(!1)})))},_css8:u.Rb.tomato,_css9:u.Rb.tomato,_css10:u.Rb.white},c.a.createElement(u.x,{color:"black"}))))))))}));function We(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ve(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ve(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}He.displayName="PrivacySettings";var Ye=c.a.memo((function(e){var t=e.allowIndex,r=e.indexDisabled,n=e.projectHidden,a=e.profileUrl,o=e.saveProjectOptions,l=We(Object(i.useState)((function(){return t})),2),s=l[0],d=l[1],p=We(Object(i.useState)((function(){return n})),2),f=p[0],m=p[1],g=c.a.createElement(c.a.Fragment,null,c.a.createElement(u.rb,{href:"/pricing",target:"_blank",textStyle:"small",isActive:!0},"Upgrade")," ","to make your site visible to search engines");return c.a.createElement(c.a.Fragment,null,c.a.createElement(u.C,{width:"100%",height:24,mb:"16px",justifyContent:"space-between"},c.a.createElement(u.zb,{textStyle:"small",lineHeight:"24px",color:"black"},"Visible to search engines"),r?c.a.createElement(Ne,{hintWidth:192,hintModifiers:{preventOverflow:{enabled:!0,padding:24}},variant:"readable",text:g}):c.a.createElement(u.wb,{backgroundChecked:"green",checked:s,onChange:function(){if(!r){var e=!s;d(e),o({allowindex:e}),window.RM.analytics&&window.RM.analytics.sendEvent("Project Visible to Search Engines",e?"visible":"hidden")}},disabled:r})),c.a.createElement(u.C,{width:"100%",height:24,mb:"16px",justifyContent:"space-between"},c.a.createElement(u.zb,{textStyle:"small",lineHeight:"24px",color:"black"},"Add to my"," ",c.a.createElement(u.rb,{href:a,target:"_blank",textStyle:"small"},"Public Profile")),c.a.createElement(u.wb,{backgroundChecked:"green",checked:!f,onChange:function(){var e=!f;m(e),o({hidden:e}),window.RM.analytics&&window.RM.analytics.sendEvent("Project Visibile to Visitors",e?"hidden":"visible")}})))}));function $e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Xe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Ye.displayName="VisibilitySettings";var qe=c.a.memo((function(e){var t=e.isActiveSubscription,r=e.fullProjectLink,n=$e(Object(i.useState)(!1),2),a=n[0],o=n[1],l=c.a.createElement(c.a.Fragment,null,c.a.createElement(u.rb,{href:"/pricing",target:"_blank",textStyle:"small",isActive:!0},"Upgrade")," ","your account to submit projects to"," ",c.a.createElement(u.rb,{href:"/examples",target:"_blank",textStyle:"small"},"Examples"));return c.a.createElement(u.C,{width:"100%",height:24,justifyContent:"space-between"},c.a.createElement(u.zb,{textStyle:"small",lineHeight:"24px"},a?"Submitted":"Submit"," to"," ",c.a.createElement(u.rb,{href:"/examples",target:"_blank",textStyle:"small"},"Examples")),t?c.a.createElement(u.wb,{backgroundChecked:"green",checked:a,onChange:function(){t&&Object(ke.z)(r).then((function(e){e&&"ok"===e.result?(o(!0),window.RM.analytics&&window.RM.analytics.sendEvent("Submit To Explore")):console.warn("sendToExamples error")}))},disabled:a}):c.a.createElement(Ne,{hintWidth:192,hintModifiers:{preventOverflow:{enabled:!0,padding:24}},variant:"readable",text:l}))}));function Ke(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Je(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Je(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Je(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}qe.displayName="SubmitToExamples";var Ze=function(e){var t=e.projectSettingsPanel,r=Object(i.useContext)(v),n=Object(i.useContext)(Qc);Object(i.useEffect)((function(){r.isOldProjectSettingsOpened?(t.show(),t.once("hide",(function(){r.dispatch({type:a.SetOldProjectSettingsState,payload:!1})}))):t.shown&&t.hide()}),[r.isOldProjectSettingsOpened]);var o=Ke(Object(i.useState)((function(){return n.project.title||""})),2),l=o[0],s=o[1],d=Ke(Object(i.useState)(!1),2),p=d[0],f=d[1];Object(i.useEffect)((function(){p||s(n.project.title||"")}),[n.project.title]);var m=Object(i.useMemo)((function(){return J(n.project)}),[n.project.domain,n.project.user.domain,n.project.user.uri]),g=Object(i.useMemo)((function(){return J(n.project,!0)}),[n.project.domain,n.project.user.domain,n.project.user.uri]),b=function(){return"".concat($.a.readymag_host,"/").concat(n.project.user.uri,"/").concat(n.project.uri,"/")},h=Ke(Object(i.useState)((function(){return b()})),2),y=h[0],w=h[1];Object(i.useEffect)((function(){w(b())}),[n.project.uri,n.project.user.uri]);var j=Object(i.useCallback)((function(e){n.projectSave({uri:e},{patch:!0})}),[]),S=Object(i.useCallback)((function(e){return n.projectSave({pass_bg:e},{patch:!0})}),[]),O=Object(i.useMemo)((function(){return K(n.project)}),[n.project.is_published,n.project.changed]),x=Object(i.useMemo)((function(){var e=n.project.user.permissions.viewer_opts_overrides||{};return e&&void 0!==e.allowindex}),[n.project.user]),E=Object(i.useMemo)((function(){return"active"===(window.RM.constructorRouter.me.get("stripe")||{}).subscription_status}),[window.RM.constructorRouter.me]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(u.m,null,c.a.createElement(u.J,{name:"project-title",placeholder:"Project Title",translate:"no",spellCheck:!1,maxLength:128,rows:1,autoSize:!0,textStyle:"regular",color:"black",value:l,onChange:function(e){s(e.currentTarget.value)},onFocus:function(){f(!0)},onBlur:function(){f(!1),n.projectSave({title:l})}})),c.a.createElement(_e,{isProjectSettingsOpened:r.isProjectSettingsOpened,projectNumId:n.project.num_id,publishState:O,projectUri:n.project.uri,fullProjectLink:y,urlDomainString:m,loadUserProjectsLinks:function(){return n.loadUserProjectsLinks()},saveProjectUri:j}),c.a.createElement(u.C,{width:"100%",mt:n.project.is_published?24:0,flexDirection:"column"},c.a.createElement(He,{projectNumId:n.project.num_id,isPrivate:n.project.is_private,isPublished:n.project.is_published,disabled:!n.project.user||!n.project.user.permissions.can_make_mag_private,setProjectPrivacy:n.setProjectPrivacy,saveBgImage:S,saveProjectOptions:n.setProjectOptions,password:n.project.pass,passwordBackground:n.project.pass_bg,isOwner:n.isOwner,ownerEmail:n.project.user.email}),!n.project.is_private&&c.a.createElement(Ye,{allowIndex:n.project.opts.allowindex,projectHidden:n.project.opts.hidden,indexDisabled:x,profileUrl:g,saveProjectOptions:n.setProjectOptions}),!n.project.is_private&&n.project.is_published&&c.a.createElement(qe,{isActiveSubscription:E,fullProjectLink:y})),c.a.createElement(u.hb,{size:32,mt:10,color:"darkGray",onClick:function(){r.dispatch({type:a.SetOldProjectSettingsState,payload:!r.isOldProjectSettingsOpened})}},c.a.createElement(u.kb,{color:"white"})))},Qe=function(e){var t=e.showUpgradeAlert,r=e.onOpenCodeEditorClick;return c.a.createElement(c.a.Fragment,null,c.a.createElement(u.n,{width:"100%",height:40,mt:"5px",mb:16,variant:"bordered",textStyle:"small",onClick:r},"Open Code Editor"),t&&c.a.createElement(Ce,null,c.a.createElement(u.zb,{textStyle:"small",color:"tomato"},"Injected code works",c.a.createElement("br",null),"for Preview only!"),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement(u.zb,{textStyle:"small",color:"black"},c.a.createElement(u.rb,{href:"/settings#change-plan",target:"_blank",textStyle:"small",onClick:function(){window.RM.analytics&&window.RM.analytics.sendEvent("Code Editor Update")}},"Upgrade")," ","to have it work",c.a.createElement("br",null),"in Published project.")))};function et(e,t,r,n,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,a)}function tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return rt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var nt=Object(o.e)(u.C).withConfig({displayName:"DomainSettings___StyledFlex"})(["background-image:",";background-size:cover;background-position:center;&:hover{& svg{color:",";}}"],(function(e){return e._css}),(function(e){return e._css2})),at=function(){var e=Object(i.useContext)(Qc),t=tt(Object(i.useState)(!1),2),r=t[0],n=t[1],a=tt(Object(i.useState)(!1),2),o=a[0],l=a[1],s=Object(i.useMemo)((function(){return e.project.opts.favicon}),[e.project.opts.favicon]),d=function(){var t,r=(t=regeneratorRuntime.mark((function t(r){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r.size>$.a.UPLOAD_IMAGE_SIZE_LIMIT)){t.next=3;break}return window.alert($.a.MSG_UPLOAD_IMAGE_SIZE_ERROR),t.abrupt("return");case 3:if(!o){t.next=5;break}return t.abrupt("return");case 5:return l(!0),t.prev=6,t.next=9,Object(ke.M)("favicon",r);case 9:if(!(n=t.sent)||!n.baseUrl){t.next=14;break}return t.next=13,e.setProjectOptions({favicon:n.baseUrl});case 13:l(!1);case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(6),l(!1);case 19:case"end":return t.stop()}}),t,null,[[6,16]])})),function(){var e=this,r=arguments;return new Promise((function(n,a){var o=t.apply(e,r);function i(e){et(o,n,a,i,c,"next",e)}function c(e){et(o,n,a,i,c,"throw",e)}i(void 0)}))});return function(e){return r.apply(this,arguments)}}();return c.a.createElement(u.m,null,c.a.createElement(u.zb,{textStyle:"small",color:"black"},"Name"),c.a.createElement("br",null),c.a.createElement(u.zb,{as:"div",mt:"4px",textStyle:"regular",color:"black"},e.project.domain),c.a.createElement(u.n,{width:"100%",height:40,mt:12,mb:14,variant:"bordered",textStyle:"small",disabled:!e.project.domain||r,onClick:function(){n(!0),e.unmapDomain().then((function(){e.project.opts.ssl&&e.projectSave({ssl:!1})})).catch((function(){})).finally((function(){n(!1)}))}},"Unmap"),c.a.createElement(u.C,{width:"100%",height:24,mb:16,justifyContent:"space-between"},c.a.createElement(u.zb,{textStyle:"small",lineHeight:"24px",color:"black"},"Favicon"),c.a.createElement(u.B,{accept:"image/*",dropFile:!1,readFileData:!1,onChange:d},c.a.createElement(nt,{width:24,height:24,borderRadius:"round",justifyContent:"center",alignItems:"center",border:"1px solid rgba(64, 64, 64, 0.08)",cursor:"pointer",_css:e.project.opts.favicon?"url(".concat(Ie.default.addFilenameComponent(e.project.opts.favicon,57),")"):"none",_css2:u.Rb.tomato},s?c.a.createElement(u.x,{color:"black"}):c.a.createElement(u.db,{color:"black"})))),c.a.createElement(u.C,{width:"100%",height:24,mb:16,justifyContent:"space-between"},c.a.createElement(u.zb,{textStyle:"small",lineHeight:"24px",color:"black"},"SSL"),c.a.createElement(u.wb,{backgroundChecked:"green"})))};function ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return it(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return it(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ct=o.e.label.withConfig({displayName:"RegisterDomain___StyledLabel"})(["",";"],(function(e){return e._css})),lt=Object(o.e)(u.I).withConfig({displayName:"RegisterDomain___StyledInlineInput"})(["&:focus{border:none;}&::placeholder{color:",";}&:disabled{color:",";}"],(function(e){return e._css2}),(function(e){return e._css3})),st=Object(o.e)(u.Db).withConfig({displayName:"RegisterDomain___StyledTriangleIcon"})(["transform:rotate(-90deg);"]),ut=function(){var e=ot(Object(i.useState)(),2),t=e[0],r=e[1],n=ot(Object(i.useState)("https://iwantmyname.com"),2),a=n[0],o=n[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(ct,{htmlFor:"project-domain",_css:Object(ve.themeGet)("textStyles.small")},"Or register new domain name"),c.a.createElement(u.C,null,c.a.createElement(lt,{name:"register-domain",id:"register-domain",type:"text",mt:"4px",placeholder:"iwantmyname.com",spellCheck:!1,autoComplete:"off",autoCorrect:"off",value:t,onKeyDown:function(e){13===e.keyCode&&(e.preventDefault(),e.currentTarget.blur())},onChange:function(e){r(e.currentTarget.value),e.currentTarget.value?o("https://iwantmyname.com/services/social/readymag-custom-domain?_r=readymag&domain=".concat(encodeURIComponent(e.currentTarget.value))):o("https://iwantmyname.com")},_css2:u.Rb.darkGray,_css3:u.Rb.gray}),c.a.createElement(u.m,{width:14,position:"relative",top:12,left:1},c.a.createElement("a",{href:a,target:"_blank",rel:"noopener noreferrer"},c.a.createElement(st,{color:t?"black":"gray"})))))},dt=o.e.label.withConfig({displayName:"GaSettings___StyledLabel"})(["",";"],(function(e){return e._css})),pt=Object(o.e)(u.I).withConfig({displayName:"GaSettings___StyledInlineInput"})(["&:focus{border:none;}&::placeholder{color:",";}&:disabled{color:",";}"],(function(e){return e._css2}),(function(e){return e._css3})),ft=o.e.label.withConfig({displayName:"GaSettings___StyledLabel2"})(["",";"],(function(e){return e._css4})),mt=Object(o.e)(u.I).withConfig({displayName:"GaSettings___StyledInlineInput2"})(["&:focus{border:none;}&::placeholder{color:",";}&:disabled{color:",";}"],(function(e){return e._css5}),(function(e){return e._css6})),gt=function(){return c.a.createElement(u.m,{mt:"4px"},c.a.createElement(dt,{htmlFor:"google-analytics",_css:Object(ve.themeGet)("textStyles.small")},"Google Analytics"),c.a.createElement(pt,{name:"google-analytics",id:"google-analytics",type:"text",mt:"4px",placeholder:"GA-XXXXXX",_css2:u.Rb.darkGray,_css3:u.Rb.gray}),c.a.createElement(u.m,{mt:"4px"},c.a.createElement(ft,{htmlFor:"google-tag-manager",_css4:Object(ve.themeGet)("textStyles.small")},"Google Tag Manager"),c.a.createElement(mt,{name:"google-tag-manager",id:"google-tag-manager",type:"text",mt:"4px",placeholder:"GTM-XXXXXX",_css5:u.Rb.darkGray,_css6:u.Rb.gray})))};function bt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ht(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ht(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var yt,vt=o.e.label.withConfig({displayName:"DomainTab___StyledLabel"})(["",";"],(function(e){return e._css})),wt=Object(o.e)(u.I).withConfig({displayName:"DomainTab___StyledInlineInput"})(["&:focus{border:none;}&::placeholder{color:",";}&:disabled{color:",";}"],(function(e){return e._css2}),(function(e){return e._css3})),jt=function(){var e=Object(i.useContext)(Qc),t=bt(Object(i.useState)(""),2),r=t[0],n=t[1],a=bt(Object(i.useState)((function(){return e.project.domain})),2),o=a[0],l=a[1],s=bt(Object(i.useState)(),2),d=s[0],p=s[1],f=bt(Object(i.useState)(!1),2),m=f[0],g=f[1],b=bt(Object(i.useState)(!1),2),h=b[0],y=b[1];Object(i.useEffect)((function(){l(e.project.domain)}),[e.project.domain]);return c.a.createElement(c.a.Fragment,null,!o&&c.a.createElement(c.a.Fragment,null,c.a.createElement(vt,{htmlFor:"project-domain",_css:Object(ve.themeGet)("textStyles.small")},"Enter registered domain name"),c.a.createElement(wt,{name:"project-domain",id:"project-domain",type:"text",mt:"4px",spellCheck:!1,autoComplete:"off",autoCorrect:"off",placeholder:"yourdomainname.com",value:r,onKeyDown:function(e){13===e.keyCode&&(e.preventDefault(),e.currentTarget.blur())},onChange:function(e){var t;d&&p(void 0),m&&g(!1),n((t=e.currentTarget.value,t.trim().replace(/^\/\//,"").replace(/^[A-Za-z]+?:\/\//,"").replace(/\/.*$/,"").replace(/:\d*$/,"").replace(/^.*?@/,"").trim()))},_css2:u.Rb.darkGray,_css3:u.Rb.gray}),c.a.createElement(u.n,{width:"100%",height:40,mt:"2px",mb:14,variant:"bordered",textStyle:"small",disabled:!r||h,onClick:function(){r&&!h&&(/:|@|\\|\//.test(r)?p("invalid"):(y(!0),e.checkDomain(r).then((function(e){return console.log("data",e),e.errors.badDomainName?(p("invalid"),void(window.RM.analytics&&window.RM.analytics.sendEvent("Map Domain","error: invalid symbols"))):e.errors.domainNotFound?(p("notfound"),void(window.RM.analytics&&window.RM.analytics.sendEvent("Map Domain","error: nslookup not found"))):void g(!0)})).catch((function(){p("server-error")})).finally((function(){y(!1)}))))}},"Test"),d&&c.a.createElement(Ce,{m:"0 0 14px"},function(){switch(d){case"invalid":return c.a.createElement(c.a.Fragment,null,c.a.createElement(u.zb,{textStyle:"small",color:"black"},"Domain name may contain only alphanumeric characters. No directories are allowed.",c.a.createElement("br",null),"Examples:"),c.a.createElement("br",null),c.a.createElement(u.zb,{textStyle:"small",color:"gray"},"mydomain.com",c.a.createElement("br",null),"www.mydomain.com",c.a.createElement("br",null),"readymag.mydomain.com"));case"server-error":return c.a.createElement(u.zb,{textStyle:"small",color:"black"},"Something went wrong.",c.a.createElement("br",null),"Please try again later.");case"notfound":return c.a.createElement(u.zb,{textStyle:"small",color:"black"},"Domain’s info is not available. Please check if the name is correct. Note, that sometimes it may take few hours for subdomain to be created.");default:return null}}()),m&&c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{m:"0 0 14px"},c.a.createElement(u.zb,{textStyle:"small",color:"green"},"Вроде ок",c.a.createElement("br",null),"(может быть и не ок",c.a.createElement("br",null),"не все проверки реализованы)")),c.a.createElement(u.n,{width:"100%",height:40,mb:14,variant:"bordered",textStyle:"small",onClick:function(){r&&!h&&(y(!0),e.mapDomain(r).then((function(){var e=/^www\./.test(r)?" www":"";window.RM.analytics&&window.RM.analytics.sendEvent("Map Domain","success"+e)})).catch((function(){p("server-error")})).finally((function(){y(!1)})))}},"Map"))),o&&c.a.createElement(at,null),!o&&c.a.createElement(ut,null),c.a.createElement(gt,null))},St=7100,Ot=9999,xt="0.3s";!function(e){e.Duplicate="duplicate",e.Delete="detele",e.Settings="settings",e.GoToPage="gotopage"}(yt||(yt={}));var Et=r("saLn");function _t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Pt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ct,kt=Object(o.e)(u.zb).withConfig({displayName:"ScaleSwitch___StyledText"})(["white-space:nowrap;"]),It=function(e){var t=e.checked,r=e.maxWidth,n=e.onChange,a=e.onMaxWidthChange,o=e.m,i=_t(Object(Et.a)((function(e){return a(e)}),500),1)[0];return c.a.createElement(u.C,{width:216,height:104,p:16,borderRadius:52,alignItems:"center",bg:t?"green":"gray",cursor:"pointer",onClick:function(){return n(!t)},m:o},c.a.createElement(u.Mb,{as:"input",type:"checkbox",checked:t,onChange:function(){return n(t)}}),t?c.a.createElement(kt,{as:"label",color:"white",textStyle:"small",lineHeight:"32px",height:32,cursor:"text",userSelect:"none",onClick:function(e){return e.stopPropagation()}},"Scale layout up to ",c.a.createElement(u.m,{display:"inline-block"},c.a.createElement(u.X,{autoWidth:!0,color:"orange",textStyle:"small",positive:!0,p:0,value:r,onChange:i})),"px"):c.a.createElement(u.zb,{color:"white",textStyle:"small",userSelect:"none"},"Scale layout"))};function At(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Rt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Rt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}!function(e){e.Vertical="vertical",e.Horizontal="horizontal"}(Ct||(Ct={}));var Tt=Object(o.e)(u.m).withConfig({displayName:"DirectionSwitch___StyledBox"})(["transform:translateX(",");transition:transform 0.2s ease-in-out;"],(function(e){return e._css})),Mt=function(e){var t=e.direction,r=e.onChange,n=e.m,a=At(Object(i.useState)(t!==Ct.Horizontal),2),o=a[0],l=a[1];return c.a.createElement(u.C,{position:"relative",width:216,height:104,bg:"gray",borderRadius:52,justifyContent:"space-between",cursor:"pointer",m:n,onClick:function(){l(!o),r(o?Ct.Horizontal:Ct.Vertical)}},c.a.createElement(u.Mb,{as:"select",value:t,onChange:function(e){r(e.currentTarget&&e.currentTarget.value===Ct.Horizontal?Ct.Horizontal:Ct.Vertical)}}),c.a.createElement(Tt,{position:"absolute",width:104,height:104,borderRadius:52,p:16,bg:"green",_css:o?"0px":"112px"}),c.a.createElement(u.C,{position:"absolute",left:0,alignItems:"center",width:104,height:104,borderRadius:52,p:16},c.a.createElement(u.zb,{textStyle:"small",color:"white",userSelect:"none"},"Vertical")),c.a.createElement(u.C,{position:"absolute",right:0,alignItems:"center",width:104,height:104,borderRadius:52,p:16},c.a.createElement(u.zb,{textStyle:"small",color:"white",display:"block",userSelect:"none"},"Horizontal")))},Nt=Object(o.e)(u.m).withConfig({displayName:"ArrowSwitch___StyledBox"})(["transform:rotate(45deg);"]),Dt=Object(o.e)(u.m).withConfig({displayName:"ArrowSwitch___StyledBox2"})(["transform:rotate(45deg);"]),zt=function(e){var t=e.arrowsOn,r=e.slideIn,n=e.slideInRequiresArrows,a=e.arrowsDisabled,o=e.onArrowsChange,i=e.onSlideInChange,l=e.m,s=n&&!t;return c.a.createElement(u.C,{position:"relative",width:216,height:104,alignItems:"center",justifyContent:"space-between",m:l},c.a.createElement(u.Mb,{as:"input",type:"checkbox",checked:t,onChange:function(){return o(!t)}}),c.a.createElement(u.Mb,{as:"input",type:"checkbox",checked:r,onChange:function(){return i(!r)}}),c.a.createElement(u.m,{position:"absolute",width:110,height:104,left:0,right:0,m:"auto",bg:r?"green":"gray",cursor:s?"auto":"pointer",onClick:function(){return!s&&i(!r)},opacity:s?0:r?.7:1},c.a.createElement(Nt,{position:"absolute",right:-46,top:0,bottom:0,m:"auto",width:90,height:90,borderRadius:28,bg:"inherit"}),c.a.createElement(u.C,{position:"absolute",left:59,width:104,height:104,p:16,alignItems:"center"},c.a.createElement(u.zb,{color:"white",textStyle:"small"},"Slide-in",c.a.createElement("br",null),"transition"))),c.a.createElement(u.C,{position:"relative",width:104,height:104,p:16,alignItems:"center",cursor:a?"auto":"pointer",onClick:function(e){e.stopPropagation(),o(!t)}},c.a.createElement(Dt,{position:"absolute",left:8,width:90,height:90,borderRadius:28,bg:"lightGray"},c.a.createElement(u.m,{width:"100%",height:"100%",borderRadius:28,position:"absolute",bg:t?"green":"gray",opacity:a?.5:1})),c.a.createElement(u.zb,{position:"relative",color:"white",textStyle:"small",userSelect:"none"},"Navigation",c.a.createElement("br",null),"arrows")))},Ut=r("Kf/z");function Ft(e){return function(e){if(Array.isArray(e))return Bt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Bt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Bt(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Lt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Gt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lt(Object(r),!0).forEach((function(t){Ht(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ht(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Wt=Object(o.e)(Ne).withConfig({displayName:"ViewerPanel__OptionHint"})([""]),Vt=Object(o.e)(u.zb).withConfig({displayName:"ViewerPanel__OptionText"})([""]),Yt=Object(o.e)(u.C).withConfig({displayName:"ViewerPanel__OptionRow"})(["justify-content:space-between;align-items:center;","{flex:1;}","{visibility:hidden;}&:hover{","{visibility:visible;}}"],Vt,Wt,Wt),$t=Object(o.e)(u.m).withConfig({displayName:"ViewerPanel___StyledBox"})(["transform:translateX(",");transition:transform "," ease;"],(function(e){return e._css}),(function(e){return e._css2})),Xt=function(e){var t=e.m,r=e.width,n=Object(i.useContext)(Qc),a=n.project.user.permissions.viewer_opts_overrides||{},o=Gt(Gt(Gt(Gt({},n.project.opts),a),n.project.is_private&&{sharebutton:!1}),!n.project.opts.menubutton&&{projectinfo:!1}),l=[].concat(Ft(Object.keys(a)),Ft(o.menubutton?[]:["projectinfo"]),Ft(n.project.is_private?["sharebutton"]:[])),s=Object.keys(a).includes("arrows");return c.a.createElement($t,{m:t,width:r,_css:"0px",_css2:xt},c.a.createElement(It,{checked:o.scalableviewer,maxWidth:o.scalewidth,onChange:function(e){return n.setProjectOptions({scalableviewer:e})},onMaxWidthChange:function(e){return n.setProjectOptions({scalewidth:e})},m:"6px 0 8px 0"}),c.a.createElement(Mt,{direction:o.viewertype,onChange:function(e){return n.setProjectOptions({viewertype:e})},m:"8px 0"}),c.a.createElement(zt,{arrowsOn:o.arrows,slideIn:o.slidein,slideInRequiresArrows:o.viewertype===Ct.Horizontal,arrowsDisabled:l.includes("arrows"),onArrowsChange:function(e){return n.setProjectOptions({arrows:e})},onSlideInChange:function(e){return n.setProjectOptions({slidein:e})},m:"8px 0"}),c.a.createElement(u.m,{m:"16px"},s&&c.a.createElement(Ce,{m:"16px 0",p:"12px 16px"},c.a.createElement(u.zb,{textStyle:"small"},"Please"," ",c.a.createElement(u.rb,{href:"/pricing",target:"_blank",textStyle:"small",isActive:!0},"upgrade")," ","your account to manage the white label settings.")),c.a.createElement(Yt,{my:"4px"},c.a.createElement(Vt,{textStyle:"small",opacity:l.includes("menubutton")?.4:1},"Project menu"),c.a.createElement(Wt,{text:"Arrows to switch between the pages at the right and left sides of each page.",mr:"4px"}),c.a.createElement(u.wb,{backgroundChecked:"green",checked:o.menubutton,disabled:l.includes("menubutton"),onChange:function(e){return n.setProjectOptions({menubutton:e})}})),c.a.createElement(Yt,{my:"4px"},c.a.createElement(Vt,{textStyle:"small",opacity:l.includes("projectinfo")?.4:1},"Project info"),c.a.createElement(u.wb,{backgroundChecked:"green",checked:o.projectinfo,disabled:l.includes("projectinfo"),onChange:function(e){return n.setProjectOptions({projectinfo:e})}})),c.a.createElement(Yt,{my:"4px"},c.a.createElement(Vt,{textStyle:"small",opacity:l.includes("sharebutton")?.4:1},"Share button"),c.a.createElement(u.wb,{backgroundChecked:"green",checked:o.sharebutton,disabled:l.includes("sharebutton"),onChange:function(e){return n.setProjectOptions({sharebutton:e})}})),c.a.createElement(Yt,{my:"4px"},c.a.createElement(Vt,{textStyle:"small",opacity:l.includes("pagecounter")?.4:1},"Page counter"),c.a.createElement(u.wb,{backgroundChecked:"green",checked:o.pagecounter,disabled:l.includes("pagecounter"),onChange:function(e){return n.setProjectOptions({pagecounter:e})}})),c.a.createElement(Yt,{my:"4px"},c.a.createElement(Vt,{textStyle:"small",opacity:l.includes("controlsontop")?.4:1},"Place buttons on top"),c.a.createElement(u.wb,{backgroundChecked:"green",checked:o.controlsontop,disabled:l.includes("controlsontop"),onChange:function(e){return n.setProjectOptions({controlsontop:e})}})),Object(Ut.a)("constructor.imageLqip")&&c.a.createElement(Yt,{my:16},c.a.createElement(Vt,{textStyle:"small",opacity:l.includes("lqip")?.4:1},"Progressive images"),c.a.createElement(Wt,{text:"Use blurred images to preview while loading.",mr:"4px"}),c.a.createElement(u.wb,{backgroundChecked:"green",checked:o.lqip,disabled:l.includes("lqip"),onChange:function(e){return n.setProjectOptions({lqip:e})}})),c.a.createElement(Yt,{my:16},c.a.createElement(Vt,{textStyle:"small",opacity:l.includes("endpage")?.4:1},"Readymag branding"),c.a.createElement(u.wb,{backgroundChecked:"green",checked:o.endpage,disabled:l.includes("endpage"),onChange:function(e){return n.setProjectOptions({endpage:e})}}))))},qt=Object(o.e)(u.C).withConfig({displayName:"ProjectSettings___StyledFlex"})(["user-select:none;&:hover{& span{color:",";}}"],(function(e){return e._css})),Kt=Object(o.e)(u.C).withConfig({displayName:"ProjectSettings___StyledFlex2"})(["user-select:none;&:hover{& span{color:",";}}"],(function(e){return e._css2})),Jt=Object(o.e)(u.C).withConfig({displayName:"ProjectSettings___StyledFlex3"})(["user-select:none;&:hover{& span{color:",";}}"],(function(e){return e._css3})),Zt=Object(o.e)(u.C).withConfig({displayName:"ProjectSettings___StyledFlex4"})(["user-select:none;&:hover{& span{color:",";}}"],(function(e){return e._css4})),Qt=function(e){var t=e.projectSettingsPanel,r=Object(i.useContext)(Qc),n=K(r.project),a=Object(i.useMemo)((function(){return r.hasProjectCode()}),[r.project.ci_head,r.project.ci_css,r.project.ci_body_top,r.project.ci_body_bottom]),o=function(){return r.openCodeEditor()};return c.a.createElement(u.m,{width:"100%",height:"100%",pt:"16px"},c.a.createElement(u.C,{justifyContent:"space-between",p:"0 24px",position:"relative",zIndex:1},c.a.createElement(u.zb,{textStyle:"small",color:n===N.UnpublishedChanges?"tomato":"darkGray"},X(r.project)),c.a.createElement(u.rb,{textStyle:"small",color:"darkGray",href:"".concat($.a.readymag_host,"/learn")},"Help")),c.a.createElement(u.C,{width:"100%",height:"calc(100% - 97px)",mt:"-4px"},c.a.createElement(u.a,{springConfig:{mass:1,tension:210,friction:20,clamp:!0}},c.a.createElement(u.r,{renderButton:function(e){var t=e.isActive;return(c.a.createElement(qt,{width:"100%",height:48,px:24,justifyContent:"left",alignItems:"center",cursor:"pointer",_css:t?u.Rb.black:u.Rb.tomato},c.a.createElement(u.zb,{color:"black",textStyle:"subheading"},"Project settings")))},open:!0},(function(e){return c.a.createElement(u.m,{ref:e,px:24,pb:24},c.a.createElement(Ze,{projectSettingsPanel:t}))})),c.a.createElement(u.r,{renderButton:function(e){var t=e.isActive;return(c.a.createElement(Kt,{width:"100%",height:48,px:24,justifyContent:"left",alignItems:"center",cursor:"pointer",_css2:t?u.Rb.black:u.Rb.tomato},c.a.createElement(u.m,{width:224,height:2,position:"absolute",top:-1,left:8,borderRadius:"xs",bg:"gray"}),c.a.createElement(u.zb,{color:"black",textStyle:"subheading"},"Viewer")))}},(function(e){return c.a.createElement(u.m,{ref:e,px:24},c.a.createElement(Xt,{m:"0 0 0 -16px",width:216}))})),c.a.createElement(u.r,{renderButton:function(e){var t=e.isActive;return(c.a.createElement(Jt,{width:"100%",height:48,px:24,justifyContent:"left",alignItems:"center",cursor:"pointer",_css3:t?u.Rb.black:u.Rb.tomato},c.a.createElement(u.m,{width:224,height:2,position:"absolute",top:-1,left:8,borderRadius:"xs",bg:"gray"}),c.a.createElement(u.zb,{color:"black",textStyle:"subheading"},"Code"),a&&c.a.createElement(u.m,{width:"6px",height:"6px",borderRadius:"round",bg:"black",position:"absolute",right:24,top:21})))}},(function(e){return c.a.createElement(u.m,{ref:e,px:24},c.a.createElement(Qe,{hasProjectCode:a,showUpgradeAlert:!r.me.permissions.can_inject_code,onOpenCodeEditorClick:o}))})),c.a.createElement(u.r,{renderButton:function(e){var t=e.isActive;return(c.a.createElement(Zt,{width:"100%",height:48,px:24,justifyContent:"left",alignItems:"center",cursor:"pointer",_css4:t?u.Rb.black:u.Rb.tomato},c.a.createElement(u.m,{width:224,height:2,position:"absolute",top:-1,left:8,borderRadius:"xs",bg:"gray"}),c.a.createElement(u.zb,{color:"black",textStyle:"subheading"},"Domain"),!t&&c.a.createElement(u.m,{width:224,height:2,position:"absolute",bottom:-1,left:8,borderRadius:"xs",bg:"gray"})))}},(function(e){return c.a.createElement(u.m,{ref:e,px:24,pb:24},c.a.createElement(jt,null))})))),c.a.createElement(ye,null))},er=r("xG9w"),tr=r("LZwC"),rr=r.n(tr);function nr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ar(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ar(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ar(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var or=Object(o.e)(u.C).withConfig({displayName:"PopupBody___StyledFlex"})(["cursor:pointer;"]),ir=Object(o.e)(u.m).withConfig({displayName:"PopupBody___StyledBox"})(["background-image:url('","');background-position:center;background-size:cover;background-repeat:no-repeat;"],rr.a),cr=Object(o.e)(u.C).withConfig({displayName:"PopupBody___StyledFlex2"})(["cursor:pointer;"]),lr=Object(o.e)(u.C).withConfig({displayName:"PopupBody___StyledFlex3"})(["background-image:",";background-position:center;background-repeat:no-repeat;background-size:cover;"],(function(e){return e._css})),sr=function(e){var t=e.onMyTemplatesClick,r=e.onRmTemplatesClick,n=e.isUserTemplatesLoading,a=e.userTemplatesScreenshot,o=nr(Object(i.useState)(!1),2),l=o[0],s=o[1],d=nr(Object(i.useState)(!1),2),p=d[0],f=d[1];return c.a.createElement(u.C,{flexDirection:"column",color:"white",pt:3,pl:3,pb:3},c.a.createElement(or,{"aria-labelledby":"show-rm-templates-modal",alignItems:"center",onMouseEnter:function(){return s(!0)},onMouseLeave:function(){return s(!1)},onClick:function(e){e.preventDefault(),r()}},c.a.createElement(ir,{width:88,height:60,borderRadius:"s",bg:"grey"}),c.a.createElement(u.zb,{textStyle:"small",ml:3,color:l?"tomato":"white"},"R/m templates")),c.a.createElement(cr,{"aria-labelledby":"show-user-templates-modal",alignItems:"center",mt:3,onMouseEnter:function(){return f(!0)},onMouseLeave:function(){return f(!1)},onClick:function(e){return function(e){e.preventDefault(),t()}(e)}},c.a.createElement(lr,{width:88,height:60,borderRadius:"s",justifyContent:"center",alignItems:"center",bg:"grey",_css:a?"url(".concat(a,")"):"none"},!a&&n&&c.a.createElement(u.R,{bgColor:"transparent"})),c.a.createElement(u.zb,{textStyle:"small",ml:3,color:p?"tomato":"white"},"My templates")))},ur=Object(o.e)(u.m).withConfig({displayName:"MyTemplatesModal___StyledBox"})(["overflow-y:auto;"]),dr=c.a.memo((function(e){var t=e.isShown,r=e.width,n=e.height,a=e.isLoading,o=e.children,l=Object(i.useRef)(null);return s.a.createPortal(c.a.createElement(c.a.Fragment,null,t?c.a.createElement(ur,{id:"my-templates-modal",ref:l,width:"".concat(r,"px"),height:"".concat(n,"px"),position:"absolute",top:"calc(50% - ".concat(n/2,"px)"),left:"calc(50% - ".concat(r/2,"px)"),zIndex:9999,borderRadius:"l",bg:"black"},a?c.a.createElement(u.C,{width:"100%",height:"100%",justifyContent:"center",alignItems:"center"},c.a.createElement(u.R,{bgColor:"transparent"})):o):null),document.body)}));dr.displayName="MyTemplatesModal";var pr=dr,fr=r("YqYG"),mr=r("eQZl");function gr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return br(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return br(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function br(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var hr=function(e){var t=e.isShown,r=e.addPageFromTemplate,n=Object(i.useContext)(Qc),a=gr(Object(i.useState)(null),2),o=a[0],l=a[1],s=function(){o&&o.remove();var e=new fr.default({$parent:document.querySelector("body > .popups"),router:window.RM.constructorRouter,opts:{type:"type-more-pages",is_contributor:!window.RM.constructorRouter.isOwner,owner_email:n.project.user?n.project.user.email:""},alert_source:"page from rm template"});e.render(),l(e)},u=gr(Object(i.useState)(null),2),d=u[0],p=u[1],f=Object(i.useRef)(!1),m=function(e){r(e)},g=function(e){if(e.templates&&e.templates.length&&!f.current){var t=0;f.current=!0,function a(){r(e.templates[t++],n.currentPageNum+t).then((function(){t!==e.templates.length?a():f.current=!1})).catch((function(){f.current=!1}))}()}};return Object(i.useEffect)((function(){var e=new mr.a({router:window.RM.constructorRouter,pagesAlert:s,showBlockLayer:!1});e.on("add-page",m),e.on("add-multiple",g),p(e)}),[]),Object(i.useEffect)((function(){d&&(d.off("add-page"),d.off("add-multiple"),d.on("add-page",m),d.on("add-multiple",g))}),[n.currentPageNum,n.pagesParams]),Object(i.useEffect)((function(){d&&(t?d.show():d.hide())}),[t]),c.a.createElement(c.a.Fragment,null)};function yr(e){return function(e){if(Array.isArray(e))return jr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||wr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||wr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wr(e,t){if(e){if("string"==typeof e)return jr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?jr(e,t):void 0}}function jr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Sr=Object(o.e)(u.C).withConfig({displayName:"MyTemplatesModalBody___StyledFlex"})(["overflow-y:auto;"]),Or=Object(o.e)(u.C).withConfig({displayName:"MyTemplatesModalBody___StyledFlex2"})(["align-content:flex-start;"]),xr=Object(o.e)(u.m).withConfig({displayName:"MyTemplatesModalBody___StyledBox"})(["white-space:nowrap;text-overflow:ellipsis;overflow:hidden;"]),Er=Object(o.e)(u.C).withConfig({displayName:"MyTemplatesModalBody___StyledFlex3"})(["background-image:",";background-position:center center;background-repeat:no-repeat;background-size:cover;&:hover{.delete-template-button{opacity:1;}}"],(function(e){return e._css})),_r=Object(o.e)(u.hb).withConfig({displayName:"MyTemplatesModalBody___StyledRoundButton"})(["position:absolute;top:8px;right:8px;opacity:0;transition:opacity 0.15s ease;"]),Pr=Object(o.e)(u.I).withConfig({displayName:"MyTemplatesModalBody___StyledInlineInput"})(["&:focus{border-bottom:none;}"]),Cr=function(e){var t=e.templates,r=e.newTemplateTitle,n=e.createNewUserTemplate,a=e.addPageFromTemplate,o=e.deleteUserTemplate,l=vr(Object(i.useState)(!1),2),s=l[0],d=l[1],p=vr(Object(i.useState)([]),2),f=p[0],m=p[1],g=vr(Object(i.useState)(!1),2),b=g[0],h=g[1],y=vr(Object(i.useState)(!1),2),v=y[0],w=y[1],j=vr(Object(i.useState)(!1),2),S=j[0],O=j[1],x=function(e){if(e.preventDefault(),e.stopPropagation(),!s){var t="pending-".concat(Date.now());d(!0),m([{id:t,pending:!0,thumb:""}].concat(yr(f))),n().then((function(){d(!1)})).catch((function(){d(!1)})).finally((function(){m(f.filter((function(e){return e.id!==t})))}))}},E=Object(i.useCallback)((function(e){13===e.keyCode&&(e.preventDefault(),e.target.blur())}),[]),_=Object(i.useCallback)((function(e,t){return t&&Object(ke.x)(e,t)}),[]);return c.a.createElement(Sr,{width:"100%",height:"100%",borderRadius:"l"},c.a.createElement(u.ib,null,(function(e){var n=e.ref;return(c.a.createElement(Or,{ref:n,width:"100%",height:"100%",py:"24px",px:"68px",flexWrap:"wrap"},c.a.createElement(u.C,{cursor:"pointer",flexDirection:"column",onMouseEnter:function(){return h(!0)},onMouseLeave:function(){return h(!1)}},c.a.createElement(u.C,{width:216,height:141,mx:"12px",position:"relative",justifyContent:"center",alignItems:"center",bg:"darkGray",borderRadius:"s",cursor:"pointer",onClick:x},c.a.createElement(u.cb,{color:b?"white":"black"})),c.a.createElement(xr,{width:216,mx:"12px",mb:"8px",mt:"6px",p:"0 0 10px 0",color:b?"white":"darkGray"},c.a.createElement(u.zb,{textStyle:"small",textAlign:"center",color:b?"white":"darkGray"},r))),[].concat(yr(f),yr(t)).map((function(e){return c.a.createElement(u.C,{flexDirection:"column",key:e.id},c.a.createElement(Er,{key:e.id,width:216,height:141,mx:"12px",position:"relative",bg:"darkGray",borderRadius:"s",justifyContent:"center",alignItems:"center",cursor:"pointer",onClick:function(t){return!e.pending&&function(e,t,r){e.preventDefault(),e.stopPropagation(),a({template:t,custom:!0,specialScreenshot:r})}(t,e.id,e.thumb)},_css:e.thumb?"url(".concat(e.thumb,")"):"none"},e.pending&&c.a.createElement(u.R,{bgColor:"transparent"}),!e.pending&&c.a.createElement(_r,{size:32,className:"delete-template-button",color:"white",hoverColor:"white",activeColor:"tomato",outline:!0,onMouseEnter:function(){return w(e.id)},onMouseLeave:function(){S&&O(!1),w(!1)},onMouseDown:function(){return O(e.id)},onMouseUp:function(){return O(!1)},onClick:function(t){return function(e,t){e.preventDefault(),e.stopPropagation(),o(t)}(t,e.id)}},c.a.createElement(u.x,{color:S&&S===e.id?"white":v&&v===e.id?"tomato":"black"}))),c.a.createElement(Pr,{mx:"12px",mb:"8px",mt:"6px",p:"0 0 10px 0",width:"auto",type:"text",textStyle:"small",color:"white",spellCheck:!1,placeholder:"Template title",defaultValue:e.title,disabled:e.pending,onBlur:function(t){return _(e.id,t.target.value)},onKeyDown:E,textAlign:"center"}))}))))})))};function kr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ir(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ir(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ir(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ar=c.a.memo((function(e){var t=e.isTrashOpened,r=e.isSettingsOpened,n=Object(i.useContext)(v),o=Object(i.useContext)(Qc),l=kr(Object(i.useState)(!1),2),s=l[0],d=l[1],p=kr(Object(i.useState)(!1),2),f=p[0],m=p[1],g=Object(u.Ub)({watchingClick:s,callback:function(){d(!1)}});Object(i.useEffect)((function(){r&&s&&(m(!0),o.getUserTemplates().then((function(){m(!1)})).catch((function(e){m(!1),e&&console.warn(e.message)})))}),[r,s]);var b=Object(i.useMemo)((function(){var e=o.pages.find((function(e){return e._id===o.currentPageId}));return e&&e.title?e.title:"page ".concat(o.currentPageNum)}),[o.currentPageNum]),h=function(e,t){return o.addNewPage(t||o.currentPageNum,e)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(u.n,{"aria-labelledby":"toggle-templates-popup",color:s?"tomato":"darkGray",textStyle:"small",onClick:function(e){e.preventDefault(),d(!s)}},"Add"),c.a.createElement(I,{ref:g,width:224,height:168,isShown:s,coords:{right:8,bottom:80},transform:t?"translateX(-240px)":"translateX(0px)",placement:S.Bottom,rootElement:document.querySelector("#settings-container")},c.a.createElement(sr,{onRmTemplatesClick:function(){d(!1),n.dispatch({type:a.ToggleRmTemplatesModal})},onMyTemplatesClick:function(){d(!1),n.dispatch({type:a.ToggleUserTemplatesModal})},isUserTemplatesLoading:f,userTemplatesScreenshot:o.userTemplates.length?o.userTemplates[0].thumb:void 0})),c.a.createElement(pr,{width:880,height:576,isShown:n.isUserTemplatesModalShown,isLoading:f},c.a.createElement(Cr,{templates:o.userTemplates,newTemplateTitle:"Create template from ".concat(b),createNewUserTemplate:o.createTemplateFromCurrentPage,addPageFromTemplate:h,deleteUserTemplate:o.deleteUserTemplate})),c.a.createElement(hr,{isShown:n.isRmTemplatesModalShown,addPageFromTemplate:h}))}));Ar.displayName="AddFromTemplatesButton";var Rr=Ar;function Tr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Mr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Mr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Nr=Object(o.e)(u.m).withConfig({displayName:"SettingsFooter___StyledBox"})(["animation:1.5s blinkAnimation infinite linear;@keyframes blinkAnimation{from{opacity:1;}33%{opacity:1;}34%{opacity:0;}66%{opacity:0;}67%{opacity:1;}to{opacity:1;}}"]),Dr=function(){var e=Object(i.useContext)(v),t=Object(i.useContext)(Qc),r=Tr(Object(i.useState)(null),2),n=r[0],o=r[1];return c.a.createElement(u.m,{width:"100%",height:95,position:"absolute",left:0,bottom:0},c.a.createElement(u.m,{position:"absolute",left:24,bottom:36},c.a.createElement(Rr,{isTrashOpened:e.isTrashOpened,isSettingsOpened:e.isSettingsOpened})),c.a.createElement(u.n,{position:"absolute",left:107,bottom:31},c.a.createElement(u.cb,{"aria-labelledby":"add-blank-page",onClick:function(r){r.preventDefault(),e.dispatch({type:a.SetAddingPage,inProgress:!0}),t.addNewPage(t.currentPageNum).finally((function(){e.dispatch({type:a.SetAddingPage,inProgress:!1})})).catch((function(e){e&&"permission_denied"===e.err&&function(){n&&n.remove();var e=new fr.default({$parent:document.querySelector("body > .popups"),router:window.RM.constructorRouter,opts:{type:"type-more-pages",is_contributor:!window.RM.constructorRouter.isOwner,owner_email:t.project.user?t.project.user.email:""},alert_source:"blank page"});e.render(),o(e)}()}))}})),(t.project.has_deleted_pages||e.isTrashOpened)&&c.a.createElement(c.a.Fragment,null,t.pageRecentlyDeleted&&c.a.createElement(Nr,{width:"6px",height:"6px",borderRadius:"round",bg:"tomato",position:"absolute",right:e.isTrashOpened?60:48,bottom:41}),c.a.createElement(u.n,{"aria-labelledby":"toggle-pages-bin",color:e.isTrashOpened?"tomato":"darkGray",textStyle:"small",position:"absolute",right:24,bottom:36,onClick:function(r){r.preventDefault(),(t.project.has_deleted_pages||e.isTrashOpened)&&e.dispatch({type:a.ToggleTrash})}},e.isTrashOpened?"Close":"Bin")))};function zr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ur(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zr(Object(r),!0).forEach((function(t){Fr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Fr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Br(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Lr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Gr=c.a.createContext({}),Hr=c.a.createContext({}),Wr="undefined"!=typeof window&&(window.requestAnimationFrame||window.setImmediate)||function(e){return setTimeout(e,0)},Vr=function(e){var t=e.onBeforeDragStart,r=e.onDragStart,n=e.children,a=e.idList,o=e.isDragOff,l=e.onDragEnd,s=e.onAfterDragEnd,u=e.unionOn,d=Br(Object(i.useState)({startX:0,startY:0,refList:{},dropableList:{},originalDropable:"",draggableRef:null,origDropableRef:null,origDragableIdx:0,draggableId:"",flatList:[],excluded:[]}),2),p=d[0],f=d[1],m=Object(i.useRef)([]),g=Br(Object(i.useState)({isDragOff:Boolean(o)}),2),b=g[0],h=g[1],y=u?.8:.5,v=(p.startX,p.startY),w=p.refList,j=p.dropableList,S=p.originalDropable,O=p.draggableRef,x=p.origDropableRef,E=p.origDragableIdx,_=p.draggableId,P=p.flatList,C=p.excluded,k=Br(Object(i.useState)(!1),2),I=k[0],A=k[1],R=Object(i.useRef)(!1),T=Object(i.useRef)(!1),M=function(e){R.current=e,A(e)},N=Object(i.useRef)(!1),D=Object(i.useRef)(0),z=Object(i.useRef)(0),U=Object(i.useRef)(0),F=Object(i.useRef)(0),B=Object(i.useRef)(0),L=Object(i.useRef)(0),G=Object(i.useRef)(""),H=Object(i.useRef)(null),W=Object(i.useRef)(void 0),V=Object(i.useRef)(void 0),Y=Object(i.useRef)(50),$=Object(i.useRef)(0),X=Object(i.useRef)(0),q=Object(i.useRef)(0),K=Object(i.useRef)(0),J=Object(i.useRef)(0),Z=Br(Object(i.useState)(""),2),Q=Z[0],ee=Z[1],te=Object(i.useRef)(""),re=function(e){te.current=e,ee(e)},ne=Br(Object(i.useState)(""),2),ae=ne[0],oe=ne[1],ie=Object(i.useRef)(""),ce=function(e){ie.current=e,oe(e)},le={setDraggable:function(e,r,n,o,i,c){if(!p.draggableId&&e&&n&&n.current){var l=t?t(e):[],s=function e(t){return Object(er.reduce)(t,(function(t,r){return t.push(r),r.items?t.concat(e(r.items)):t}),[])}(a);l.length&&(s=Object(er.filter)(s,(function(e){return!l.includes(e.id)})));var u=j[r],d=u.ref,g=u.parentId,b=Object(er.filter)(s,(function(e){return g?e.parentId===g:!e.parentId==!g})),h=n.current.getBoundingClientRect();B.current=Object(er.findIndex)(b,{id:e}),D.current=o,z.current=i,U.current=i;var y={startX:o,startY:i,draggableRef:n,originalDropable:r,draggableId:e,flatList:s,excluded:l,origDropableRef:d,origDragableIdx:B.current};for(var v in ce(g),Y.current=h.height,L.current=0,W.current=d,G.current=r,m.current=b,N.current=!1,F.current=0,V.current=c,$.current=c.current&&c.current.scrollTop||0,M(!1),j)if(!j[v].parentId){var w=j[v].ref;if(w&&w.current){H.current=w.current;var S=w.current.getBoundingClientRect();X.current=S.top,q.current=S.bottom,K.current=S.left,J.current=S.right}}f((function(e){return Ur(Ur({},e),y)}))}},pushDraggableRef:function(e,t){w[e]=t,t.current&&(t.current.className+=" sortable-item")},pushDropableRef:function(e,t,r){j[t]={ref:e,parentId:r,deltaSize:0},e.current&&(e.current.className+=" sortable-dropable")}},se=Object(i.useRef)(0),ue=function(){re(void 0),se.current&&(clearTimeout(se.current),se.current=0)};Object(i.useEffect)((function(){h((function(e){return Ur(Ur({},e),{},{isDragOff:Boolean(o)})}))}),[o]);var de=function(e){var t=j[e].ref;if(t.current){var r=j[e].deltaSize;if(r){t.current.style.height="auto";var n=t.current.getBoundingClientRect();t.current.style.height="".concat(n.height+r,"px")}else t.current.style.height=""}},pe=Object(i.useCallback)((function(e){var t=function(){if(_&&O&&O.current){var e=O.current.getBoundingClientRect().height;m.current.forEach((function(t,r){var n=t.id,a=w[n];a&&a.current&&(W.current!==x?W.current&&W.current.current&&x&&x.current&&(x.current.contains(W.current.current)?r<B.current+F.current?a.current.style.transform="translateY(0px)":a.current.style.transform="translateY(".concat(+e,"px)"):r<B.current+F.current?a.current.style.transform="translateY(0px)":a.current.style.transform="translateY(".concat(e,"px)")):r!==B.current&&(r<Math.min(B.current,B.current+F.current)||r>Math.max(B.current,B.current+F.current)?a.current.style.transform="translateY(0px)":F.current<0?a.current.style.transform="translateY(".concat(+e,"px)"):a.current.style.transform="translateY(".concat(-e,"px)")))})),O&&O.current&&(O.current.style.transform="translateY(".concat(z.current-v+L.current,"px)")),te.current=void 0,ue(),N.current=!1}};if(_&&!N.current){if(!R.current)return Math.abs(z.current-v)>4?(r&&r(),O&&O.current&&(O.current.style.zIndex="100000",O.current.style.cursor="pointer"),void M(!0)):void 0;if(T.current||V.current&&V.current.current&&O&&O.current&&function e(t,r){if(R.current){var n=t.getBoundingClientRect(),a=r.getBoundingClientRect();if(n.top-a.top<10&&r.scrollTop>0)T.current=!0,r.scrollTop-=15,pe(!0),Wr((function(){e(t,r)}));else if(a.bottom-n.bottom<10&&r.clientHeight+r.scrollTop<r.scrollHeight)T.current=!0,r.scrollTop+=15,pe(!0),Wr((function(){e(t,r)}));else if(T.current)if(T.current=!1,H.current){var o=H.current.getBoundingClientRect();X.current=o.top,q.current=o.bottom}else for(var i in j)if(!j[i].parentId){var c=j[i].ref;if(c&&c.current){var l=c.current.getBoundingClientRect();X.current=l.top,q.current=l.bottom}}}}(O.current,V.current.current),O&&O.current&&W.current&&W.current.current){var n=O.current.getBoundingClientRect(),a=parseInt((O.current.style.transform||"0").replace(/[^\-0-9]/g,"")),o=X.current-(n.top-a),i=q.current-(n.bottom-a),c=z.current-v+L.current+(V.current&&V.current.current?V.current.current.scrollTop-$.current:0),l=Math.min(i,Math.max(o,c));if(O.current.style.transform="translateY(".concat(l,"px)"),e)return;if(V.current&&V.current.current){var s=V.current.current.getBoundingClientRect();if(n.top-s.top<10)return;if(s.bottom-n.bottom<10)return}Y.current=n.height;var u=F.current,d=z.current-U.current,p=O.current.getBoundingClientRect(),f=(p.left+p.right)/2,g=d>0?p.bottom+2:p.top-2,b=document.elementFromPoint(f,g),h=b&&b.closest(".sortable-item"),C=b&&b.closest(".sortable-dropable"),k=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=j[e],a=Object(er.filter)(P,(function(e){return n.parentId?e.parentId===n.parentId:!e.parentId==!n.parentId}));j[e].deltaSize+=Y.current,de(e),j[G.current].deltaSize-=Y.current,de(G.current),m.current.forEach((function(e,t){var r=e.id,n=w[r];G.current===S?n&&n.current&&t!==B.current&&(t<B.current?n.current.style.transform="":n.current.style.transform="translateY(-".concat(Y.current,"px)")):n&&n.current&&(n.current.style.transform="")}));var o=a.find((function(e){return e.id===j[G.current].parentId}));o?e===S?(B.current=E,F.current=r>0?a.indexOf(o)+1-E:a.indexOf(o)-E):(B.current=0,F.current=r>0?a.indexOf(o)+1:a.indexOf(o)):e===S?(F.current=u>F.current?-E:a.length-E,B.current=E):(B.current=0,F.current=r>0?0:a.length);var i=m.current.findIndex((function(e){return e.id===n.parentId})),c=o?a.indexOf(o):-1;-1!==i&&E>i&&e!==S||-1!==c&&B.current+F.current<=c&&e!==S?L.current=-Y.current:L.current=0,ce(n.parentId),W.current=n.ref,G.current=e,m.current=a,U.current=z.current,N.current=!0,t()};if(d>0&&c-i>8&&ie.current)return void k("0",d);if(h&&W.current&&W.current.current){var I=h.getBoundingClientRect(),A=d>0?p.bottom-I.top:I.top+Y.current-p.top,D=Object.keys(w).find((function(e){return w[e].current===h}));if(C&&C!==W.current.current){var K=Object.keys(j).find((function(e){return j[e].ref.current&&j[e].ref.current===C}));if(K&&A>8)return void k(K,d)}var J=m.current.findIndex((function(e){return e.id===D})),Z=m.current.findIndex((function(e){return e.id===_}));if(-1!==J){var Q=m.current[J],ee=0;-1!==Z&&Z<=J&&d<0&&(ee=-1),-1!==Z&&Z>=J&&d>0&&(ee=1);var ne=Math.abs(J+ee-(B.current+F.current))>1||A>Y.current*y;if(!ne&&A>.2*Y.current&&!ie.current&&!se.current?function(e){se.current&&(clearTimeout(se.current),se.current=0),se.current=setTimeout((function(){re(e),se.current=0}),800)}(D):te.current&&te.current!==D&&se.current&&ue(),ne){if(Q.items){var ae=Object.keys(j).find((function(e){return j[e].ref.current&&j[e].parentId===Q.id}));if(ae)return void k(ae,d)}(u=J-B.current)===F.current&&(u+=d>0?1:-1)}}}else ue();F.current!==u&&(F.current=u,N.current=!0,t()),U.current=z.current}else ue()}}),[v,F,I]),fe=function(e){D.current=e.screenX,z.current=e.screenY,pe()},me=function(e){R.current&&(e.preventDefault(),M(!1),l&&(te.current?l(_,te.current,0,C):l(_,ie.current,B.current+F.current,C)),s&&s(),ue(),function(){for(var e in w){var t=w[e];t.current&&(t.current.style.transform="",t.current.style.zIndex="",t.current.style.border="",t.current.style.opacity="",t.current.style.background="",t.current.style.cursor="")}for(var r in j){var n=j[r].ref;n&&n.current&&(n.current.style.marginBottom="",n.current.style.paddingBottom="",n.current.style.height=""),j[r].deltaSize=0}}()),f((function(e){return Ur(Ur({},e),{},{draggableIdx:0,draggableId:"",dIdx:0})})),G.current=""};return Object(i.useEffect)((function(){return _?(window.addEventListener("mousemove",fe),window.addEventListener("mouseup",me)):(window.removeEventListener("mousemove",fe),window.removeEventListener("mouseup",me)),function(){window.removeEventListener("mousemove",fe),window.removeEventListener("mouseup",me)}}),[_]),c.a.createElement(Gr.Provider,{value:{parentId:ae,id:_,isActive:I,onItemId:Q}},c.a.createElement(Hr.Provider,{value:Ur(Ur({},b),le)},n({dragInProgress:I})))},Yr=function(e){var t=e.children,r=e.parentId,n=e.dropableId,a=Object(i.useContext)(Hr).pushDropableRef,o=Object(i.useRef)(null);return Object(i.useEffect)((function(){a(o,n,r)}),[]),c.a.createElement(c.a.Fragment,null,t({state:"",dropElementRef:o,dropableId:n}))},$r=function(e){var t=e.children,r=e.draggableId,n=e.dropableId,a=e.disabled,o=Object(i.useRef)(null),c=Object(i.useRef)(null),l=Object(i.useContext)(Hr),s=l.pushDraggableRef,d=l.setDraggable,p=l.isDragOff,f=Br(Object(i.useState)(0),2),m=f[0],g=f[1],b=Br(Object(i.useState)(0),2),h=b[0],y=b[1],v=function(e){e.preventDefault(),e.stopPropagation(),y(e.screenY),g(e.screenX)},w=Object(i.useContext)(u.jb).wrapperRef;return Object(i.useEffect)((function(){!a&&!p&&m&&h&&d(r,n,o,m,h,w)}),[m,h]),Object(i.useEffect)((function(){s(r,o);var e=c.current||o.current;return e&&(e.removeEventListener("mousedown",v),e.addEventListener("mousedown",v)),function(){e&&e.removeEventListener("mousedown",v)}}),[o.current,c.current]),t({state:"",ref:o,mouseDownRef:c})},Xr=Object(o.e)(u.ab).withConfig({displayName:"PageScreenshot___StyledPicture"})(["border-radius:4px;opacity:",";filter:blur(",");display:block;"],(function(e){return e._css}),(function(e){return e._css2})),qr=function(e){var t=e.url,r=e.opacity,n=e.blur,a=void 0!==n&&n,o=e.width,i=e.height;if(!t)return null;var l,s=t,d=t.split(".");if(d.length>1&&(l=d[d.length-2].split("_")),l&&(l.length<=1||isNaN(Number(l[l.length-1])))){var p=Ie.default.screenshotSize(256);s=Ie.default.addFilenameComponent(t,p)}return(c.a.createElement(u.m,{width:"100%",height:"100%",position:"relative"},c.a.createElement(Xr,{width:o||"100%",height:i||"100%",src:s,_css:void 0!==r?r:1,_css2:a?"1px":0}),c.a.createElement(u.m,{width:"100%",height:"100%",position:"absolute",top:0,left:0})))},Kr=function(e){var t=e.isPageSettingsOpened,r=e.hideDelete,n=e.actionCallback;return(c.a.createElement(u.m,{pl:3,pt:12},c.a.createElement(u.m,null,c.a.createElement(u.n,{"aria-labelledby":"duplicate-page",textStyle:"subheading",color:"white",onClick:function(e){e.preventDefault(),e.stopPropagation(),n(yt.Duplicate)}},"Duplicate")),c.a.createElement(u.m,{mt:12},c.a.createElement(u.n,{"aria-labelledby":"toggle-page-settings",textStyle:"subheading",color:t?"tomato":"white",onClick:function(e){e.preventDefault(),e.stopPropagation(),Pe.d.sendEvent(Pe.b.PageSEOOpen),n(yt.Settings)}},"Settings")),!r&&c.a.createElement(u.m,{mt:12},c.a.createElement(u.n,{"aria-labelledby":"delete-page",textStyle:"subheading",color:"white",onClick:function(e){e.preventDefault(),e.stopPropagation(),n(yt.Delete)}},"Delete"))))};function Jr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Zr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Qr=Object(o.e)(u.hb).withConfig({displayName:"PageActionsSmallPanel___StyledRoundButton"})(["opacity:",";transition:opacity 0.2s ease;&:hover{background-color:",";& svg{color:",";}}&:active{background-color:",";& svg{color:",";}}"],(function(e){return e._css}),(function(e){return e._css2}),(function(e){return e._css3}),(function(e){return e._css4}),(function(e){return e._css5})),en=Object(o.e)(u.hb).withConfig({displayName:"PageActionsSmallPanel___StyledRoundButton2"})(["opacity:",";transition:opacity 0.2s ease;"],(function(e){return e._css6})),tn=Object(o.e)(u.gb).withConfig({displayName:"PageActionsSmallPanel___StyledResponsiveAvatar"})(["margin-left:8px;"]),rn=c.a.memo((function(e){var t=e.isPopupOpened,r=e.isCurrentPage,n=e.popupContainer,a=e.hideDelete,o=e.onPageActionsButtonClick,l=e.isPageSettingsOpened,s=e.pageActionsHandler,d=e.collaboratorName,p=e.collaboratorAvatar,f=e.keepActionButtons,m=Jr(Object(i.useState)(!1),2),g=m[0],b=m[1],h=Jr(Object(i.useState)(!1),2),y=h[0],v=h[1],w=Jr(Object(i.useState)({left:0,top:0}),2),j=w[0],O=w[1],x=Object(u.Ub)({watchingClick:t,callback:function(){o(!0)}});return c.a.createElement(u.C,{className:"page-actions-small-panel"},l?c.a.createElement(Qr,{"aria-labelledby":"toggle-page-actions-popup",size:32,color:"white","data-active":r,outline:!0,mr:0,onClick:function(e){e.preventDefault(),e.stopPropagation(),s(r?yt.Settings:yt.GoToPage)},_css:f?1:0,_css2:u.Rb.white,_css3:u.Rb.tomato,_css4:u.Rb.tomato,_css5:u.Rb.white},c.a.createElement(u.kb,{color:r?"white":"black"})):c.a.createElement(en,{"aria-labelledby":"toggle-page-actions-popup",size:32,color:"white",hoverColor:"white",activeColor:"tomato","data-active":t,outline:!0,mr:0,onMouseEnter:function(){return b(!0)},onMouseLeave:function(){y&&v(!1),b(!1)},onMouseDown:function(){return v(!0)},onMouseUp:function(){return v(!1)},onClick:function(e){if(e.preventDefault(),e.stopPropagation(),n){var t=e.currentTarget.getBoundingClientRect(),r=n.getBoundingClientRect();O({left:t.left-r.left-t.width-127,top:t.top-r.top-(a?28:46)}),o()}},_css6:f?1:0},c.a.createElement(u.Eb,{color:y||t?"white":g?"tomato":"black"})),n&&c.a.createElement(I,{ref:x,rootElement:n,isShown:t,width:148,height:a?88:124,coords:j,placement:S.Right},c.a.createElement(Kr,{isPageSettingsOpened:l,hideDelete:a,actionCallback:s})),d&&c.a.createElement(tn,{size:"small",url:p,name:d}))}));rn.displayName="PageActionsSmallPanel";var nn=Object(o.e)(u.C).withConfig({displayName:"PageActionsStandartPanel__Actions"})(["transition:opacity 0.2s ease;& > *{margin-left:16px;&:first-child{margin-left:0;}}"]),an=Object(o.e)(u.hb).withConfig({displayName:"PageActionsStandartPanel___StyledRoundButton"})(["opacity:",";transition:opacity 0.2s ease;&:hover{background-color:",";& svg{color:",";}}&:active{background-color:",";& svg{color:",";}}"],(function(e){return e._css}),(function(e){return e._css2}),(function(e){return e._css3}),(function(e){return e._css4}),(function(e){return e._css5})),on=Object(o.e)(u.hb).withConfig({displayName:"PageActionsStandartPanel___StyledRoundButton2"})(["opacity:",";transition:opacity 0.2s ease;&:hover{background-color:",";& svg{color:",";}}&:active{background-color:",";& svg{color:",";}}"],(function(e){return e._css6}),(function(e){return e._css7}),(function(e){return e._css8}),(function(e){return e._css9}),(function(e){return e._css10})),cn=Object(o.e)(u.hb).withConfig({displayName:"PageActionsStandartPanel___StyledRoundButton3"})(["opacity:",";transition:opacity 0.2s ease;&:hover{background-color:",";& svg{color:",";}}&:active{background-color:",";& svg{color:",";}}"],(function(e){return e._css11}),(function(e){return e._css12}),(function(e){return e._css13}),(function(e){return e._css14}),(function(e){return e._css15})),ln=Object(o.e)(u.gb).withConfig({displayName:"PageActionsStandartPanel___StyledResponsiveAvatar"})(["transform:translateX(",");transition:opacity 0.2s ease,transform 0.2s ease-in-out;"],(function(e){return e._css16})),sn=c.a.memo((function(e){var t=e.isCurrentPage,r=e.isPageSettingsOpened,n=e.hideDelete,a=e.collaboratorName,o=e.collaboratorAvatar,i=e.pageActionsHandler,l=e.keepActionButtons;return(c.a.createElement(nn,{className:"page-actions-standart-panel",width:128,height:32,position:"absolute",bottom:8,left:0,right:0,m:"auto",justifyContent:"center"},c.a.createElement(an,{"aria-labelledby":"duplicat-page",size:32,color:"white",outline:!0,mr:0,unstyledHover:!0,disabled:r,onClick:function(e){e.preventDefault(),e.stopPropagation(),i(yt.Duplicate)},_css:r?0:l?1:0,_css2:u.Rb.white,_css3:u.Rb.tomato,_css4:u.Rb.tomato,_css5:u.Rb.white},c.a.createElement(u.y,{color:"black"})),c.a.createElement(on,{"aria-labelledby":"toggle-page-settings",size:32,color:"white",outline:!0,"data-active":t&&r,mr:0,onClick:function(e){e.preventDefault(),t&&e.stopPropagation(),r||Pe.d.sendEvent(Pe.b.PageSEOOpen),(!r||r&&t)&&i(yt.Settings)},_css6:l?1:0,_css7:u.Rb.white,_css8:u.Rb.tomato,_css9:u.Rb.tomato,_css10:u.Rb.white},c.a.createElement(u.kb,{color:t&&r?"white":"black"})),n||a?null:c.a.createElement(cn,{"aria-labelledby":"delete-page",size:32,color:"white",outline:!0,mr:0,disabled:r,onClick:function(e){e.preventDefault(),e.stopPropagation(),i(yt.Delete)},_css11:r?0:l?1:0,_css12:u.Rb.white,_css13:u.Rb.tomato,_css14:u.Rb.tomato,_css15:u.Rb.white},c.a.createElement(u.x,{color:"black"})),a&&c.a.createElement(ln,{className:"page-actions-avatar",size:"small",url:o,name:a,_css16:l?0:"-48px"})))}));sn.displayName="PageActionsStandartPanel";var un=c.a.memo((function(e){var t,r=e.isCurrentPage,o=e.pageId,l=e.gridSize,s=e.hidden,d=void 0!==s&&s,p=Object(i.useContext)(v),f=Object(i.useContext)(Qc),m=Object(i.useContext)(Bn),g=function(e){var t=!1;e||p.isPageActionsPopupOpenedFor!==o&&(t=o),p.dispatch({type:a.SetPageActionsPopup,payload:t})},b=function(e){switch(e){case yt.Duplicate:!function(){var e="pending-".concat(Date.now()),t=f.pages.find((function(e){return e._id===o})),r=f.pagesParams[o];if(t){var n=r.children.length&&r.collapsed;m.addPendingPage({_id:e,uri:"",screenshot:t.screenshot,title:t.title,num:r.children.length?t.num:t.num+1,parentPage:n?t._id:t.parentPage,hidden:!1,pending:!0})}f.duplicatePage(o).then((function(){})).catch((function(e){console.warn("page dublicate",e)})).finally((function(){m.removePendingPage(e)}))}();break;case yt.Delete:f.deletePage(o);break;case yt.Settings:p.isPageActionsPopupOpenedFor&&g(!0),p.isTrashOpened?(p.dispatch({type:a.ToggleTrash}),setTimeout((function(){p.isPageSettingsOpened||r||p.isPageActionsPopupOpenedFor!==o||window.RM.constructorRouter.showWorkspace({id:o}),p.dispatch({type:a.TogglePageSettings})}),300)):(p.isPageSettingsOpened||r||p.isPageActionsPopupOpenedFor!==o||window.RM.constructorRouter.showWorkspace({id:o}),p.dispatch({type:a.TogglePageSettings}));break;case yt.GoToPage:f.changeWorkspace({id:o})}},h=Object(i.useMemo)((function(){return p.isPageActionsPopupOpenedFor===o}),[p.isPageActionsPopupOpenedFor]),y=f.lockedPages[o],w=y&&y!==(null===(t=window.RM.constructorRouter.me)||void 0===t?void 0:t.get("uri"))?f.collaborators.find((function(e){return e.uri===y})):void 0;return d?null:l===n.Standard?c.a.createElement(u.m,null,c.a.createElement(sn,{isCurrentPage:r,keepActionButtons:r&&!p.addingPage,isPageSettingsOpened:p.isPageSettingsOpened,hideDelete:1===f.pages.length,collaboratorName:w&&w.name,collaboratorAvatar:w&&w.pic,pageActionsHandler:b})):c.a.createElement(u.C,{alignItems:"center",position:"absolute",top:0,bottom:0,m:"auto",left:7},c.a.createElement(rn,{isPopupOpened:h,popupContainer:f.popupContainer,hideDelete:1===f.pages.length,onPageActionsButtonClick:g,isPageSettingsOpened:p.isPageSettingsOpened,collaboratorName:w&&w.name,collaboratorAvatar:w&&w.pic,isCurrentPage:r,keepActionButtons:r&&!p.addingPage,pageActionsHandler:b}))}));function dn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return pn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}un.displayName="ActionsPanelWraper";var fn=Object(o.e)(u.C).withConfig({displayName:"PageListItem___StyledFlex"})(["transform:rotate(",") translateX(",");transition:transform 200ms ease;"],(function(e){return e._css}),(function(e){return e._css2})),mn=Object(o.e)(u.m).withConfig({displayName:"PageListItem___StyledBox"})(["border:"," solid ",";&:hover{.page-actions-standart-panel > *,.page-actions-small-panel > *{opacity:1;}.page-actions-avatar{transform:translateX(0);}}transform-origin:left;overflow:hidden;flex:0 0 auto;transform:scale(",");"],(function(e){return e._css3}),(function(e){return e._css4}),(function(e){return e._css5})),gn=Object(o.e)(u.zb).withConfig({displayName:"PageListItem___StyledText"})(["float:left;"]),bn=Object(o.e)(u.I).withConfig({displayName:"PageListItem___StyledInlineInput"})(["width:","px;height:auto;padding:0;text-overflow:ellipsis;&:focus{border:none;}"],(function(e){return e._css6})),hn=Object(o.e)(u.I).withConfig({displayName:"PageListItem___StyledInlineInput2"})(["width:","px;height:auto;padding:0;text-overflow:ellipsis;&:focus{border:none;}"],(function(e){return e._css7})),yn=c.a.memo((function(e){var t=e.page,r=e.gridSize,a=e.dragableRef,o=e.level,l=void 0===o?0:o,s=e.head,d=e.childIndex,p=e.onCollapsed,f=e.isPageCollapsed,m=void 0===f||f,g=Object(i.useContext)(Qc),b=Object(i.useContext)(Gr),h=l?16*l:l,y=Object(i.useMemo)((function(){return g.pagesParams[t._id]?g.pagesParams[t._id].parentId?g.pagesParams[g.pagesParams[t._id].parentId].viewNum:g.pagesParams[t._id].viewNum:t.num}),[t,l,g.pagesParams]),v=dn(Object(i.useState)((function(){return t.uri?t.uri:""})),2),w=v[0],j=v[1],S=dn(Object(i.useState)(null),2),O=S[0],x=S[1],E=dn(Object(i.useState)(!1),2),_=E[0],P=E[1];Object(i.useEffect)((function(){var e=t.uri?t.uri:"";_||w===e||j(e)}),[t.uri]);var C=dn(Object(i.useState)((function(){return t.title?t.title:""})),2),k=C[0],I=C[1],A=dn(Object(i.useState)(!1),2),R=A[0],T=A[1];Object(i.useEffect)((function(){R||t.title===k||I(t.title?t.title:"")}),[t.title]);var M=dn(Object(i.useState)(""),2),N=M[0],D=M[1];Object(i.useEffect)((function(){D(t._id===b.onItemId?"colors.gray":g.selectedPages.includes(t._id)?"colors.tomato":"")}),[b.onItemId,g.selectedPages]),Object(i.useEffect)((function(){!t.screenshot&&g.updatePageScreenshot(t._id)}),[t.screenshot]);var z=t.pending;return(c.a.createElement(u.m,{width:"192px",py:"2px",ml:"".concat(h,"px"),position:"relative",display:r===n.Standard?"block":"flex",className:"page-list-item","data-page-id":t._id},t._id===g.currentPageId&&c.a.createElement(vn,{gridSize:r}),s&&c.a.createElement(fn,{width:12,height:12,position:"absolute",top:r===n.Standard?143:20,left:r===n.Standard?5:97,alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:1,onClick:function(){return p&&p()},_css:m?"0deg":"-90deg",_css2:m?n.Standard?"3px":"2px":"0px"},c.a.createElement(u.Db,{color:"black"})),c.a.createElement(mn,{width:r===n.Standard?208:"96px",height:r===n.Standard?140:"64px",className:"page-list-item-picture",mb:l?1:"0px",borderRadius:r===n.Standard?"8px":"6px",position:"relative",zIndex:1,p:r===n.Standard?"4px":"2px",cursor:"pointer",onClick:function(e){e.preventDefault(),e.metaKey||e.ctrlKey?g.selectPage(t._id):e.shiftKey?g.selectPagesRange(t._id):g.selectedPages.length?g.deselectPages():b.isActive||g.changeWorkspace({id:t._id})},_css3:r===n.Standard?"4px":"2px",_css4:N?Object(ve.themeGet)(N):"transparent",_css5:l&&r===n.Standard?"0.92":"1"},c.a.createElement(u.m,{className:"sortable-item-handle",height:r===n.Standard?124:"56px",position:"relative",boxShadow:"0 1px 1px rgba(64, 64, 64, 0.32)",borderRadius:r===n.Standard?"8px":"4px",bg:"white",ref:a},z&&c.a.createElement(u.C,{position:"absolute",top:"0",right:"0",bottom:"0",left:"0",justifyContent:"center",alignItems:"center",zIndex:1},c.a.createElement(u.R,{bgColor:"transparent"})),c.a.createElement(qr,{url:t.screenshot,opacity:t.hidden?.4:1,width:r===n.Standard?192:88,height:r===n.Standard?124:56}),!z&&c.a.createElement(un,{isCurrentPage:t._id===g.currentPageId,pageId:t._id,gridSize:r,hidden:!!b.isActive}))),c.a.createElement(u.m,{opacity:r===n.Standard&&t._id===b.id&&b.isActive?0:1},c.a.createElement(u.m,{width:"100%",ml:"".concat(r===n.Standard?s?24:8:s?20:4,"px"),mt:"".concat(r===n.Standard?s?-1:0:16,"px")},c.a.createElement(gn,{textStyle:"small"},y,d?".".concat(d):"",". "),c.a.createElement(bn,{type:"text",textStyle:"small",color:"black",placeholder:"Page Title",spellCheck:!1,autoComplete:"off",autoCorrect:"off",maxLength:128,value:k,disabled:z,onChange:function(e){I(e.target.value)},onBlur:function(){T(!1);var e=g.pageSave(t._id,{title:k});!e||e instanceof Error||e.done((function(e){})).fail((function(){}))},onFocus:function(){T(!0)},_css6:r===n.Standard?s||l?156:170:s||l?62:82})),c.a.createElement(u.C,{width:"100%",ml:"".concat(r===n.Standard?s&&m?24:8:4,"px"),mt:"-2px",justifyContent:"start"},_||t.uri?c.a.createElement(u.zb,{textStyle:"small",color:"black"},"/"):null,c.a.createElement(hn,{type:"text",name:"link",textStyle:"small",color:O?"tomato":"black",placeholder:"/custom url",spellCheck:!1,autoComplete:"off",autoCorrect:"off",value:O||w,disabled:z,onKeyDown:function(e){O&&x(null),13===e.keyCode&&(e.preventDefault(),e.currentTarget.blur())},onChange:function(e){var r=/[^A-Za-z0-9_.+-]/g,n=e.currentTarget.value;r.test(n)&&(n=n.replace(r,""));var a=g.validatePageUri(t._id,n,!0);a?x(a):j(n)},onBlur:function(e){var r=e.currentTarget.value,n=g.validatePageUri(t._id,r);if(n)x(n);else if(P(!1),!O){var a=g.pageSave(t._id,{uri:r});!a||a instanceof Error||a.done((function(e){j(e.uri||"")})).fail((function(){}))}},onFocus:function(){P(!0),O&&x(null)},_css7:r===n.Standard?s||l?172:192:s||l?80:96})))))}));yn.displayName="PageListItem";var vn=function(e){var t=e.gridSize;return(c.a.createElement(u.m,{width:"6px",height:"6px",borderRadius:"round",bg:"tomato",position:"absolute",top:t===n.Standard?70:"31px",left:t===n.Standard?-7:"-11px",zIndex:1}))};function wn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||Sn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jn(e){return function(e){if(Array.isArray(e))return On(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Sn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sn(e,t){if(e){if("string"==typeof e)return On(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?On(e,t):void 0}}function On(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var xn=Object(o.e)(u.m).withConfig({displayName:"StackedPages___StyledBox"})(["user-select:none;"]),En=Object(o.e)(u.m).withConfig({displayName:"StackedPages___StyledBox2"})(["border:"," solid transparent;cursor:pointer;:hover{.page-actions-standart-panel > *{opacity:1;display:block;}.page-actions-button{opacity:1;display:block;}}transform-origin:left;overflow:hidden;flex:0 0 auto;transform:scale(",");"],(function(e){return e._css}),(function(e){return e._css2})),_n=Object(o.e)(u.m).withConfig({displayName:"StackedPages___StyledBox3"})(["box-shadow:0 1px 1px rgba(64,64,64,0.32);"]),Pn=c.a.memo((function(e){var t=e.topPageId,r=e.stackedPages,a=e.gridSize,o=e.level,l=void 0===o?0:o,s=Object(i.useContext)(Qc),d=l?16*l:l,p=s.pagesTree.reduce((function(e,t){return t.children instanceof Array?[].concat(jn(e),[t],jn(t.children)):[].concat(jn(e),[t])}),[]).filter((function(e){return r.includes(e._id)}));if(t){var f=p.findIndex((function(e){return e._id===t})),m=wn(p.splice(f,1),1)[0];p.unshift(m)}return p=p.slice(0,4).reverse(),c.a.createElement(xn,{width:"192px",height:a===n.Standard?"176px":"68px",py:"2px",ml:"".concat(d,"px"),position:"relative",display:a===n.Standard?"block":"flex"},p.map((function(e,t){return c.a.createElement(En,{key:e._id,top:a===n.Standard?4*(p.length-1-t):0,left:4*(p.length-1-t),width:a===n.Standard?208:"96px",height:a===n.Standard?140:"64px",className:"page-list-item-picture",mb:l?1:"0px",borderRadius:a===n.Standard?"8px":"4px",position:"absolute",zIndex:1,p:a===n.Standard?"4px":"2px",_css:a===n.Standard?"4px":"2px",_css2:l&&a===n.Standard?"0.92":"1"},c.a.createElement(_n,{borderRadius:"s",height:a===n.Standard?124:"56px",bg:"#FFF"},c.a.createElement(qr,{url:e.screenshot,width:a===n.Standard?192:88,height:a===n.Standard?124:56})))})),c.a.createElement(u.m,{height:32}))}));function Cn(e){return function(e){if(Array.isArray(e))return An(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||In(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||In(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function In(e,t){if(e){if("string"==typeof e)return An(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?An(e,t):void 0}}function An(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Pn.displayName="StackedPages";"undefined"!=typeof window&&(window.requestAnimationFrame||window.setImmediate);var Rn=c.a.memo((function(e){var t=e.page,r=e.gridSize,n=e.level,a=void 0===n?0:n,o=e.dropableId,l=e.childIndex,s=Object(i.useContext)(Qc),d=Object(i.useContext)(Gr),p=Object(i.useRef)(null),f=!(!t.children||!t.children.length),m=!s.pagesParams[t._id]||s.pagesParams[t._id].collapsed,g=kn(Object(i.useState)(!1),2),b=g[0],h=g[1],y=kn(Object(i.useState)(0),2),v=y[0],w=y[1],j=Object(i.useCallback)((function(){s.setPageCollapse(t._id,!m),h(!1),m?w(setTimeout((function(){h(!0)}),800)):v&&(clearTimeout(v),w(0))}),[t._id,m]),S=kn(Object(i.useState)(!1),2),O=S[0],x=S[1],E=kn(Object(i.useState)(!1),2),_=E[0],P=E[1];return Object(i.useEffect)((function(){if(d.isActive&&d.id){if(s.selectedPages.includes(d.id))return d.id===t._id?(x(!0),void P(!1)):(x(!1),void P(s.selectedPages.includes(t._id)));if(d.id===t._id&&t.children)return void x(!0)}x(!1),P(!1)}),[d.isActive]),_?null:c.a.createElement($r,{draggableId:t._id,dropableId:o},(function(e){var n=e.ref,o=e.mouseDownRef;return(c.a.createElement(u.m,{position:"relative",ref:n},O?c.a.createElement(Pn,{topPageId:t._id,stackedPages:s.selectedPages.includes(t._id)?s.selectedPages:[t._id].concat(Cn(t.children.map((function(e){return e._id})))),gridSize:r,level:d.id===t._id?d.parentId?1:0:a}):c.a.createElement(c.a.Fragment,null,c.a.createElement(yn,{page:t,gridSize:r,dragableRef:o,level:d.id===t._id?d.parentId?1:0:a,head:f,onCollapsed:j,isPageCollapsed:m,childIndex:l}),m&&!b&&t.children&&f?c.a.createElement(Yr,{parentId:t._id,dropableId:t._id},(function(e){var n=e.dropElementRef,o=e.dropableId;return(c.a.createElement(u.m,{className:"page-children-container",ref:p,"data-parent-id":t._id,style:{height:m?"auto":"0px",overflow:m?"visible":"hidden",transition:"height 200ms ease"}},c.a.createElement(u.m,{ref:n},t.children.map((function(e,t){return c.a.createElement(Rn,{key:e._id,page:e,gridSize:r,level:a+1,dropableId:o,childIndex:t+1})})))))})):null)))}))}));function Tn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Mn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Tn(Object(r),!0).forEach((function(t){Nn(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Nn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dn(e){return function(e){if(Array.isArray(e))return Fn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Un(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||Un(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Un(e,t){if(e){if("string"==typeof e)return Fn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Fn(e,t):void 0}}function Fn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Rn.displayName="Branch";var Bn=c.a.createContext({removePendingPage:function(){},addPendingPage:function(){}}),Ln=Object(o.e)(u.C).withConfig({displayName:"PagesList___StyledFlex"})(["user-select:none;"]),Gn=function(){var e=Object(i.useContext)(v),t=Object(i.useContext)(Qc),r=Object(i.useContext)(Gr),a=zn(Object(i.useState)(0),2),o=a[0],l=a[1],s=zn(Object(i.useState)([]),2),d=s[0],p=s[1],f=Object(i.useCallback)((function(e){p([].concat(Dn(d),[e]))}),[d]),m=Object(i.useCallback)((function(e){p(d.filter((function(t){return t._id!==e})))}),[d]);Object(i.useEffect)((function(){if(r.isActive&&r.id&&t.selectedPages.includes(r.id)){var a=t.pagesTree.reduce((function(e,t){return t.children instanceof Array?[].concat(Dn(e),[t],Dn(t.children)):[].concat(Dn(e),[t])}),[]).filter((function(e){return t.selectedPages.includes(e._id)})).findIndex((function(e){return e._id===r.id}));l(Math.max(0,a*(e.gridSize===n.Standard?176:68)))}else l(0)}),[r.isActive]),Object(i.useEffect)((function(){e.isSettingsOpened&&t.scrollToPage(t.currentPageId)}),[t.currentPageId,e.isSettingsOpened]);var g=Object(i.useCallback)((function(e){return e.sort((function(e,t){return(e.pending?e.num-1:e.num)-(t.pending?t.num-1:t.num)}))}),[]),b=d.length?g([].concat(Dn(t.pagesTree.map((function(e){var t=d.filter((function(t){return t.parentPage===e._id}));return t.length?Mn(Mn({},e),{},{children:g([].concat(Dn(e.children?e.children:[]),Dn(t)))}):e}))),Dn(d.filter((function(e){return!e.parentPage}))))):t.pagesTree;return c.a.createElement(Bn.Provider,{value:{addPendingPage:f,removePendingPage:m}},c.a.createElement(Ln,{id:"page-list-container",flexDirection:"column",justifyContent:"left",flexWrap:"wrap",pl:e.gridSize===n.Standard?"8px":"12px",pr:3,py:"6px"},r.isActive?c.a.createElement(u.m,{height:o}):null,c.a.createElement(Yr,{dropableId:"0"},(function(t){var r=t.dropElementRef,n=t.dropableId;return(c.a.createElement(u.m,{ref:r},b.map((function(t){return c.a.createElement(Rn,{key:t._id,page:t,gridSize:e.gridSize,dropableId:n})}))))}))))};function Hn(e){return(Hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wn(e){return function(e){if(Array.isArray(e))return $n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Yn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||Yn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yn(e,t){if(e){if("string"==typeof e)return $n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$n(e,t):void 0}}function $n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Xn,qn=Object(o.e)(u.m).withConfig({displayName:"SettingsBody___StyledBox"})(["overflow:hidden;"]),Kn=function(){var e=Object(i.useContext)(v),t=Object(i.useContext)(Qc),r=Object(i.useRef)(!0),o=Object(i.useRef)(null),l=Object(i.useRef)(!1),s=Object(i.useRef)(null),d=Object(i.useRef)(!1),p=Object(i.useRef)(null),f=Object(i.useRef)(null);Object(i.useEffect)((function(){f.current&&(e.isPageActionsPopupOpenedFor?f.current.style.overflowY="hidden":f.current.style.overflowY="scroll")}),[e.isPageActionsPopupOpenedFor]);var m=function(e){f.current=e;var t=e.scrollHeight,r=e.clientHeight,n=e.scrollTop,a=!!n,i=r<t&&r+n<t;i!==d.current&&(d.current=i,s.current&&(s.current.style.display=i?"block":"none")),a!==l.current&&(l.current=a,o.current&&(o.current.style.display=a?"block":"none"))},g=Object(i.useCallback)((function(e){if(r.current){var t=e.target;t&&m(t)}}),[r]),b=function(e){m(e)};Object(i.useEffect)((function(){f.current&&m(f.current)}),[e.gridSize,t.pagesParams]);var h=Vn(Object(i.useState)((function(){return t.project.title||""})),2),y=h[0],w=h[1],j=Vn(Object(i.useState)(!1),2),S=j[0],O=j[1];Object(i.useEffect)((function(){S||w(t.project.title||"")}),[t.project.title]);var x=function(){O(!1),t.projectSave({title:y})},_=function(){e.dispatch({type:a.ToggleGridSize})},P=K(t.project);return c.a.createElement(c.a.Fragment,null,c.a.createElement(Vr,{unionOn:!0,idList:E(t.pagesTree),isDragOff:e.isPageSettingsOpened,onAfterDragEnd:function(){p.current&&p.current.style.removeProperty("height");var e=document.getElementsByTagName("body")[0],t=e.className;e.className=t.split(" ").filter((function(e){return e&&"user-select-none"!==e})).join(" "),r.current=!0},onBeforeDragStart:function(e){if(t.selectedPages.includes(e))return Object(er.without)(t.selectedPages,e);var r=t.pagesTree.find((function(t){return t._id===e}));if(r&&r.children&&(!t.pagesParams[r._id]||t.pagesParams[r._id].collapsed))return r.children.map((function(e){return e._id}));return[]},onDragStart:function(){document.getElementsByTagName("body")[0].className+=" user-select-none",p.current&&(p.current.style.height=p.current.clientHeight+"px"),r.current=!1},onDragEnd:function(e,r,n,a){var o=E(t.pagesTree),i=t.pagesTree.reduce((function(e,t){return t.children?[].concat(Wn(e),[t],Wn(t.children)):[].concat(Wn(e),[t])}),[]).find((function(t){return t._id===e})),c=function e(t,r){for(var n=[],a=0;a<t.length;a++)if(r.includes(t[a].id)&&n.push(t[a]),t[a].items){var o=e(t[a].items,r);n=[].concat(Wn(n),Wn(o))}for(var i=function(e){var n=Object(er.findIndex)(t,(function(t){return t.id===r[e]}));-1!==n&&t.splice(n,1)},c=0;c<r.length;c++)i(c);return n}(o,t.selectedPages.includes(e)?a.length?[].concat(Wn(a),[e]):[e]:r&&i&&i.children?[e].concat(Wn(i.children.map((function(e){return e._id})))):[e]);if(c.length){c.forEach((function(e){return e.parentId=void 0})),function e(t,r,n,a){if(a)for(var o=function(o){if(t[o].id===a)return t[o].items||(t[o].items=[]),r.forEach((function(e){return e.parentId=t[o].id})),e(t[o].items,r,n),{v:void 0};t[o].items&&e(t[o].items,r,n,a)},i=0;i<t.length;i++){var c=o(i);if("object"===Hn(c))return c.v}else t.splice.apply(t,[n,0].concat(Wn(r)))}(o,c,n,r);var l=function e(t){return t.reduce((function(t,r){return t.push(r),r.items?t.concat(e(r.items)):t}),[])}(o),s=1,u=l.map((function(e){return{id:e.id,num:s++,parentPage:e.parentId||null}}));t.saveOrder(u),setTimeout((function(){t.updateUrl()}),100)}}},(function(){return c.a.createElement(u.m,{id:"project-settings-body",width:"100%",height:"calc(100% - ".concat(t.isNewSettingsMenu?"89px":"164px",")"),position:"relative"},c.a.createElement(u.ib,{onScroll:g,onFirstRender:b},(function(r){var a=r.ref;return(c.a.createElement(qn,{ref:Object(u.Sb)(a,p),pt:t.isNewSettingsMenu?16:0,px:2},t.isNewSettingsMenu&&c.a.createElement(u.C,{justifyContent:"space-between",p:"0 16px",position:"relative",zIndex:1},c.a.createElement(u.zb,{textStyle:"small",color:P===N.UnpublishedChanges?"tomato":"darkGray"},X(t.project)),c.a.createElement(u.rb,{textStyle:"small",color:"darkGray",href:"".concat($.a.readymag_host,"/learn")},"Help")),!t.isNewSettingsMenu&&c.a.createElement(u.m,{ref:o,width:224,height:2,position:"fixed",top:81,borderRadius:"xs",bg:"gray",display:"none"}),c.a.createElement(u.m,{px:3,mt:t.isNewSettingsMenu?"8px":0},c.a.createElement(u.J,{name:"project-title",placeholder:"Project Title",translate:"no",spellCheck:!1,maxLength:128,rows:1,autoSize:!0,textStyle:"subheading",color:"black",value:y,onChange:function(e){w(e.currentTarget.value)},onFocus:function(){O(!0)},onBlur:x}),c.a.createElement(u.m,{mt:"5px",position:"relative"},!t.isNewSettingsMenu&&c.a.createElement(u.zb,{color:"darkGray",textStyle:"small",userSelect:"none"},X(t.project)),c.a.createElement(u.C,{width:28,mt:"12px",onClick:_,cursor:"pointer"},c.a.createElement(u.m,null,c.a.createElement(u.ob,{color:e.gridSize===n.Standard?"darkGray":"gray"})),c.a.createElement(u.m,{ml:"1"},c.a.createElement(u.nb,{color:e.gridSize===n.Small?"darkGray":"gray"}))))),c.a.createElement(Gn,null),c.a.createElement(u.m,{ref:s,width:224,height:2,position:"fixed",bottom:87,borderRadius:"xs",bg:"gray",display:"none"})))})))})),c.a.createElement(Dr,null))};function Jn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Zn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}!function(e){e[e.Confirmed=0]="Confirmed",e[e.Canceled=1]="Canceled"}(Xn||(Xn={}));var Qn=Object(o.e)(u.m).withConfig({displayName:"Trash___StyledBox"})(["z-index:",";overflow-x:hidden;overflow-y:auto;transform:translateX( "," );transition:transform "," ease;"],(function(e){return e._css}),(function(e){return e._css2}),(function(e){return e._css3})),ea=c.a.memo((function(){var e=Object(i.useContext)(v),t=Object(i.useContext)(Qc),r=Jn(Object(i.useState)(!1),2),n=r[0],a=r[1];Object(i.useEffect)((function(){e.isTrashOpened?(document.body.classList.add("trash-is-opened"),t.updateTrash()):(document.body.classList.remove("trash-is-opened"),n&&a(!1))}),[e.isTrashOpened]);var o=function(e){return t.restorePage(e)},l=function(e){return t.deletePagesFromTrash([e])};return c.a.createElement(Qn,{id:"constructor-pages-bin",height:"100%",width:240,pt:12,position:"fixed",top:0,right:0,bottom:0,bg:"black",_css:St,_css2:e.isSettingsOpened?e.isTrashOpened?"0px":"240px":e.isTrashOpened?"480px":"240px",_css3:xt},c.a.createElement(u.m,{height:"calc(100% - 89px)",overflow:"auto"},c.a.createElement(u.ib,null,(function(e){var r=e.ref;return(c.a.createElement(u.m,{ref:r,px:22},c.a.createElement(u.m,{mb:28},c.a.createElement(u.zb,{color:"white",textStyle:"subheading",textAlign:"left"},"Deleted pages")),t.trashPages.map((function(e){return c.a.createElement(na,{key:e._id,page:e,isOwner:t.isOwner,onRestorePage:o,onDeletePage:l})}))))}))),t.trashPages.length&&c.a.createElement(ca,{onEmptyTrash:function(){t.isOwner&&t.trashPages.length&&a(!0)},isOwner:t.isOwner,isEmptyTrashDialogOpened:n,onDialogClick:function(e){e===Xn.Confirmed&&t.isOwner&&t.trashPages.length&&t.emptyTrash(),a(!1)}}))}));ea.displayName="Trash";var ta=Object(o.e)(u.m).withConfig({displayName:"Trash___StyledBox2"})([":hover{.trash-page-actions{opacity:1;}}"]),ra=Object(o.e)(u.C).withConfig({displayName:"Trash___StyledFlex"})(["opacity:0;transition:opacity 200ms ease;"]),na=c.a.memo((function(e){var t=e.page,r=e.isOwner,n=e.onRestorePage,a=e.onDeletePage,o=Jn(Object(i.useState)(!1),2),l=o[0],s=o[1];return c.a.createElement(u.m,{mb:12,ml:"2px","data-pageid":t._id},c.a.createElement(ta,{width:192,height:124,bg:"darkGray",borderRadius:"s",position:"relative"},c.a.createElement(qr,{url:t.screenshot}),c.a.createElement(ra,{className:"trash-page-actions",width:176,height:32,justifyContent:r?"space-between":"center",position:"absolute",left:8,bottom:8},l?c.a.createElement(oe,{"aria-labelledby":"confirm-bin-action",danger:!0,onClick:function(e){e.preventDefault(),r&&a(t._id)}},"Yes"):c.a.createElement(oe,{"aria-labelledby":"restore-page",onClick:function(e){e.preventDefault(),n(t._id)}},"Restore"),l?c.a.createElement(oe,{"aria-labelledby":"deny-bin-action",onClick:function(e){e.preventDefault(),s(!1)}},"Cancel"):c.a.createElement(c.a.Fragment,null,r&&c.a.createElement(oe,{"aria-labelledby":"delete-page-from-bin",dangerOnHover:!0,onClick:function(e){e.preventDefault(),s(!0)}},"Delete")))),c.a.createElement(u.m,{mt:"7px"},c.a.createElement(u.zb,{textStyle:"small",color:"white"},t.title?t.title:"Page Title")))}));na.displayName="TrashPage";var aa=Object(o.e)(u.C).withConfig({displayName:"Trash___StyledFlex2"})(["cursor:pointer;border:1px solid rgba(128,128,128,0.16);&:hover{opacity:0.96;}"]),oa=Object(o.e)(u.C).withConfig({displayName:"Trash___StyledFlex3"})(["cursor:pointer;border:1px solid rgba(128,128,128,0.16);&:hover{background-color:",";opacity:0.96;& > span{color:",";}}"],(function(e){return e._css4}),(function(e){return e._css5})),ia=Object(o.e)(u.n).withConfig({displayName:"Trash___StyledButton"})(["cursor:pointer;"]),ca=c.a.memo((function(e){var t=e.onEmptyTrash,r=e.isOwner,n=e.isEmptyTrashDialogOpened,a=e.onDialogClick;return(c.a.createElement(u.C,{height:89,px:24,justifyContent:"center",alignItems:"center",position:"relative"},c.a.createElement(u.m,{width:224,height:2,position:"absolute",top:0,borderRadius:"xs",bg:"gray"}),n?c.a.createElement(u.C,{width:"100%",justifyContent:"space-between"},c.a.createElement(aa,{"aria-labelledby":"empty-bin-cancel",width:80,height:32,alignItems:"center",justifyContent:"center",bg:"white",borderRadius:"xl",onClick:function(){return a(Xn.Canceled)}},c.a.createElement(u.zb,{textStyle:"small",color:"black"},"Cancel")),c.a.createElement(oa,{"aria-labelledby":"empty-bin-confirm",width:80,height:32,alignItems:"center",justifyContent:"center",bg:"white",borderRadius:"xl",onClick:function(){return a(Xn.Confirmed)},_css4:u.Rb.tomato,_css5:u.Rb.white},c.a.createElement(u.zb,{textStyle:"small",color:"black"},"Empty"))):c.a.createElement(c.a.Fragment,null,r&&c.a.createElement(ia,{"aria-labelledby":"empty-bin",textStyle:"small",color:"white",onClick:t},"Empty bin"))))}));ca.displayName="TrashFooter";var la=ea,sa=Object(o.e)(u.C).withConfig({displayName:"CollapseButton___StyledFlex"})(["user-select:none;transition:color 200ms,border 200ms;"]),ua=function(e){var t=e.children;return(c.a.createElement(sa,{width:"100%",height:"100%",justifyContent:"left",alignItems:"center",py:11,cursor:"pointer"},t))},da=Object(o.e)(u.n).withConfig({displayName:"CustomizeButton"})(["width:100%;height:40px;border:solid 2px ",";border-radius:32px;"],Object(ve.themeGet)("colors.darkGray")),pa=r("5ta/");function fa(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ma(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fa(Object(r),!0).forEach((function(t){ga(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fa(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ga(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ba(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ha(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ha(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ha(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ya=function(e){var t=e.isActive,r=ba(Object(i.useState)(!1),2),n=r[0],a=r[1];return c.a.createElement(u.m,{onMouseEnter:function(){return a(!0)},onMouseLeave:function(){return a(!1)}},c.a.createElement(ua,null,c.a.createElement(u.zb,{textStyle:"subheading",textAlign:"left",color:t||n?"white":"darkGray"},"Page SEO")))},va=o.e.label.withConfig({displayName:"SeoSettings___StyledLabel"})(["color:",";",";"],(function(e){return e._css}),(function(e){return e._css2})),wa=Object(o.e)(u.J).withConfig({displayName:"SeoSettings___StyledInlineTextArea"})(["&::placeholder{color:",";}&:disabled{color:",";}"],(function(e){return e._css3}),(function(e){return e._css4})),ja=o.e.label.withConfig({displayName:"SeoSettings___StyledLabel2"})(["color:",";",";"],(function(e){return e._css5}),(function(e){return e._css6})),Sa=Object(o.e)(u.J).withConfig({displayName:"SeoSettings___StyledInlineTextArea2"})(["&::placeholder{color:",";}&:disabled{color:",";}"],(function(e){return e._css7}),(function(e){return e._css8})),Oa=o.e.label.withConfig({displayName:"SeoSettings___StyledLabel3"})(["color:",";",";"],(function(e){return e._css9}),(function(e){return e._css10})),xa=Object(o.e)(u.J).withConfig({displayName:"SeoSettings___StyledInlineTextArea3"})(["&::placeholder{color:",";}&:disabled{color:",";}"],(function(e){return e._css11}),(function(e){return e._css12})),Ea=Object(o.e)(u.m).withConfig({displayName:"SeoSettings___StyledBox"})(["color:",";white-space:nowrap;text-overflow:ellipsis;overflow:hidden;"],(function(e){return e._css13})),_a=o.e.label.withConfig({displayName:"SeoSettings___StyledLabel4"})(["",";"],(function(e){return e._css14})),Pa=Object(o.e)(u.m).withConfig({displayName:"SeoSettings___StyledBox2"})(["max-width:50%;color:",";white-space:nowrap;text-overflow:ellipsis;overflow:hidden;"],(function(e){return e._css15})),Ca=Object(o.e)(u.m).withConfig({displayName:"SeoSettings___StyledBox3"})(["max-width:50%;"]),ka=Object(o.e)(u.I).withConfig({displayName:"SeoSettings___StyledInlineInput"})(["padding-left:",";&::placeholder{color:",";}&:disabled{color:",";}"],(function(e){return e._css16}),(function(e){return e._css17}),(function(e){return e._css18})),Ia=Object(i.forwardRef)((function(e,t){var r=e.currentPage,n=Object(i.useContext)(Qc),a=ba(Object(i.useState)(null),2),o=a[0],l=a[1],s=Object(i.useMemo)((function(){return!!window.RM.constructorRouter.me&&!!(window.RM.constructorRouter.me.get("permissions")||{}).custom_seo}),[window.RM.constructorRouter.me]),d=Object(i.useMemo)((function(){return"/".concat(n.pagesParams[r._id].viewNum)}),[r,n.pagesParams]),p=function(){var e={title:"",description:"",keywords:""};return r.seo&&(e=ma(ma({},e),r.seo)),e},f=function(){var e,t=(e=n.project.domain||n.project.user&&n.project.user.domain,pa.getDefaultSEO(r,n.project,{customDomain:Boolean(e)}));return{title:n.project.title||t.title||"",description:n.project.description||"",keywords:""}},m=ba(Object(i.useState)((function(){return p()})),2),g=m[0],b=m[1],h=ba(Object(i.useState)((function(){return f()})),2),y=h[0],v=(h[1],ba(Object(i.useState)((function(){return r&&r.uri?r.uri:""})),2)),w=v[0],j=v[1],S=ba(Object(i.useState)(null),2),O=S[0],x=S[1],E=ba(Object(i.useState)(!1),2),_=E[0],P=E[1];Object(i.useEffect)((function(){b(p()),j(r.uri||""),O&&x(null)}),[r]);var C=function(e){var t=e.target,r=t.getAttribute("name");r&&void 0!==g[r]&&b((function(e){return ma(ma({},e),ga({},r,t.value))}))},k=function(e){var t=n.pageSave(r._id,{seo:g});!t||t instanceof Error||t.done((function(e){})).fail((function(){}))};return c.a.createElement(u.m,{ref:t,mx:24},c.a.createElement(u.m,{mt:"12px"},c.a.createElement(va,{htmlFor:"title",_css:s?u.Rb.white:u.Rb.darkGray,_css2:Object(ve.themeGet)("textStyles.small")},"Title"),c.a.createElement(wa,{name:"title",id:"title",color:"white",placeholder:y.title,translate:"no",autoComplete:"off",autoCorrect:"off",maxLength:128,rows:1,autoSize:!0,mt:"4px",disabled:!s,value:g.title,onChange:C,onBlur:k,_css3:u.Rb.darkGray,_css4:u.Rb.darkGray})),c.a.createElement(u.m,{mt:"22px"},c.a.createElement(ja,{htmlFor:"description",_css5:s?u.Rb.white:u.Rb.darkGray,_css6:Object(ve.themeGet)("textStyles.small")},"Description"),c.a.createElement(Sa,{name:"description",id:"description",color:"white",placeholder:y.description,translate:"no",autoComplete:"off",autoCorrect:"off",maxLength:2048,rows:1,autoSize:!0,mt:"4px",disabled:!s,value:g.description,onChange:C,onBlur:k,_css7:u.Rb.darkGray,_css8:u.Rb.darkGray})),c.a.createElement(u.m,{mt:"22px"},c.a.createElement(Oa,{htmlFor:"keywords",_css9:s?u.Rb.white:u.Rb.darkGray,_css10:Object(ve.themeGet)("textStyles.small")},"Keywords"),c.a.createElement(xa,{name:"keywords",id:"keywords",color:"white",placeholder:y.keywords,translate:"no",spellCheck:!1,autoComplete:"off",autoCorrect:"off",rows:1,autoSize:!0,mt:"4px",disabled:!s,value:g.keywords,onChange:C,onBlur:k,_css11:u.Rb.darkGray,_css12:u.Rb.darkGray})),c.a.createElement(u.m,{mt:"22px"},c.a.createElement(Ea,{width:"100%",_css13:s?u.Rb.white:u.Rb.darkGray},c.a.createElement(_a,{htmlFor:"link",title:"".concat(J(n.project),"/"),_css14:Object(ve.themeGet)("textStyles.small")},"".concat(J(n.project),"/"))),c.a.createElement(u.C,{flexWrap:"nowrap"},c.a.createElement(Pa,{_css15:s?u.Rb.white:u.Rb.darkGray},c.a.createElement(u.zb,{fontSize:"regular"},n.project.uri,r.parentPage&&n.pagesParams[r.parentPage]?"/".concat(n.pagesParams[r.parentPage].uri):null)),c.a.createElement(Ca,{position:"relative"},_||w?c.a.createElement(u.m,{position:"absolute",left:0},c.a.createElement(u.zb,{color:"white",fontSize:"regular"},"/")):null,c.a.createElement(ka,{name:"link",id:"link",type:"text",color:O?"tomato":"white",fontSize:"regular",spellCheck:!1,autoComplete:"off",autoCorrect:"off",disabled:!s,placeholder:d,value:O||w,onKeyDown:function(e){x(null),13===e.keyCode&&(e.preventDefault(),e.currentTarget.blur())},onChange:function(e){var t=/[^A-Za-z0-9_.+-]/g,a=e.currentTarget.value;t.test(a)&&(a=a.replace(t,""));var o=n.validatePageUri(r._id,a,!0);o?x(o):j(a)},onFocus:function(){P(!0),O&&x(null)},onBlur:function(e){var t=e.currentTarget.value,a=n.validatePageUri(r._id,t);if(a)x(a);else if(P(!1),!O){var o=n.pageSave(r._id,{uri:t});!o||o instanceof Error||o.done((function(e){j(e.uri||"")})).fail((function(){}))}},_css16:_||w?"6px":"0",_css17:u.Rb.darkGray,_css18:u.Rb.darkGray})))),c.a.createElement(da,{textStyle:"small",color:"white",mt:24,display:s?"none":"block",onClick:function(e){e.preventDefault(),function(){o&&o.remove();var e=new fr.default({$parent:document.querySelector("body > .popups"),router:window.RM.constructorRouter,opts:{type:"type-custom-seo",is_contributor:!window.RM.constructorRouter.isOwner,owner_email:n.project.user?n.project.user.email:""},alert_source:"custom seo"});e.render(),l(e)}()}},"Customize"))}));Ia.displayName="SeoSettings";var Aa,Ra=c.a.memo(Ia);function Ta(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ma(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ta(Object(r),!0).forEach((function(t){Na(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ta(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Na(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Da(e,t,r,n,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,a)}function za(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Da(o,n,a,i,c,"next",e)}function c(e){Da(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Ua(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Fa(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fa(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fa(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}!function(e){e.Default="default",e.Custom="custom",e.Inherited="inherited"}(Aa||(Aa={}));var Ba=function(e){var t=e.isActive,r=e.onClick,n=Ua(Object(i.useState)(!1),2),a=n[0],o=n[1];return c.a.createElement(u.m,{width:"100%",height:50,position:"relative",onMouseEnter:function(){return o(!0)},onMouseLeave:function(){return o(!1)},onClick:r},c.a.createElement(u.m,{width:224,height:2,position:"absolute",top:1,left:-16,borderRadius:"xs",bg:"darkGray"}),c.a.createElement(ua,null,c.a.createElement(u.zb,{textStyle:"subheading",textAlign:"left",color:t||a?"white":"darkGray"},"Social sharing")),!t&&c.a.createElement(u.m,{width:224,height:2,position:"absolute",bottom:1,left:-16,borderRadius:"xs",bg:"darkGray"}))},La=Object(o.e)(u.m).withConfig({displayName:"SocialSettings___StyledBox"})(["&:hover{& svg{color:",";}}"],(function(e){return e._css})),Ga=Object(o.e)(u.m).withConfig({displayName:"SocialSettings___StyledBox2"})(["opacity:",";"],(function(e){return e._css2})),Ha=Object(o.e)(u.C).withConfig({displayName:"SocialSettings___StyledFlex"})(["box-shadow:0 0 0 1px rgba(128,128,128,0.16);animation:"," 2s infinite linear;@keyframes loadingindicatoranimation{from{transform:rotateZ(0deg);}to{transform:rotateZ(360deg);}}"],(function(e){return e._css3})),Wa=Object(o.e)(u.J).withConfig({displayName:"SocialSettings___StyledInlineTextArea"})(["&::placeholder{color:",";}&:disabled{color:",";}"],(function(e){return e._css4}),(function(e){return e._css5})),Va=Object(o.e)(u.J).withConfig({displayName:"SocialSettings___StyledInlineTextArea2"})(["&::placeholder{color:",";}&:disabled{color:",";}"],(function(e){return e._css6}),(function(e){return e._css7})),Ya=o.e.label.withConfig({displayName:"SocialSettings___StyledLabel"})(["color:",";",";"],(function(e){return e._css8}),(function(e){return e._css9})),$a=Object(o.e)(u.J).withConfig({displayName:"SocialSettings___StyledInlineTextArea3"})(["&::placeholder{color:",";}&:disabled{color:",";}"],(function(e){return e._css10}),(function(e){return e._css11})),Xa=o.e.label.withConfig({displayName:"SocialSettings___StyledLabel2"})(["color:",";",";"],(function(e){return e._css12}),(function(e){return e._css13})),qa=Object(i.forwardRef)((function(e,t){var r=e.currentPage,n=Object(i.useContext)(Qc),a=Ua(Object(i.useState)(null),2),o=a[0],l=a[1],s=Object(i.useMemo)((function(){return!!window.RM.constructorRouter.me&&!!(window.RM.constructorRouter.me.get("permissions")||{}).custom_sharing}),[window.RM.constructorRouter.me]),d=Ua(Object(i.useState)((function(){return n.project.master_share_pid||null})),2),p=d[0],f=d[1],m=function(){var e=r;return p?p===e._id?Aa.Custom:Aa.Inherited:e.custom_shares?Aa.Custom:Aa.Default},g=Ua(Object(i.useState)(m()),2),b=g[0],h=g[1],y=Object(i.useMemo)((function(){return!s||b===Aa.Inherited}),[b,s]),v=function(e){if(e.custom_shares){var t=e.custom_shares;if(!t.image){var r=Ie.default.screenshotSize(512),n=Ie.default.addFilenameComponent(e.screenshot,r);t.image=n}return t}return{description:"",title:"",tweet:"",image:""}},w=function(){var e=n.project.domain||n.project.user&&n.project.user.domain;return pa.getDefaultShare(r,n.project,{customDomain:Boolean(e)})},j=function(){var e=r,t=w();if(p){if(p===e._id)return v(e);var a=n.pages.find((function(e){return e._id===p}));if(a)return v(a)}else if(e.custom_shares)return v(e);return t},S=Ua(Object(i.useState)((function(){return j()})),2),O=S[0],x=S[1];Object(i.useEffect)((function(){return x(j()),h(m()),function(){x(null),h(Aa.Default)}}),[r]);var E=function(e){return n.pageSave(r._id,{custom_shares:e||O})},_=Ua(Object(i.useState)(!1),2),P=_[0],C=_[1],k=Ua(Object(i.useState)(!1),2),I=k[0],A=k[1],R=Object(i.useMemo)((function(){if(O&&O.image){var e=pa.removeFilenameComponent(O.image);return r.screenshot!==e}return!1}),[O,r.screenshot]),T=Ua(Object(i.useState)(!1),2),M=T[0],N=T[1],D=Ua(Object(i.useState)(!1),2),z=D[0],U=D[1],F=Ua(Object(i.useState)(!1),2),B=F[0],L=F[1],G=Ua(Object(i.useState)(!1),2),H=G[0],W=G[1],V=function(){var e=za(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(A(!1),!(t.size>$.a.UPLOAD_IMAGE_SIZE_LIMIT)){e.next=4;break}return window.alert($.a.MSG_UPLOAD_IMAGE_SIZE_ERROR),e.abrupt("return");case 4:if(!P){e.next=6;break}return e.abrupt("return");case 6:return C(!0),e.prev=7,e.next=10,Object(ke.M)("share-upload",t);case 10:(r=e.sent)&&r.picture&&r.picture.url&&O&&(n=Ma(Ma({},O),{},{image:r.picture.url}),!(a=E(n))||a instanceof Error||a.then((function(){x((function(e){return Ma(Ma({},e),n)})),b===Aa.Default&&h(Aa.Custom)})).always((function(){C(!1)}))),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),C(!1);case 17:case"end":return e.stop()}}),e,null,[[7,14]])})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=za(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),r=w(),n=Ma(Ma({},O),{},{image:r.image}),!(a=E(n))||a instanceof Error||a.done((function(){return x((function(e){return Ma(Ma({},e),n)}))}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=function(e){var t=e.target,r=t.getAttribute("name");r&&O&&void 0!==O[r]&&x((function(e){return Ma(Ma({},e),Na({},r,t.value))}))},q=function(e){if(O){var t=E();!t||t instanceof Error||t.done((function(){b===Aa.Default&&h(Aa.Custom)})).fail((function(){}))}},K=Object(i.useMemo)((function(){return Boolean(r&&p&&r._id===p)}),[r,p]),J=function(){n.pageUnset(r._id,"custom_shares");var e=n.pageSave(r._id,{});!e||e instanceof Error||e.done((function(){x(w()),h(Aa.Default)})).fail((function(){}))};return c.a.createElement(u.m,{ref:t,mx:24,pb:24},c.a.createElement(u.m,{mt:"10px",position:"relative"},c.a.createElement(u.zb,{color:"white",textStyle:"small"},"OpenGraph"),c.a.createElement(La,{position:"absolute",right:0,top:5,_css:u.Rb.tomato},c.a.createElement("a",{href:"https://help.readymag.com/hc/en-us/articles/360020844431-Sharing",target:"_blank",rel:"noopener noreferrer"},c.a.createElement(u.eb,{color:"darkGray"})))),c.a.createElement(Ga,{width:192,height:104,mt:"12px",position:"relative",onDragEnter:function(){I||A(!0)},onDragLeave:function(){I&&A(!1)},_css2:I?.8:1},c.a.createElement(u.B,{accept:"image/*",dropFile:!0,readFileData:!1,onChange:V,disabled:y},c.a.createElement(c.a.Fragment,null,c.a.createElement(u.m,{width:192,height:104,bg:"darkGrey",borderRadius:"s",position:"relative",cursor:s&&!y?"pointer":"default",boxShadow:"0 1px 1px rgba(64, 64, 64, 0.32)"},c.a.createElement(u.v,{width:"100%",height:"100%",borderRadius:"s",backgroundImage:O&&O.image?"url(".concat(O.image,")"):"none",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"})),!I&&c.a.createElement(u.C,{width:96,height:32,position:"absolute",left:0,right:0,bottom:8,m:"auto",justifyContent:"space-around",cursor:"default"},!y&&c.a.createElement(c.a.Fragment,null,c.a.createElement(Ha,{width:32,height:32,justifyContent:"center",alignItems:"center",onMouseEnter:function(){return N(!0)},onMouseLeave:function(){return N(!1)},onMouseDown:function(){return U(!0)},onMouseUp:function(){return U(!1)},bg:z?"tomato":"white",borderRadius:"round",cursor:P?"default":"pointer",_css3:P?"loadingindicatoranimation":"none"},c.a.createElement(u.fb,{color:z?"white":M&&!P?"tomato":"black"})),R&&c.a.createElement(u.hb,{size:32,color:"white",hoverColor:"white",activeColor:"tomato",outline:!0,onMouseEnter:function(){return L(!0)},onMouseLeave:function(){return L(!1)},onMouseDown:function(){return W(!0)},onMouseUp:function(){return W(!1)},onClick:Y,disabled:P},c.a.createElement(u.x,{color:H?"white":B?"tomato":"black"}))))))),c.a.createElement(u.m,null,c.a.createElement(Wa,{name:"title",placeholder:"Title",translate:"no",autoComplete:"off",autoCorrect:"off",maxLength:128,rows:1,autoSize:!0,color:"white",textStyle:"regular",disabled:y,value:O&&O.title?O.title:void 0,onChange:X,onBlur:q,_css4:u.Rb.darkGray,_css5:u.Rb.darkGray})),c.a.createElement(u.m,null,c.a.createElement(Va,{name:"description",placeholder:"Description",translate:"no",autoComplete:"off",autoCorrect:"off",maxLength:2048,autoSize:!0,rows:1,color:"white",textStyle:"small",disabled:y,value:O&&O.description?O.description:void 0,onChange:X,onBlur:q,_css6:u.Rb.darkGray,_css7:u.Rb.darkGray})),c.a.createElement(u.m,{mt:"22px"},c.a.createElement(Ya,{htmlFor:"share-tweet",_css8:Object(ve.themeGet)("colors.white"),_css9:Object(ve.themeGet)("textStyles.small")},"Tweet message"),c.a.createElement($a,{name:"tweet",translate:"no",autoComplete:"off",autoCorrect:"off",maxLength:116,rows:1,autoSize:!0,mt:"4px",color:"white",textStyle:"regular",disabled:y,value:O&&O.tweet?O.tweet:void 0,onChange:X,onBlur:q,_css10:u.Rb.darkGray,_css11:u.Rb.darkGray})),c.a.createElement(u.C,{mt:"22px",alignItems:"center",justifyContent:"space-between"},c.a.createElement(u.m,{width:"128px"},c.a.createElement(Xa,{htmlFor:"all-pages",_css12:Object(ve.themeGet)("colors.white"),_css13:Object(ve.themeGet)("textStyles.small")},"Use these sharing settings for all pages")),c.a.createElement(u.wb,{name:"all-pages",disabled:y||!function(){return Object(i.useMemo)((function(){return!p||K}),[K,p])},checked:K,onChange:function(e){if(e){if(f(r._id),n.projectSave({master_share_pid:r._id}),!r.custom_shares){var t=w(),a=n.pageSave(r._id,{custom_shares:t});!a||a instanceof Error||a.done((function(){x(t),h(Aa.Custom)}))}}else f(null),n.projectUnset("master_share_pid"),n.projectSave({})}})),c.a.createElement(u.C,{mt:"2px"},c.a.createElement(da,{textStyle:"small",color:"white",mt:"24px",display:s?"none":"block",onClick:function(e){e.preventDefault(),function(){o&&o.remove();var e=new fr.default({$parent:document.querySelector("body > .popups"),router:window.RM.constructorRouter,opts:{type:"type-custom-sharing",is_contributor:!window.RM.constructorRouter.isOwner,owner_email:n.project.user?n.project.user.email:""},alert_source:"custom sharing"});e.render(),l(e)}()}},"Customize"),c.a.createElement(da,{textStyle:"small",color:"white",mt:"24px",display:s&&b===Aa.Custom?"block":"none",onClick:function(e){if(e.preventDefault(),p){n.projectUnset("master_share_pid");var t=n.projectSave({});!t||t instanceof Error||t.done((function(){f(null),J()}))}else J()}},"Restore to defaults"),c.a.createElement(da,{textStyle:"small",color:"white",mt:"24px",display:s&&b===Aa.Inherited?"block":"none",onClick:function(e){e.preventDefault(),p&&(window.RM.constructorRouter.showWorkspace({id:p}),n.scrollToPage(p))}},"Go to master page")))}));qa.displayName="SocialSettings";var Ka=c.a.memo(qa);function Ja(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Za(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Za(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Za(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Qa=o.e.div.withConfig({displayName:"PageSettings__PageSettingsSidebar"})(["height:100%;width:240px;padding:0;box-sizing:border-box;position:fixed;top:0;right:0;bottom:0;z-index:",";background-color:",";overflow:hidden;transform:translateX( "," );transition:transform 300ms ease;.collapse-btn.divider{border-top:2px solid ",";}"],St,Object(ve.themeGet)("colors.black"),(function(e){return e.isSettingsOpened?e.isPageSettingsOpened?"0":"240px":e.isPageSettingsOpened?"480px":"240px"}),Object(ve.themeGet)("colors.darkGray")),eo=Object(o.e)(u.C).withConfig({displayName:"PageSettings___StyledFlex"})(["cursor:pointer;&:hover{opacity:0.8;}"]),to=function(){var e=Object(i.useContext)(v),t=Object(i.useContext)(Qc),r=Ja(Object(i.useState)(null),2),n=r[0],o=r[1];Object(i.useEffect)((function(){var r=e.isPageSettingsOpened&&t.pages.find((function(e){return e._id===t.currentPageId}))||null;return o(r),function(){o(null)}}),[e.isPageSettingsOpened,t.currentPageNum,t.currentPageId]),Object(i.useEffect)((function(){e.isPageSettingsOpened?document.body.classList.add("page-settings-is-opened"):document.body.classList.remove("page-settings-is-opened")}),[e.isPageSettingsOpened]);return c.a.createElement(Qa,{id:"constructor-page-settings",isPageSettingsOpened:e.isPageSettingsOpened,isSettingsOpened:e.isSettingsOpened},c.a.createElement(u.m,{width:"100%",height:"calc(100% - 90px)"},n&&c.a.createElement(u.a,{springConfig:{mass:1,tension:210,friction:20,clamp:!0}},c.a.createElement(u.r,{renderButton:function(e){var t=e.isActive;return(c.a.createElement(ya,{isActive:t}))},buttonPadding:"0 24px",open:!0},(function(e){return c.a.createElement(Ra,{ref:e,currentPage:n})})),c.a.createElement(u.r,{renderButton:function(e){var t=e.isActive;return(c.a.createElement(Ba,{isActive:t,onClick:function(){!t&&Pe.d.sendEvent(Pe.b.PageSharingOpen)}}))},buttonPadding:"0 24px"},(function(e){return c.a.createElement(Ka,{ref:e,currentPage:n})})))),c.a.createElement(u.C,{width:"100%",height:90,justifyContent:"center",alignItems:"center"},c.a.createElement(eo,{width:208,height:56,alignItems:"center",justifyContent:"center",bg:"darkGray",borderRadius:30,onClick:function(){e.dispatch({type:a.TogglePageSettings})}},c.a.createElement(u.zb,{textStyle:"regular",color:"white",textAlign:"center"},"Done"))))};function ro(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return no(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return no(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function no(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ao=Object(o.e)(u.C).withConfig({displayName:"ToolbarButton___StyledFlex"})(["cursor:pointer;backdrop-filter:blur(3px);display:",";"],(function(e){return e._css})),oo=function(e){var t=e.id,r=e.hidden,n=e.width,a=e.onClick,o=e.onMouseEnter,l=e.onMouseLeave,s=e.className,d=e.children,p=e.ml,f=e.bg,m=e.color,g=e.disabled,b=e.tooltip,h=e.tooltipPosition,y=e.tooltipDisabled,v=e.tooltipModifiers,w=e.tooltipPadding,j=ro(Object(i.useState)(!1),2),S=j[0],O=j[1],x=function(){o&&o(),O(!0)},E=function(){l&&l(),O(!1)},_=function(e,o){return c.a.createElement(ao,{id:t,className:s,width:n||56,height:56,alignItems:"center",justifyContent:"center",borderRadius:30,color:m||g?"gray":"white",bg:f||Object(Q.e)(.12,S&&!g?u.Rb.black:u.Rb.darkGray),onMouseEnter:function(){e&&e()},onMouseLeave:function(){o&&o()},onClick:a,ml:p,_css:r?"none":"flex"},d)};return b?c.a.createElement(u.C,{onMouseEnter:x,onMouseLeave:E},c.a.createElement(u.Cb,{text:b,modifiers:v,position:h||"top",indent:4,disabled:y,p:w,bg:Object(Q.e)(.12,u.Rb.black)},_())):_(x,E)};function io(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return co(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return co(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function co(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var lo=Object(o.f)(["0%{opacity:1;}50%{opacity:0;}"]),so=Object(o.e)(u.m).withConfig({displayName:"CollaboratorLock___StyledBox"})(["display:inline;animation:"," 2.4s infinite steps(1) ","s;"],lo,(function(e){return e._css})),uo=function(e){var t=e.index,r=void 0===t?0:t;return(c.a.createElement(so,{_css:.4*r},"."))},po=Object(o.e)(oo).withConfig({displayName:"CollaboratorLock___StyledToolbarButton"})(["position:relative;width:auto;padding-right:30px;&:hover{background:",";}"],(function(e){return e._css2})),fo=Object(o.e)(u.gb).withConfig({displayName:"CollaboratorLock___StyledResponsiveAvatar"})(["width:54px;height:54px;margin-left:1px;"]),mo=Object(o.e)(u.C).withConfig({displayName:"CollaboratorLock___StyledFlex"})(["flex-direction:column;margin-left:16px;"]),go=Object(o.e)(u.m).withConfig({displayName:"CollaboratorLock___StyledBox2"})(["position:absolute;left:0;right:0;top:0;bottom:0;border-radius:28px;line-height:56px;text-align:center;"]),bo=function(e){var t=e.iAmOwner,r=e.name,n=e.avatarUrl,a=Object(i.useContext)(Qc),o=io(Object(i.useState)(!1),2),l=o[0],s=o[1];return c.a.createElement(po,{ml:2,onClick:function(){},onMouseEnter:function(){return t&&s(!0)},onMouseLeave:function(){return s(!1)},_css2:Object(ve.themeGet)(l?"colors:black":"colors.darkGray")},c.a.createElement(fo,{size:"medium",url:n,name:r}),c.a.createElement(mo,null,c.a.createElement(u.zb,{color:"white",lineHeight:"1"},r),c.a.createElement(u.zb,{color:"gray",lineHeight:"1"},"editing now",c.a.createElement(uo,{index:0}),c.a.createElement(uo,{index:1}),c.a.createElement(uo,{index:2}))),l&&c.a.createElement(go,{color:"white",bg:"black",onClick:function(){return a.takeOverCurrentPage()}},"Take Over"))};function ho(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function yo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ho(Object(r),!0).forEach((function(t){vo(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ho(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function vo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wo(e,t,r,n,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,a)}var jo=c.a.createContext({}),So=function(e){var t=e.model,r=e.children,n=Object(i.useCallback)(function(){var e,r=(e=regeneratorRuntime.mark((function e(r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=yo(yo({},t.get("opts")),r),t.set("opts",n),e.next=4,Object(ke.w)(t.get("num_id"),n);case 4:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){wo(o,n,a,i,c,"next",e)}function c(e){wo(o,n,a,i,c,"throw",e)}i(void 0)}))});return function(e){return r.apply(this,arguments)}}(),[]),a=Object(i.useCallback)((function(e){return n({scalableviewer:e})}),[]),o=Object(i.useCallback)((function(e){return n({scalewidth:e})}),[]),l=Object(i.useCallback)((function(e){return n({viewertype:e})}),[]),s=Object(i.useCallback)((function(e){return n({arrows:e})}),[]),u=Object(i.useCallback)((function(e){return n({slidein:e})}),[]),d=Object(i.useCallback)((function(e){return n({lqip:e})}),[]);return c.a.createElement(jo.Provider,{value:{project:t.attributes,setScaleLayout:a,setDirection:l,setMaxWidth:o,setArrows:s,setSlideIn:u,setLQIP:d}},r)},Oo=r("IwqK");function xo(){return(xo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Eo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Po=function(e){var t=Object(i.useContext)(jo),r=Eo(Object(i.useState)(null),2),n=r[0],a=r[1],o=Eo(Object(i.useState)(null),2),l=o[0],s=o[1],d=Eo(Object(i.useState)(!1),2),p=d[0],f=d[1],m=Object(Oo.a)(n,l,{placement:"top"}),g=m.styles,b=m.attributes,h=m.update;Object(i.useEffect)((function(){h&&h()}),[p]);var y=Object(u.Ub)({watchingClick:p,callback:function(){f(!1)}}),v=t.project.opts,w=e.m,j=e.ml,S=e.mr;return c.a.createElement(c.a.Fragment,null,p&&c.a.createElement(u.m,xo({width:240,mb:16,borderRadius:"m",p:"12px",bg:"lightGray",color:"black",boxShadow:"0 0 0 1px rgba(0, 0, 0, 0.08)",ref:function(e){s(e),y.current=e},style:g.popper},b.popper),c.a.createElement(It,{checked:v.scalableviewer,maxWidth:v.scalewidth,onChange:function(e){return t.setScaleLayout(e)},onMaxWidthChange:function(e){return t.setMaxWidth(e)}}),c.a.createElement(Mt,{direction:v.viewertype,onChange:function(e){return t.setDirection(e)},m:"8px 0"}),c.a.createElement(zt,{arrowsOn:v.arrows,slideIn:v.slidein,slideInRequiresArrows:v.viewertype===Ct.Horizontal,onArrowsChange:function(e){return t.setArrows(e)},onSlideInChange:function(e){return t.setSlideIn(e)},m:"8px 0"}),c.a.createElement(u.C,{justifyContent:"space-between",alignItems:"center",m:16},c.a.createElement(u.zb,{textStyle:"small"},"Progressive images"),c.a.createElement(u.wb,{backgroundChecked:"green",checked:v.lqip,onChange:function(e){return t.setLQIP(e)}}))),c.a.createElement(u.m,xo({ref:a},{m:w,ml:j,mr:S}),c.a.createElement(oo,{size:56,m:0,onClick:function(e){e.stopPropagation(),f(!p)}},c.a.createElement(u.lb,{width:34,height:30,color:"white"}))))};function Co(e,t,r,n,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,a)}function ko(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Co(o,n,a,i,c,"next",e)}function c(e){Co(o,n,a,i,c,"throw",e)}i(void 0)}))}}var Io=Object(o.e)(u.C).withConfig({displayName:"PublishButton___StyledFlex"})(["backdrop-filter:blur(3px);&:hover{background:",";}"],(function(e){return e._css})),Ao=Object(o.e)(u.zb).withConfig({displayName:"PublishButton___StyledText"})(["display:block;line-height:52px;height:56px;text-decoration:none;color:inherit;",""],(function(e){return e._css2})),Ro=function(e){var t=e.m,r=Object(i.useContext)(Qc),n=Object(i.useContext)(v),o=K(r.project),l=Object(i.useCallback)((function(){!r.hasPermission(q.canInjectCode)&&r.hasCustomCode()?n.dispatch({type:a.SetNotice,notice:{message:"Injected Code and Shots will not work in Published project.",tag:Z.customCode}}):!r.hasPermission(q.canUseShots)&&r.hasShots()&&n.dispatch({type:a.SetNotice,notice:{message:"Injected Code and Shots will not work in Published project.",tag:Z.shots}})}),[]),s=Object(i.useCallback)((function(){!r.publishInProgress&&o!==N.SameAsPublished&&n.dispatch({type:a.SetNotice,notice:void 0})}),[r.publishInProgress,o]),d="".concat($.a.readymag_host,"/").concat(r.project.user.uri,"/").concat(r.project.uri,"/"),p=!r.isPublishError&&!r.publishInProgress&&o===N.SameAsPublished,f=Object(i.useCallback)(ko(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o===N.SameAsPublished||r.publishInProgress){e.next=3;break}return e.next=3,r.publish();case 3:case"end":return e.stop()}}),e)}))),[o,r.publishInProgress]),m=Object(i.useCallback)(ko(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o===N.SameAsPublished||r.publishInProgress){e.next=20;break}return n.dispatch({type:a.SetNotice,notice:void 0}),e.prev=2,e.next=5,r.publishWithNotice();case 5:e.next=20;break;case 7:if(e.prev=7,e.t0=e.catch(2),!(e.t0 instanceof te&&"warning"===e.t0.type)){e.next=15;break}return e.next=12,r.publishWithNotice({skipWarnings:!0});case 12:n.dispatch({type:a.SetNotice,notice:e.t0}),e.next=20;break;case 15:if(!(e.t0 instanceof te)){e.next=19;break}n.dispatch({type:a.SetNotice,notice:e.t0}),e.next=20;break;case 19:throw e.t0;case 20:case"end":return e.stop()}}),e,null,[[2,7]])}))),[o,r.publishInProgress]);return c.a.createElement(Io,{id:"publish-button",width:149,height:56,m:t,alignItems:"center",justifyContent:"center",borderRadius:30,bg:Object(Q.e)(.12,u.Rb.darkGray),color:"white",position:"relative",cursor:"pointer",onMouseEnter:r.isNewSettingsMenu&&!p?l:function(){},onMouseLeave:r.isNewSettingsMenu&&!p?s:function(){},onClick:r.isNewSettingsMenu?m:f,_css:Object(Q.e)(.12,u.Rb.black)},c.a.createElement(Ao,{textStyle:"regular",textAlign:"center",is:p?"a":"span",href:p?d:void 0,target:"_blank",_css2:p?"position: absolute; top: 0; right: 0; bottom: 0; left: 0;":""},r.isPublishError?"Error":r.publishInProgress?c.a.createElement(u.R,{bgColor:"transparent"}):o===N.SameAsPublished?"Open":o===N.UnpublishedChanges?"Republish":"Publish"))};function To(){return(To=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Mo(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var No=Object(o.e)(u.m).withConfig({displayName:"Notice___StyledBox"})(["white-space:nowrap;"]),Do=function(e){var t=e.message,r=Mo(e,["message"]);return(c.a.createElement(No,To({lineHeight:"1.5",bg:"lightGray",color:"tomato",p:"16px 24px",borderRadius:"m"},r),t))};function zo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Uo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Uo(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Uo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Fo=function(e){var t=e.previewOnly,r=e.hidden,n=Object(i.useContext)(v),o=zo(Object(i.useState)(!1),2),l=o[0],s=o[1],d=t||n.inPreview,p=Object(i.useCallback)((function(){window.RM.views.toolbar.togglePreview(),!t&&n.dispatch({type:a.TogglePreview})}),[]);return Object(i.useEffect)((function(){return window.RM.constructorRouter.unbindGlobalKeyPress("p",p),window.RM.constructorRouter.bindGlobalKeyPress({key:"p",handler:p}),function(){window.RM.constructorRouter.unbindGlobalKeyPress("p",p)}}),[]),c.a.createElement(oo,{id:"preview-toggle-button",tooltip:d?"Edit (P)":"Preview (P)",tooltipDisabled:l,ml:2,hidden:r,onMouseEnter:function(){return l&&s(!1)},onClick:function(){p(),s(!0)}},d?c.a.createElement(u.z,{preserveAspectRatio:"none",width:38,height:38}):c.a.createElement(u.A,{height:"26px",width:"38px"}))};function Bo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Lo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lo(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Go=Object(o.e)(u.C).withConfig({displayName:"Toolbar___StyledFlex"})(["transition:transform "," ease;transform:",";"],(function(e){return e._css}),(function(e){return e._css2})),Ho=function(e){var t,r=e.transform,n=e.previewOnly,a=e.className,o=Object(i.useContext)(Qc),l=Object(i.useContext)(v),s=n||l.inPreview,u=o.lockedPages[o.currentPageId],d=u&&u!==(null===(t=window.RM.constructorRouter.me)||void 0===t?void 0:t.get("uri"))?o.collaborators.find((function(e){return e.uri===u})):void 0,p=Bo(Object(i.useState)(!0),2),f=p[0],m=p[1],g=Bo(Object(i.useState)(!l.isSettingsOpened),2),b=g[0],h=g[1];return Object(i.useEffect)((function(){f&&m(!1),l.isSettingsOpened?h(!1):setTimeout((function(){return h(!0)}),f?0:300)}),[l.isSettingsOpened]),c.a.createElement(c.a.Fragment,null,c.a.createElement(Go,{className:a,justifyContent:"space-between",position:"fixed",right:80,bottom:16,zIndex:St,_css:xt,_css2:r},!s&&d&&c.a.createElement(bo,{iAmOwner:o.isOwner,name:d.name,avatarUrl:d.pic}),s&&l.readyToPublish&&c.a.createElement(Ro,{m:"0 0 0 8px"}),o.isNewSettingsMenu&&s?c.a.createElement(Po,{ml:2}):null,c.a.createElement(Fo,{hidden:!o.isNewSettingsMenu&&!b,previewOnly:n})),o.isNewSettingsMenu&&(l.isSettingsOpened||l.inPreview)&&l.notice&&c.a.createElement(Do,{position:"fixed",left:16,bottom:16,message:l.notice.message,zIndex:St+1}))};function Wo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Vo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Vo(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Yo,$o=function(e){var t=e.width,r=e.height;return(c.a.createElement("svg",{width:t,height:r,viewBox:"0 0 34 30",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{d:"M11.738 1a5 5 0 00-4.35 2.5l-5.149 8.918a5 5 0 00.01 5.017l5.267 9.04a5 5 0 004.301 2.484L22.28 29a5 5 0 004.35-2.5l5.149-8.918a5 5 0 00-.01-5.017l-5.267-9.04A5 5 0 0022.2 1.04l-10.463-.04zm5.273 9a5 5 0 110 10 5 5 0 010-10z",stroke:"#FFF",strokeWidth:"2",fill:"none",fillRule:"evenodd"})))},Xo=Object(o.e)(u.zb).withConfig({displayName:"SettingsToggle___StyledText"})(["font-weight:700;"]),qo=function(e){var t=e.onMouseEnter,r=Object(i.useContext)(v),n=Object(i.useContext)(Qc),o=Wo(Object(i.useState)(""),2),l=o[0],s=o[1],d=Wo(Object(i.useState)(""),2),p=d[0],m=d[1];Object(i.useEffect)((function(){var e=n.currentPageId,t=n.pagesParams;t[e]&&(t[e].parentId?(s("".concat(t[t[e].parentId].viewNum)),m("".concat(t[e].viewNum))):(s("".concat(t[e].viewNum)),p&&m("")))}),[n.currentPageNum,n.currentPageId]);var g=Wo(Object(i.useState)(!1),2),b=g[0],h=g[1];Object(i.useEffect)((function(){b&&setTimeout((function(){return h(!1)}),2e3)}),[b]);var y=Object(i.useCallback)((function(){r.dispatch({type:a.ToggleSettingsSidebar})}),[]),w=Object(i.useCallback)((function(){h(!0),r.isSettingsOpened?r.isProjectSettingsOpened?r.dispatch({type:a.SetProjectSettingsState,payload:!1}):r.dispatch({type:a.SetProjectSettingsState,payload:!0}):r.dispatch({type:a.OpenSettingsSidebar})}),[r.isSettingsOpened,r.isProjectSettingsOpened]),j=Object(i.useCallback)((function(){h(!0),y()}),[]);return Object(i.useEffect)((function(){return f.a.on("shortcut:m",y),function(){f.a.off("shortcut:m",y)}}),[]),c.a.createElement(oo,{id:"settings-toggle-button",tooltip:r.isSettingsOpened?n.isNewSettingsMenu?r.isProjectSettingsOpened?"Page settings":"Project settings":"Close (M/Esc)":"Menu (M)",tooltipDisabled:b,tooltipPadding:"0 12px",onMouseEnter:t,onClick:n.isNewSettingsMenu?w:j},r.isSettingsOpened?n.isNewSettingsMenu?r.isProjectSettingsOpened?c.a.createElement(u.U,null):c.a.createElement($o,{width:34,height:30}):c.a.createElement(u.w,null):1===n.pages.length?c.a.createElement(u.U,null):c.a.createElement(c.a.Fragment,null,c.a.createElement(u.zb,{textStyle:"subheading"},l),p?c.a.createElement(Xo,{textStyle:"small",position:"relative",top:5},".",p):null))};function Ko(){return(Ko=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Jo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Zo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zo(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}!function(e){e.connection="connection",e.socket="socket",e.none="none"}(Yo||(Yo={}));var Qo,ei={connection:"Seems there is a connection problem. Changes may not be saved until this\n  alert disappears.",socket:"You have been disconnected from the server.",duplicate:"It seems like you’ve opened this project in another tab or browser. We’ve\n  interrupted this session in order to avoid conflicting copies.",none:"unknown alert"},ti=Object(o.e)(u.m).withConfig({displayName:"ConnectionAlert___StyledBox"})(["transform:",";"],(function(e){return e._css})),ri=Object(o.e)(u.n).withConfig({displayName:"ConnectionAlert___StyledButton"})(["&:hover{color:",";background:",";}"],(function(e){return e._css2}),(function(e){return e._css3})),ni=function(e){var t=e.transform,r=Jo(Object(i.useState)(Yo.none),2),n=r[0],a=r[1],o=function(){return a(Yo.connection)},l=function(){return a(Yo.socket)},s=function(){return a(Yo.none)},d=Object(i.useMemo)((function(){return ei[n]}),[n]);Object(i.useEffect)((function(){return window.RM.constructorRouter.on("showConnectionAlert",o),window.RM.constructorRouter.on("showSocketConnectionAlert",l),window.RM.constructorRouter.on("hideConnectionAlert",s),window.RM.constructorRouter.on("hideSocketConnectionAlert",s),function(){window.RM.constructorRouter.off("showConnectionAlert",o),window.RM.constructorRouter.off("showSocketConnectionAlert",l),window.RM.constructorRouter.off("hideConnectionAlert",s),window.RM.constructorRouter.off("hideSocketConnectionAlert",s)}}),[window.RM.constructorRouter]);var p=Jo(Object(i.useState)(null),2),f=p[0],m=p[1],g=Jo(Object(i.useState)(null),2),b=g[0],h=g[1],y=Jo(Object(i.useState)(!0),2),v=y[0],w=y[1],j=Object(Oo.a)(f,b,{placement:"top"}),S=j.styles,O=j.attributes,x=j.update,E=n===Yo.socket,_=n!==Yo.none;return Object(i.useEffect)((function(){x&&x()}),[n]),c.a.createElement(c.a.Fragment,null,E&&c.a.createElement(u.Y,{zIndex:Ot-1,bg:"black",opacity:.2}),c.a.createElement(ti,{position:"fixed",right:144,bottom:16,display:_?"flex":"none",ml:2,zIndex:Ot,_css:t},v&&c.a.createElement(u.m,Ko({width:276,p:16,mb:18,borderRadius:"s",textAlign:"center",bg:"white",boxShadow:"0 0 0 1px rgba(0, 0, 0, 0.08)",ref:h,style:S.popper},O.popper),c.a.createElement(u.m,null,c.a.createElement(u.zb,{display:"block",textStyle:"regular"},d)),E&&c.a.createElement(ri,{mt:12,width:88,height:38,borderRadius:"s",bg:"tomato",color:"white",onClick:function(){return window.location.reload()},_css2:Object(ve.themeGet)("colors.white"),_css3:Object(ve.themeGet)("colors.black")},"Reload")),c.a.createElement(u.m,{ref:m},c.a.createElement(u.hb,{size:56,mr:0,color:"tomato",onClick:function(){return w(!v)}},c.a.createElement(u.M,{color:"white"})))))};function ai(e){return function(e){if(Array.isArray(e))return ci(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||ii(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||ii(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ii(e,t){if(e){if("string"==typeof e)return ci(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ci(e,t):void 0}}function ci(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}!function(e){e.Settings="Settings",e.Trash="Trash",e.PageSettings="PageSettings"}(Qo||(Qo={}));var li=[{stateName:"isSettingsOpened",methodName:a.ToggleSettingsSidebar,panelName:Qo.Settings},{stateName:"isTrashOpened",methodName:a.ToggleTrash,panelName:Qo.Trash},{stateName:"isPageSettingsOpened",methodName:a.TogglePageSettings,panelName:Qo.PageSettings}],si=function(){var e=Object(i.useContext)(v),t=oi(Object(i.useState)(!1),2),r=t[0],n=t[1],a=oi(Object(i.useState)([]),2),o=a[0],c=a[1],l=Object(u.Tb)("Escape");Object(i.useEffect)((function(){var t;e.isSettingsOpened?(t=[],li.forEach((function(r){e[r.stateName]&&t.push(r)})),c(t)):o.length&&c([])}),[e.isSettingsOpened]);var s=function(e){var t=li.find((function(t){return t.panelName===e}));if(t){var r=ai(o);r.push(t),c(r)}},d=function(e){var t=o.findIndex((function(t){return t.panelName===e}));if(t>=0){var r=ai(o);r.splice(t,1),c(r)}};return Object(i.useEffect)((function(){if(!r&&l&&o.length){var t=ai(o),a=t.pop();a&&(e.dispatch({type:a.methodName}),c(t))}n(l)}),[l]),Object(i.useEffect)((function(){e.isTrashOpened?s(Qo.Trash):d(Qo.Trash)}),[e.isTrashOpened]),Object(i.useEffect)((function(){e.isPageSettingsOpened?s(Qo.PageSettings):d(Qo.PageSettings)}),[e.isPageSettingsOpened]),null},ui=r("lU33"),di=r("M85P"),pi=r("ilPa"),fi=r("WCWw"),mi=r.n(fi),gi=Object(o.e)(mi.a.input).withConfig({displayName:"Input__UserInput"})(["",";",";",";outline:none;height:70px;width:100%;padding-left:0;padding-right:0;border:none;font-family:",";transition:border-color 100ms ease-out;border-top:2px solid transparent;border-bottom:2px solid ",";border-radius:0;&::placeholder{color:","!important;}&:focus{border-bottom-color:",";&::placeholder{color:","!important;}}"],ve.space,ve.textStyle,ve.fontWeight,Object(ve.themeGet)("fonts.main"),Object(ve.themeGet)("colors.lightGray"),Object(ve.themeGet)("colors.gray"),Object(ve.themeGet)("colors.black"),Object(ve.themeGet)("colors.gray"));gi.defaultProps={textStyle:"subheading"};var bi=gi;function hi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function yi(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hi(Object(r),!0).forEach((function(t){vi(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function vi(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wi(e){return function(e){if(Array.isArray(e))return ji(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ji(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ji(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ji(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Si=function(e){return e&&/^\S+@\S+$/.test(e)},Oi=function(e){return!e.isFolder},xi=function(e){return e.isFolder},Ei=function(e,t){var r=[].concat(wi(e),wi(t));return r.map((function(e){if(!e.isPending)return e;var t=r.find((function(t){return t.email===e.email&&t._id!==e._id}));return t?yi(yi({},e),{},{name:t.name,pic:t.pic}):e}))};function _i(){return(_i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Pi(e){return(Pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ci(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ki(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ci(Object(r),!0).forEach((function(t){Ii(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ci(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ii(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ai(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Ri(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ti,Mi,Ni=function(e,t){return e||Si(t)},Di=(Ti=u.Qb,Mi=1,function(e){if(Array.isArray(e))return e}(Ti)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}}(Ti,Mi)||function(e,t){if(e){if("string"==typeof e)return Ri(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ri(e,t):void 0}}(Ti,Mi)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],zi=Object(o.e)(u.hb).withConfig({displayName:"UserSearch__CancelItem"})(["position:absolute;left:0;top:0;right:0;bottom:0;z-index:1;margin:auto;"]),Ui=function(e,t){var r=t.inputValue,n=Ai(t,["inputValue"]);switch(n.type){case di.a.stateChangeTypes.blurInput:case di.a.stateChangeTypes.itemMouseEnter:case di.a.stateChangeTypes.mouseUp:return n;default:return ki({inputValue:r},n)}},Fi=Object(o.e)(u.gb).withConfig({displayName:"UserSearch___StyledResponsiveAvatar"})(["display:block;"]),Bi=Object(o.e)(u.C).withConfig({displayName:"UserSearch___StyledFlex"})(["",".clear{visibility:hidden;}&:hover ",".clear{visibility:visible;}"],u.n,u.n),Li=Object(o.e)(u.m).withConfig({displayName:"UserSearch___StyledBox"})(["",""],(function(e){return e._css})),Gi=Object(o.e)(bi).withConfig({displayName:"UserSearch___StyledInput"})(["box-sizing:border-box;height:","px;"],(function(e){return e._css2})),Hi=Object(o.e)(u.q).withConfig({displayName:"UserSearch___StyledCollaborator"})(["opacity:0.4;"]),Wi=Object(o.e)(u.hb).withConfig({displayName:"UserSearch___StyledRoundButton"})(["flex-shrink:0;margin-right:0;"]),Vi=Object(o.e)(u.C).withConfig({displayName:"UserSearch___StyledFlex2"})(["",""],(function(e){return e._css3})),Yi=function(e){var t=e.placeholder,r=e.submitText,n=void 0===r?"Submit":r,a=e.suggestions,o=void 0===a?[]:a,l=e.renderWhenSelected,s=e.disabled,d=void 0!==s&&s,p=e.focusOnMount,f=e.onChange,m=e.onFocus,g=e.onBlur,b=e.selectedUser,h=e.showInput,y=void 0===h||h,v=Object(i.useRef)(null);return Object(i.useEffect)((function(){p&&v.current&&v.current.focus()}),[p]),c.a.createElement(di.a,{stateReducer:Ui,itemToString:function(e){return e?e.name:null},id:"rm-user-search",initialInputValue:"string"==typeof b?b:void 0,initialSelectedItem:"object"===Pi(b)?b:void 0,isOpen:!0,onStateChange:function(e){f&&(void 0!==e.selectedItem?(f(e.selectedItem),Pe.d.sendEvent(Pe.c.CollaborateSuggestionApplied)):void 0!==e.inputValue&&f(e.inputValue))}},(function(e){var r=e.getInputProps,a=e.getItemProps,i=e.getMenuProps,s=e.selectedItem,p=e.inputValue,f=e.clearSelection;return(c.a.createElement("div",null,c.a.createElement(ui.a,{query:"(min-width: ".concat(Di,")")},(function(e){var b=Object(pi.a)(o,p||"",{keys:["name"]}),h=p?null:Boolean(o.length)&&c.a.createElement(u.C,{mr:[0,3],mb:[3,0],height:72,alignItems:"center"},c.a.createElement(u.zb,{textStyle:e?"subheading":"regular",color:"gray"},"Suggestions"));return c.a.createElement(u.m,null,c.a.createElement(u.C,{pl:s||!e?0:88,flexDirection:["row-reverse","row"]},s?e?c.a.createElement(u.gb,{name:s.name,url:s.pic,mr:3}):c.a.createElement(u.m,{position:"relative"},c.a.createElement(zi,{color:"tomato",size:24,"aria-label":"Clear selection",onClick:function(){return f()}},c.a.createElement(u.x,null)),c.a.createElement(Fi,{name:s.name,url:s.pic})):null,c.a.createElement(u.m,{flex:1,display:["flex","block"]},c.a.createElement(Bi,{justifyContent:"space-between",borderBottom:s?"2px solid":void 0,borderColor:"black",width:1,position:"relative"},s?c.a.createElement(u.C,{height:u.Ob.regular-2,alignItems:"center"},c.a.createElement(Li,{_css:e?"":"white-space: nowrap; width: calc(100vw - 200px); overflow: hidden; text-overflow: ellipsis;"},c.a.createElement(u.zb,{textStyle:e?"subheading":"regular"},s.name,e&&c.a.createElement(u.n,{className:"clear","aria-label":"Clear selection",onClick:function(){return f()},ml:2},c.a.createElement(u.x,{"aria-hidden":!0}))))):y?c.a.createElement(u.m,{as:"label",width:1},c.a.createElement(u.Mb,{as:"span"},t),c.a.createElement(Gi,_i({ref:v,textStyle:e?"subheading":"regular",pr:80},r(ki(ki({placeholder:t,id:"rm-user-search-input",height:u.Ob.regular,disabled:d},m?{onFocus:function(){return m()}}:{}),g?{onBlur:function(){return g()}}:{})),{_css2:u.Ob.regular}))):"",Ni(s,p)&&e?c.a.createElement(u.n,{variant:"primary",textStyle:"subheading",type:"submit",disabled:d,position:"absolute",right:0,lineHeight:"72px",minWidth:60},n):null),!e&&p&&!Ni(s,p)&&b.length?b.slice(0,1).map((function(e,t){return c.a.createElement(Hi,_i({name:e.name||e.email,email:e.name?e.email:"",url:e.pic,projectsCount:e.projectsCount,key:t,isCaptionVisible:!1,showInitials:!1,fullBox:!1,"data-testid":e._id},a({item:e,key:t})))})):null,Ni(s,p)&&!e?c.a.createElement(Wi,{type:"submit",size:u.Ob.regular,color:"tomato",disabled:d},n):null,Ni(s,p)?l:null)),o.length?c.a.createElement(u.m,{mt:[22,66],ml:[0,u.Ob.regular+16],minHeight:u.Ob.regular+(e?u.Pb:0)},Ni(s,p)?null:c.a.createElement(u.m,{display:["block","flex"]},e?null:h,c.a.createElement(Vi,_i({},i(),{flexWrap:["nowrap","wrap"],ml:[-24,0],pl:[24,0],width:["100vw",null],_css3:e?"":"overflow-x: auto; -webkit-overflow-scrolling: touch"}),e?h:null,e||!p?b.map((function(t,r){return c.a.createElement(u.m,{height:116,key:r},c.a.createElement(u.q,_i({name:t.name||t.email,email:t.name?t.email:"",url:t.pic,projectsCount:t.projectsCount,isCaptionVisible:!e,fullBox:!e,"data-testid":t._id},a({item:t,key:r}))))})):null))):null)}))))}))},$i=r("0NDv");function Xi(e,t,r,n,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,a)}function qi(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Xi(o,n,a,i,c,"next",e)}function c(e){Xi(o,n,a,i,c,"throw",e)}i(void 0)}))}}var Ki=function(){var e=qi(regeneratorRuntime.mark((function e(t,r,n,a){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$i.a.post("/api/team",{email:t,mags:r,folders:n,sharesAll:a});case 2:if((o=e.sent).teamMember){e.next=5;break}throw o.error||o;case 5:return e.abrupt("return",o.teamMember);case 6:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),Ji=function(){var e=qi(regeneratorRuntime.mark((function e(t,r,n,a){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$i.a.put("/api/team",{email:t,mags:r,folders:n,sharesAll:a});case 2:if((o=e.sent).teamMember){e.next=5;break}throw o.error||o;case 5:return e.abrupt("return",o.teamMember);case 6:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),Zi=function(e){return $i.a.delete("/api/team",{email:e})},Qi=function(e){return $i.a.post("/api/team/invite",{email:e})};function ec(e,t,r,n,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,a)}function tc(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){ec(o,n,a,i,c,"next",e)}function c(e){ec(o,n,a,i,c,"throw",e)}i(void 0)}))}}function rc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nc(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ac(e,t){return(ac=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=cc(e);if(t){var a=cc(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return ic(this,r)}}function ic(e,t){return!t||"object"!==uc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cc(e){return(cc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function sc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uc(e){return(uc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dc(e){return function(e){if(Array.isArray(e))return fc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||pc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pc(e,t){if(e){if("string"==typeof e)return fc(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?fc(e,t):void 0}}function fc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var mc=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||pc(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(u.Qb,1)[0],gc=function(e){return e.reduce((function(e,t){return Oi(t)?[].concat(dc(e),[t.num_id]):e}),[])},bc=function(e){var t=e.all,r=e.excluded,n=e.selectedUser,a=(r||[]).map((function(e){return e._id}));return n&&"object"===uc(n)&&n._id&&a.push(n._id),t.reduce((function(e,t){var r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lc(Object(r),!0).forEach((function(t){sc(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t),n=e.map((function(e){return e._id}));return t.isPending||[].concat(dc(a),dc(n)).includes(t._id)?e:[].concat(dc(e),[r])}),[])},hc=function(e){return e.reduce((function(e,t){return xi(t)?[].concat(dc(e),[t._id]):e}),[])};Object(o.e)(mi.a.input).withConfig({displayName:"TeamworkModal__ProjectsFilter"})(["",";",";",";outline:none;height:72px;width:100%;padding-left:0;padding-right:0;border:none;transition:border-color 100ms ease-out;border-top:2px solid transparent;border-bottom:2px solid ",";border-radius:0;&::placeholder{color:",";}&:focus{border-bottom-color:",";}"],ve.space,ve.textStyle,ve.fontWeight,Object(ve.themeGet)("colors.lightGray"),Object(ve.themeGet)("colors.gray"),Object(ve.themeGet)("colors.black")).defaultProps={textStyle:"subheading"};var yc,vc,wc,jc,Sc=o.e.div.withConfig({displayName:"TeamworkModal__PendingButtons"})(["white-space:nowrap;","{display:none;}&:hover{","{display:none;}","{display:inline-block;}}"],u.n,u.zb,u.n),Oc=Object(o.e)(u.C).withConfig({displayName:"TeamworkModal___StyledFlex"})(["flex-wrap:wrap;"]),xc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ac(e,t)}(o,e);var t,r,n,a=oc(o);function o(){var e;return rc(this,o),(e=a.apply(this,arguments)).state={projects:e.props.projects?e.props.projects:[],selectedUser:null,copy:!1,isSubmitting:!1,didError:!1,userSearchKey:1,lastInvinationTo:null,filteredProjects:e.props.allProjects.slice(0,2)},e.formRef=c.a.createRef(),e.onChange=function(t){e.setState({selectedUser:t,selectedProject:void 0})},e.onFocus=function(t){e.setState({isInputInFocus:!0}),e.formRef.current&&!t&&window.scroll({top:e.formRef.current.offsetTop,behavior:"smooth"})},e.onBlur=function(){return e.setState({isInputInFocus:!1})},e.isFormValid=function(){return e.state.selectedUser&&Si("string"==typeof e.state.selectedUser?e.state.selectedUser:e.state.selectedUser.email)},e.addCollaborator=function(){var t=tc(regeneratorRuntime.mark((function t(r){var n,a,o,i,c,l,s,u,d,p,f,m,g,b,h,y,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r?{selectedUser:r}:e.state,a=n.selectedUser,o=e.props.user,!a){t.next=37;break}if(i="string"==typeof a?a:a.email,c=gc(e.props.allProjects),l=gc(e.state.projects),s=hc(e.state.projects),e.setState({isSubmitting:!0,didError:!1,error:""}),o.email!==i){t.next=10;break}return t.abrupt("return",e.setState({isSubmitting:!1,didError:!0,error:"You can’t collaborate with yourself."}));case 10:if(t.prev=10,u=Ei(e.props.myTeam,e.props.sharedTeam),d=u.find((function(e){return e.email===i})),p=d&&e.props.myTeam.some((function(e){return e.email===i})),!d||!p){t.next=25;break}return m=d.sharesAll?c:new Set([].concat(dc(d.projectNumIds),dc(l))),g=new Set([].concat(dc(d.folderIds),dc(s))),b=(f=Array.prototype).concat.apply(f,dc(dc(g).map((function(t){return e.props.allProjects.filter((function(e){return Oi(e)&&e.folder===t}))})))).map((function(e){return e.num_id})),h=new Set(dc(m).filter((function(e){return!b.includes(e)}))),t.next=21,Ji(i,dc(h),dc(g),!1);case 21:y=t.sent,e.props.onTeammateUpdate(y),t.next=31;break;case 25:return t.next=27,Ki(i,l,s,!1);case 27:v=t.sent,Pe.d.sendEvent(Pe.b.AddTeamMember),Pe.d.sendEvent(Pe.c.Collaborate,{eventLabel:e.getAnalyticsLabel()}),e.props.onTeammateAdd(v);case 31:e.setState({isSubmitting:!1,didError:!1,userSearchKey:e.state.userSearchKey+1,selectedUser:""}),t.next=37;break;case 34:t.prev=34,t.t0=t.catch(10),e.setState({isSubmitting:!1,didError:!0,error:t.t0.error?t.t0.error.message?t.t0.error.message:t.t0.error.toString():"Error adding collaborator. Please try again."});case 37:case"end":return t.stop()}}),t,null,[[10,34]])})));return function(e){return t.apply(this,arguments)}}(),e.onSubmit=tc(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.state.projects.length){t.next=4;break}e.setState({isSelectUserProjectVisible:!0}),t.next=6;break;case 4:return t.next=6,e.addCollaborator();case 6:case"end":return t.stop()}}),t)}))),e.onUnshare=function(){var t=tc(regeneratorRuntime.mark((function t(r){var n,a,o,i,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=gc(e.state.projects),a=hc(e.state.projects),o=gc(e.props.allProjects),i=(r.sharesAll?o:r.projectNumIds).filter((function(e){return!n.includes(e)})),c=r.folderIds.filter((function(e){return!a.includes(e)})),e.setState({didError:!1,error:""}),t.prev=6,!r.isPending||i.length||c.length){t.next=14;break}return t.next=10,Zi(r.email);case 10:Pe.d.sendEvent(Pe.b.DeleteTeamMember),e.props.onTeammateRemove(r),t.next=18;break;case 14:return t.next=16,Ji(r.email,i,c,!1);case 16:l=t.sent,e.props.onTeammateUpdate(l);case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(6),e.setState({didError:!0,error:"Error when unsharing. Please try again."});case 23:case"end":return t.stop()}}),t,null,[[6,20]])})));return function(e){return t.apply(this,arguments)}}(),e.onResend=function(){var t=tc(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({didError:!1,error:""}),t.prev=1,t.next=4,Qi(r.email);case 4:e.setState({lastInvinationTo:r._id}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),e.setState({didError:!0,error:"Error sending invitation. Please try again."});case 10:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e){return t.apply(this,arguments)}}(),e.getContributorsPlanLimit=function(){var t=e.props.user;return t&&t.plan_limits&&t.plan_limits.contributors||0},e.getTeammatesWithSharedMags=function(e){return e.filter((function(e){return e.sharesAll||e.projectNumIds&&e.projectNumIds.length||e.folderIds&&e.folderIds.length}))},e.getAnalyticsLabel=function(){var t=gc(e.state.projects),r=hc(e.state.projects),n=t.length,a=r.length;return n&&a?"Multiple":n?"Project":"Collection"},e}return t=o,(r=[{key:"render",value:function(){var e=this,t=Ei(this.props.myTeam,this.props.sharedTeam),r=function(e,t){return t.filter((function(t){return e.length&&(t.sharesAll&&e.every((function(e){return Oi(e)}))||e.every((function(e){return Oi(e)&&(t.projectNumIds||[]).includes(e.num_id)||Oi(e)&&!!e.folder&&(t.folderIds||[]).includes(e.folder)||xi(e)&&(t.folderIds||[]).includes(e._id)})))}))}(this.state.projects,t),n=gc(this.state.projects),a=bc({all:this.props.myTeam,excluded:r,selectedUser:this.state.selectedUser}),o=hc(this.state.projects),i=n.length,l=o.length,s=!r.length,d=this.getContributorsPlanLimit()-this.getTeammatesWithSharedMags(this.props.myTeam).length>0,p=[i?"".concat(i>1?i+" selected projects":"project"):"",l?"".concat(l>1?l+(i?" folders":" selected folders"):"folder"):""].join(l&&i?" and ":""),f=c.a.createElement(u.rb,{as:"a",color:"gray",href:"/settings#change-plan"},"Upgrade to invite more");return c.a.createElement(ui.a,{query:"(min-width: ".concat(mc,")")},(function(t){return c.a.createElement(u.W,{closeTitle:"Close",initialFocus:t&&s?"#rm-user-search-input":"",show:e.props.show,onExit:e.props.onExit,error:e.state.error,zIndex:10500,title:c.a.createElement(u.m,{as:"span",pl:t?u.Ob.regular+16:0},e.props.projects?e.state.projects.length?r.length?"".concat(p," shared with"):"Collaborate on ".concat(p," with"):"Add collaborator":c.a.createElement(c.a.Fragment,null,e.state.isSelectUserProjectVisible?c.a.createElement(u.n,{as:"a",textStyle:t?"subheading":"regular",onClick:function(){e.setState({isSelectUserProjectVisible:!1,projects:[]})},color:"gray"},"Add collaborator"):c.a.createElement(u.zb,{textStyle:t?"subheading":"regular"},"Add collaborator"),e.state.isSelectUserProjectVisible||e.state.selectedProject?c.a.createElement(c.a.Fragment,null,c.a.createElement(u.zb,{px:2,textStyle:t?"subheading":"regular",color:"gray"},">"),e.state.selectedProject&&!e.state.isSelectUserProjectVisible?c.a.createElement(u.n,{as:"a",textStyle:t?"subheading":"regular",onClick:function(){e.setState({isSelectUserProjectVisible:!0,projects:[]})},color:"gray"},"Select project"):c.a.createElement(u.zb,{textStyle:t?"subheading":"regular"},"Select project")):null))},c.a.createElement(u.C,{mb:[0,a.length>1?0:40],flex:["1",null],flexDirection:"column",justifyContent:["space-between",null]},c.a.createElement(u.m,{mt:[0,72],mb:[80,0]},t&&c.a.createElement(u.C,{flexDirection:"column"},r.map((function(t){return c.a.createElement(u.C,{justifyContent:"space-between",key:t._id||t.email},c.a.createElement(u.C,{alignItems:"center"},c.a.createElement(u.gb,{name:t.name||"",url:t.pic}),c.a.createElement(u.m,{ml:16},c.a.createElement(u.zb,{as:"div",textStyle:"subheading"},t.name||t.email))),function(t){return e.state.projects.every((function(e){return Oi(e)&&!!e.folder&&t.folderIds.includes(e.folder)}))}(t)?c.a.createElement(u.n,{variant:"tertiary",textStyle:"subheading",disabled:!0},"Shared within collection"):t.isPending?c.a.createElement(Sc,null,c.a.createElement(u.zb,{as:"div",textStyle:"subheading",lineHeight:"".concat(u.Ob.regular,"px")},"Pending"),c.a.createElement(u.n,{variant:"tertiary",textStyle:"subheading",lineHeight:"".concat(u.Ob.regular,"px"),onClick:function(){return e.onResend(t)},onMouseOut:function(){return e.setState({lastInvinationTo:null})}},e.state.lastInvinationTo===t._id?"Sent":"Resend"),c.a.createElement(u.n,{variant:"tertiary",textStyle:"subheading",lineHeight:"".concat(u.Ob.regular,"px"),ml:10,onClick:function(){return e.onUnshare(t)}},"Unshare")):c.a.createElement(u.n,{variant:"tertiary",textStyle:"subheading",onClick:function(){return e.onUnshare(t)}},"Unshare"))}))),e.state.isTeammateDropdownOpen||!d&&!e.state.selectedUser&&1!==a.length?null:c.a.createElement(u.m,{as:"form",onSubmit:function(t){t.preventDefault(),1!==a.length||d?e.isFormValid()&&e.onSubmit():e.setState({selectedUser:a[0]},(function(){e.isFormValid()&&e.onSubmit()}))},mt:[26,0],ref:e.formRef},c.a.createElement(Yi,{placeholder:"Maria or maria@example",submitText:d?e.state.projects.length?"Invite":"Select project":"Add",disabled:e.state.isSubmitting,suggestions:!e.state.error&&(a.length>1||d)?a:[],onChange:e.onChange,onFocus:function(){return e.onFocus(t)},onBlur:function(){return e.onBlur()},key:e.state.userSearchKey,"data-testid":"user-search",showInput:d,selectedUser:e.state.selectedUser?e.state.selectedUser:1!==a.length||d?void 0:a[0]})),!d&&!e.state.selectedUser&&a.length>1?c.a.createElement(u.m,{pl:[0,88],mt:[0,24],minHeight:[60,0],textAlign:t?"left":"center",pb:10},e.state.projects.length?c.a.createElement(u.zb,{textStyle:t?"subheading":"regular",color:"gray"},"Add collaborator"):null,c.a.createElement(Oc,{mt:[0,12]},a.map((function(r){return c.a.createElement(u.m,{key:r._id||r.email,height:145},c.a.createElement(u.q,{name:r.name||r.email,email:r.email,url:r.pic,projectsCount:r.projectsCount,isCaptionVisible:!t,fullBox:!t,"data-testid":r._id,onClick:tc(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({selectedUser:r});case 1:case"end":return t.stop()}}),t)})))}))})))):null),d?null:c.a.createElement(c.a.Fragment,null,c.a.createElement(u.m,{pl:[0,88],mt:[0,a.length>1?40:100],mb:[18,56],minHeight:[60,0],textAlign:t?"left":"center"},c.a.createElement(u.zb,null,"You can’t ",a.length?"invite":"add"," more collaborators on your plan."," ",t&&f)),!t&&c.a.createElement(u.m,{flex:"0 0 0",p:"28px 0 17px",borderTop:"2px solid",borderColor:"lightGray",textAlign:"center"},f))))}))}}])&&nc(t.prototype,r),n&&nc(t,n),o}(c.a.Component);function Ec(e){return function(e){if(Array.isArray(e))return Cc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Pc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||Pc(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pc(e,t){if(e){if("string"==typeof e)return Cc(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Cc(e,t):void 0}}function Cc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}!function(e){e.Draggable="Draggable",e.Selectable="Selectable",e.Search="Search"}(yc||(yc={})),function(e){e.ByMe="ByMe",e.WithMe="WithMe"}(vc||(vc={})),function(e){e.Grouped="Grouped",e.Ungrouped="Ungrouped"}(wc||(wc={})),function(e){e.Alphabet="Alphabet",e.LastChanged="LastChanged",e.DateCreated="DateCreated"}(jc||(jc={}));var kc=Object(o.e)(u.m).withConfig({displayName:"Settings___StyledBox"})(["opacity:",";display:",";transition:opacity 300ms ease;z-index:",";"],(function(e){return e._css}),(function(e){return e._css2}),(function(e){return e._css3})),Ic=function(e){var t=e.show,r=e.overAll;return(c.a.createElement(kc,{width:"240px",height:"100%",position:"absolute",top:"0",bottom:"0",bg:"black",_css:t?"0.4":"0",_css2:t?"block":"none",_css3:r?1e3:"auto"}))},Ac=Object(o.e)(Ho).withConfig({displayName:"Settings___StyledToolbar"})(["z-index:",";"],(function(e){return e._css4})),Rc=Object(o.e)(u.m).withConfig({displayName:"Settings___StyledBox2"})(["position:fixed;bottom:16px;right:16px;z-index:",";transform:",";transition:transform "," ease;"],(function(e){return e._css5}),(function(e){return e._css6}),(function(e){return e._css7})),Tc=Object(o.e)(u.m).withConfig({displayName:"Settings___StyledBox3"})(["transform:translateX( "," );transition:transform "," ease;"],(function(e){return e._css8}),(function(e){return e._css9})),Mc=Object(o.e)(u.Y).withConfig({displayName:"Settings___StyledOverlay"})(["background-color:",";"],(function(e){return e._css10})),Nc=function(e){var t=e.projectSettingsPanel,r=Object(i.useContext)(v),n=Object(i.useContext)(Qc);Object(i.useEffect)((function(){r.isSettingsOpened?document.body.classList.add("settings-is-shown"):document.body.classList.remove("settings-is-shown")}),[r.isSettingsOpened]),Object(i.useEffect)((function(){r.isSettingsOpened&&n.renewLastScreenshot()}),[r.isSettingsOpened]);var o=_c(Object(i.useState)(r.isSettingsOpened),2),l=(o[0],o[1]);Object(i.useEffect)((function(){setTimeout((function(){return l(r.isSettingsOpened)}))}),[r.isSettingsOpened]);var s=Object(i.useCallback)((function(e){var t=Array.from(document.querySelectorAll("#settings-container, #react-aria-modal-dialog, .pages-panel-settings-overlay, .template-center, #my-templates-modal, .constructor-navigation-arrows, body > .popups, .code-editor-modal-overlay"));e.target&&document.body.contains(e.target)&&!t.find((function(t){return t&&t.contains(e.target)}))&&r.dispatch({type:a.CloseSettingsSidebar})}),[]);Object(i.useEffect)((function(){return r.isSettingsOpened?window.addEventListener("click",s):window.removeEventListener("click",s),function(){window.removeEventListener("click",s)}}),[r.isSettingsOpened]);var d=r.isSettingsOpened||r.inPreview&&r.isMagMenuOpen?r.isTrashOpened||r.isPageSettingsOpened?"translateX(-480px)":r.inPreview&&"horizontal"===r.magMenuOrientation?"translateY(-184px)":"translateX(-240px)":"translate(0px, 0px)",p=!r.inPreview,f=r.magMenuOn&&!r.controlsOnTop,m=Object(_.d)(p,null,{immediate:f,config:{duration:f?0:200},from:{opacity:0},enter:{opacity:1},leave:{opacity:0}});return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ac,{transform:d,_css4:r.inPreview?St+1:St-2}),!r.inPreview&&c.a.createElement(ni,{transform:d}),m.map((function(e){var t=e.item,r=e.key,n=e.props;return t&&c.a.createElement(_.a.div,{style:n,key:r},c.a.createElement(Rc,{_css5:St+1,_css6:d,_css7:xt},c.a.createElement(qo,null)))})),c.a.createElement(Tc,{id:"constructor-settings-sidebar",width:240,height:"100%",position:"fixed",top:"0",right:"0",bottom:"0",zIndex:St,_css8:r.isSettingsOpened?r.isTrashOpened||r.isPageSettingsOpened?"-240px":"0px":"240px",_css9:xt},c.a.createElement(u.m,{width:240,height:"100%",pt:Object(Ut.a)("constructor.newSettingsMenu")?0:2,bg:"lightGray",color:"black"},c.a.createElement(u.m,{id:"settings-popup-container",position:"absolute",top:"0",left:"0",width:"100%"}),Object(Ut.a)("constructor.newSettingsMenu")?c.a.createElement(W,null):c.a.createElement(B,{projectSettingsPanel:t}),Object(Ut.a)("constructor.newSettingsMenu")&&r.isProjectSettingsOpened?c.a.createElement(Qt,{projectSettingsPanel:t}):c.a.createElement(Kn,null)),c.a.createElement(Ic,{show:r.isPageSettingsOpened})),c.a.createElement(la,null),c.a.createElement(to,null),c.a.createElement(si,null),r.isTeamworkModalOpened?c.a.createElement(xc,{projects:n.teamworkProjects,allProjects:n.allProjects,myTeam:n.team,sharedTeam:[],user:n.me,show:!0,onExit:function(){r.dispatch({type:a.ToggleTeamworkModal,payload:!1})},sharedMode:vc.ByMe,onTeammateAdd:function(e){n.updateTeam([].concat(Ec(n.team),[e]),n.project.num_id)},onTeammateRemove:function(e){n.updateTeam(Ec(n.team.filter((function(t){return t._id!==e._id}))),n.project.num_id)},onTeammateUpdate:function(e){n.updateTeam(Ec(n.team.map((function(t){return t._id===e._id?e:t}))),n.project.num_id)}}):null,((Object(Ut.a)("constructor.newSettingsMenu")?r.isOldProjectSettingsOpened:r.isProjectSettingsOpened)||r.isUserTemplatesModalShown||r.isTeamworkModalOpened||r.isRmTemplatesModalShown)&&c.a.createElement(Mc,{zIndex:7149,onClick:function(){r.isUserTemplatesModalShown?r.dispatch({type:a.ToggleUserTemplatesModal}):r.isRmTemplatesModalShown&&r.dispatch({type:a.ToggleRmTemplatesModal})},_css10:r.isProjectSettingsOpened?"rgba(0, 0, 0, 0.88)":"rgba(0, 0, 0, 0)"}))},Dc=r("w2my"),zc=r("DqjY"),Uc=r("phNm"),Fc=r("RJ1l"),Bc=r("rFsW");function Lc(e){return(Lc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gc(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Hc(e){var t=function(e,t){if("object"!==Lc(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Lc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Lc(t)?t:String(t)}function Wc(e,t,r,n,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,a)}function Vc(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Wc(o,n,a,i,c,"next",e)}function c(e){Wc(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Yc(e){return function(e){if(Array.isArray(e))return Zc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Jc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$c(Object(r),!0).forEach((function(t){qc(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function qc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||Jc(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jc(e,t){if(e){if("string"==typeof e)return Zc(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Zc(e,t):void 0}}function Zc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Qc=c.a.createContext({}),el=Bc.a.throttle(ke.w,500),tl=function e(t,r){var n=[];for(var a in t)if(t[a].parentPage===r){var o=e(t,t[a]._id),i=Object.assign({},t[a]);o.length&&(i.children=o),n.push(i)}else if(void 0===t[a].parentPage){var c=Object.assign({},t[a]);n.push(c)}return n},rl=function(e,t){var r={};return e.forEach((function(e,n){if(r[e._id]={collapsed:!t[e._id]||t[e._id].collapsed,viewNum:n+1,uri:e.uri?e.uri:(n+1).toString(),children:[]},e.children){var a=[];e.children.forEach((function(n,o){a.push(n._id),r[n._id]={collapsed:!t[n._id]||t[n._id].collapsed,viewNum:o+1,uri:n.uri?n.uri:(o+1).toString(),children:[],parentId:e._id}})),r[e._id].children=a}})),r},nl=function(){return["title","description","user","folder","uri","domain","last_checked_domain","has_deleted_pages","master_share_pid","changed","is_published","is_private","pass","pass_bg","published","opts"].map((function(e){return"change:".concat(e)})).join(" ")},al=function(){return["screenshot","title","uri","seo","hidden","custom_shares"].map((function(e){return"change:".concat(e)})).join(" ")},ol=function(e){var t=e.project,r=e.router,n=e.children,a=Kc(Object(i.useState)(null),2),o=a[0],l=a[1],s=function(e){var t=Xc({},e.attributes);return delete t.children,t},u=Kc(Object(i.useState)((function(){var e=t.pages.models.map((function(e){return s(e)}));e.sort((function(e,t){return e.num-t.num}));var n=tl(e,null);return{project:t.attributes,isOwner:!!r.isOwner,inPreview:!1,pages:e,trashPages:[],pageRecentlyDeleted:!1,userTemplates:[],currentPageNum:r.getCurrentPageNum(),currentPageId:r.getCurrentPageId(),pagesTree:n,pagesParams:rl(n,{}),pagesListContainer:null,settingsBody:null,popupContainer:null,codeInjectUpgradeAlertShown:!1,publishInProgress:!1,unpublishInProgress:!1,isPublishError:!1,selectedPages:[],lockedPages:{},collaborators:[],team:[],allProjects:[],teamworkProjects:[],projectTeam:[],me:r.me.attributes,isNewSettingsMenu:Object(Ut.a)("constructor.newSettingsMenu")}})),2),d=u[0],p=u[1],m=function(e){if(o){var t=o.querySelector('.page-list-item[data-page-id="'.concat(e,'"]'));t&&setTimeout((function(){t.scrollIntoView({block:"nearest"})}),100)}};Object(i.useEffect)((function(){var e=document.getElementById("settings-container");e&&l(e);var t=document.getElementById("page-list-container"),r=document.getElementById("project-settings-body"),n=document.getElementById("settings-popup-container");t&&p((function(e){return Xc(Xc({},e),{},{pagesListContainer:t,settingsBody:r,popupContainer:n})}))}),[]);var g=Kc(Object(i.useState)(null),2),b=g[0],h=g[1],y=function(e){b&&b.remove();var t=new fr.default({$parent:document.querySelector("body > .popups"),router:window.RM.constructorRouter,opts:{type:"type-more-pages",is_contributor:!window.RM.constructorRouter.isOwner,owner_email:d.project.user?d.project.user.email:""},alert_source:e});t.render(),h(t)},v={projectSet:function(e,r){return t.set(e,r)},projectUnset:function(e,r){return t.unset(e,r)},projectSave:function(e,r){return t.save(e,r)},pageSet:function(e,r,n){var a=t.pages.get(e);if(!a)throw new Error("Element not found");return a.set(r,n)},pageUnset:function(e,r,n){var a=t.pages.get(e);if(!a)throw new Error("Element not found");return a.unset(r,n)},pageSave:function(e,r,n){var a=t.pages.get(e);if(!a)throw new Error("Element not found");return a.save(r,n)},setCurrentPageNum:function(e){p((function(t){return Xc(Xc({},t),{},{currentPageNum:e})}))},setInPreview:function(e){p((function(t){return Xc(Xc({},t),{},{inPreview:e})}))},setPageCollapse:function(e,t){p((function(r){return Xc(Xc({},r),{},{pagesParams:Xc(Xc({},r.pagesParams),qc({},e,Xc(Xc({},r.pagesParams[e]),{},{collapsed:t})))})}))},scrollToPage:function(e){m(e)},addNewPage:function(e,n,a){return new Promise((function(o,i){var c=x(e,d.pages,d.pagesTree,d.pagesParams),l=c.newPageNum,s=c.newPageParentId,u={num:l};n&&(u=Xc(Xc({},u),n)),t.addPage(u,(function(e){if(e&&e.err)i(e);else{var c=e;n||(c.isEmptyPage=!0),c.set("parentPage",s),r.pageOrder.reorderPagesAfterAdd({page:c,magId:t.get("_id")}),t.onAdd(c),n&&(c.from_template=!0),a||(r.showWorkspace({id:c.id}),m(c.id)),o(c)}}),!0)}))},duplicatePage:function(e){return new Promise((function(n,a){var o=t.getPage(e);if(!o)return a(new Error("Could not find page"));o.get("mid")||o.save({mid:t.get("_id")},{silent:!0});var i=x(o.get("num"),d.pages,d.pagesTree,d.pagesParams),c=i.newPageNum,l=i.newPageParentId;o.duplicate((function(e){if(e instanceof Error)return"Server error: permission_denied"===e.message&&y("duplicate page"),a(e);var o=e;o.set("parentPage",l),r.pageOrder.reorderPagesAfterAdd({page:o,magId:t.get("_id")}),t.onAdd(o),r.gg.guides.model&&(r.gg.guides.model.addPage(o.id,{silent:r.gg.guides.hidden}),r.gg.guides.model.save()),r.showWorkspace({id:o.id}),m(o.id),n(e)}),{num:c})}))},renewLastScreenshot:function(){return Vc(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=r._pageChanged)||"string"!=typeof t){e.next=5;break}return r._pageChanged=!1,e.next=5,v.updatePageScreenshot(t);case 5:case"end":return e.stop()}}),e)})))()},updatePageScreenshot:function(e){return Vc(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(ke.g)(t.get("num_id"),e);case 2:n=r.sent,(a=t.pages.find((function(t){return t.attributes._id===e})))&&a.save&&a.save({screenshot:n},{patch:!0,skipMagChanging:!0,skipHistory:!0});case 5:case"end":return r.stop()}}),r)})))()},saveOrder:function(e){return new Promise((function(n,a){r.pageOrder.saveInProgress()||(r.pageOrder.save({order:e,mid:r.mag.id},{success:function(){t.trigger("change:pids",t,t.get("pids")),n()},error:a}),t.trigger("change:pids",t,t.get("pids")))}))},deletePage:function(e){return new Promise((function(n,a){if(r.isPageLocked(e))return a(new Error("This page is locked"));if(1===t.get("pids").length)return a(new Error("Can't delete last page"));var o=d.pagesParams[e],i=[];if(o&&o.children.length){var c=o.children;o.collapsed?r.pageOrder.removeParentIds(c):i=Yc(c)}if(i.push(e),!t.checkDeletingPages(i))return a(new Error("Can't delete all pages"));var l=i.includes(d.currentPageId),s=d.currentPageNum;r.pageOrder.deletePagesFromOrder(i,t.get("_id")).then((function(){t.deletePages(i,(function(e){e instanceof Error?(r.pageOrder.load(t),a(e)):e&&e.deleteNotEmptyPages&&A(),l?function(e){var t=r.pageOrder.get("order"),n=null;if(e>t.length)n=t[t.length-1].id;else{var a=t.find((function(t){return t.num===e}));a&&(n=a.id)}n?(r.showWorkspace({id:n}),m(n)):r.showWorkspace({num:1})}(s):r.triggerPageChange(),i.forEach((function(e){return r.removeWorkspace(e)})),n()}))}),(function(e,t){a(new Error(t))}))}))},restorePage:function(e){return new Promise((function(n,a){t.restorePage(e,{success:function(e){var a=x(r.workspace.getPageNum(),d.pages,d.pagesTree,d.pagesParams),o=a.newPageNum,i=a.newPageParentId;e.set("num",o),e.set("parentPage",i),r.pageOrder.reorderPagesAfterAdd({page:e,magId:t.get("_id")}),t.onAdd(e),t.save(),r.showWorkspace({id:e.id}),m(e.id),n(e)},error:function(e){var t=JSON.parse(e.responseText);"permission_denied"===t.err&&y("restore page"),a(t)}},!0)}))},deletePagesFromTrash:function(e){return t.deleteTrashPages(e)},updateTrash:function(){return new Promise((function(e,r){t.get("has_deleted_pages")?t.fetchTrashPages().then((function(t){t&&p((function(e){return Xc(Xc({},e),{},{trashPages:t})})),e(t)})):e([])}))},emptyTrash:function(){return t.emptyTrash().then((function(){p((function(e){return Xc(Xc({},e),{},{trashPages:[]})}))}))},getUserTemplates:function(){return t.loadUserTemplates().then((function(e){return Array.isArray(e)&&p((function(t){return Xc(Xc({},t),{},{userTemplates:e})})),e}))},createTemplateFromCurrentPage:function(){return r.createTemplateFromCurrentPage().then((function(e){return e&&p((function(t){var r=Array.from(t.userTemplates);return r.unshift(e),Xc(Xc({},t),{},{userTemplates:r})})),e})).catch((function(e){throw e&&"permission denied"===e.message&&y("create user template"),e}))},deleteUserTemplate:function(e){return Object(ke.d)(e).then((function(){p((function(t){return Xc(Xc({},t),{},{userTemplates:t.userTemplates.filter((function(t){return t.id!==e}))})}))}))},validatePageUri:function(e,r,n){var a={hyphen:"The link cannot begin or end with a hyphen",onlyNumbers:"The link cannot be numeric",uriLength:"The link’s max length is 128 characters",used:"This link is already used",pageNotFound:"Can't find current page"},o=t.getPage(e);if(o){var i=o.validate({uri:r,parentPage:o.get("parentPage")});return n&&i&&(delete i.onlyNumbers,delete i.hyphen),i?a[Object.keys(i)[0]]:void 0}return a.pageNotFound},updateUsedFonts:function(){return Vc(regeneratorRuntime.mark((function e(){var r,n,a,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.getUsedFonts({includeCustom:!0,excludeUnusedDefault:Object(Ut.a)("constructor.loadOnlyUsedFonts")}),n=zc.a.sortFontsByProvider(r),a=n.typekit,o=n.custom,i=n.dictionary,e.abrupt("return",Object(ke.v)(t.id,Object(Ut.a)("constructor.loadOnlyUsedFonts")?i:{used_typekit_fonts:a,used_custom_fonts:o},!0));case 3:case"end":return e.stop()}}),e)})))()},publish:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Vc(regeneratorRuntime.mark((function n(){var a,o,i,c,l,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e.skipCodeInjectionAlert,o=!r.isOwner,i=t.get("user").email,c=t.get("user").permissions||{},l=Uc.b.hasEcommerceWidget($.a.environment.preview,t.getAllWidgets()),c.can_publish&&(!l||c.can_use_e_commerce)){n.next=9;break}Dc.default.showUpgradeAlert(r,{type:Dc.default.getPublishUpgradeAlertType(c,l),source:"publish",ownerEmail:i,isContributor:o}),n.next=33;break;case 9:if(Dc.default.canInjectCode(r,t)||d.codeInjectUpgradeAlertShown||a){n.next=14;break}Dc.default.showCodeInjectionAlert(r,{isContributor:o,ownerEmail:i,onSkip:function(){return v.publish({skipCodeInjectionAlert:!0})}}),p((function(e){return Xc(Xc({},e),{},{codeInjectUpgradeAlertShown:!0})})),n.next=33;break;case 14:if(d.publishInProgress){n.next=33;break}return p((function(e){return Xc(Xc({},e),{},{publishInProgress:!0})})),Pe.d.sendEvent(t.get("is_published")?Pe.b.RepublishMag:Pe.b.PublishMag,{eventLabel:"preview"}),n.prev=17,n.next=20,v.updateUsedFonts();case 20:return n.next=22,Object(ke.t)(t.get("num_id"));case 22:s=n.sent,t.set(Xc(Xc({},t.parse(s)),{},{changed:!1})),p((function(e){return Xc(Xc({},e),{},{publishInProgress:!1})})),n.next=33;break;case 27:return n.prev=27,n.t0=n.catch(17),p((function(e){return Xc(Xc({},e),{},{publishInProgress:!1,isPublishError:!0})})),n.next=32,new Promise((function(e){return setTimeout(e,5e3)}));case 32:p((function(e){return Xc(Xc({},e),{},{isPublishError:!1})}));case 33:case"end":return n.stop()}}),n,null,[[17,27]])})))()},publishWithNotice:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Vc(regeneratorRuntime.mark((function n(){var a,o,i,c,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=t.get("user").permissions||{},o=Uc.b.hasEcommerceWidget($.a.environment.preview,t.getAllWidgets()),a.can_publish){n.next=8;break}throw i=a._reasons||{},c=i.can_publish&&i.can_publish.code,new te({message:"reason_publish_limit"===c?"Please upgrade your account to publish more than one project.":"Please verify your email address to publish this project.",tag:"reason_publish_limit"===c?Z.freePublishLimit:Z.unconfirmedEmail});case 8:if(!o||a.can_use_e_commerce){n.next=12;break}throw new te({message:"Please upgrade your account to publish project with ecommerce.",tag:Z.ecommerce});case 12:if(Dc.default.canInjectCode(r,t)||e.skipWarnings){n.next=16;break}throw new te({message:"Injected Code and Shots will not work in Published project.",tag:Z.customCode,type:"warning"});case 16:if(Dc.default.canUseShots(r,t)||e.skipWarnings){n.next=18;break}throw new te({message:"Injected Code and Shots will not work in Published project.",tag:Z.shots,type:"warning"});case 18:if(d.publishInProgress){n.next=37;break}return p((function(e){return Xc(Xc({},e),{},{publishInProgress:!0})})),Pe.d.sendEvent(t.get("is_published")?Pe.b.RepublishMag:Pe.b.PublishMag,{eventLabel:d.inPreview?"preview":"settings"}),n.prev=21,n.next=24,v.updateUsedFonts();case 24:return n.next=26,Object(ke.t)(t.get("num_id"));case 26:l=n.sent,t.set(Xc(Xc({},t.parse(l)),{},{changed:!1})),p((function(e){return Xc(Xc({},e),{},{publishInProgress:!1})})),n.next=37;break;case 31:return n.prev=31,n.t0=n.catch(21),p((function(e){return Xc(Xc({},e),{},{publishInProgress:!1,isPublishError:!0})})),n.next=36,new Promise((function(e){return setTimeout(e,5e3)}));case 36:p((function(e){return Xc(Xc({},e),{},{isPublishError:!1})}));case 37:case"end":return n.stop()}}),n,null,[[21,31]])})))()},unpublish:function(){return Vc(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d.unpublishInProgress){e.next=6;break}return p((function(e){return Xc(Xc({},e),{},{unpublishInProgress:!0})})),Pe.d.sendEvent(Pe.b.UnpublisMag),e.next=5,Object(ke.D)(t.get("num_id"));case 5:t.set({is_published:null,published:null,updated:null});case 6:case"end":return e.stop()}}),e)})))()},restoreToPublished:function(){return Vc(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ke.u)(t.get("num_id"));case 2:window.location.reload();case 3:case"end":return e.stop()}}),e)})))()},showPDFExportModal:function(){if(!v.hasPermission(q.canExportPDF))throw new te({message:c.a.createElement(c.a.Fragment,null,"Please upgrade your account",c.a.createElement("br",null),"to export the project to PDF.",c.a.createElement("br",null),c.a.createElement("a",{href:"/pricing",className:"learn-more"},"See the pricing")),tag:Z.pdfExport});new Fc.a({parent:document.querySelector("body > .popups"),email:r.me&&r.me.get("email"),mag_num_id:t.get("num_id")}).render()},checkHTMLExportPermission:function(){if(!v.hasPermission(q.canExportCode))throw new te({message:c.a.createElement(c.a.Fragment,null,"Please upgrade your account",c.a.createElement("br",null),"in order to export the source",c.a.createElement("br",null),"code of your projects.",c.a.createElement("br",null),c.a.createElement("a",{href:"/pricing",className:"learn-more"},"See the pricing"),"."),tag:Z.htmlExport})},openCodeEditor:function(){r.openCodeEditor()},hasProjectCode:function(){return["ci_head","ci_css","ci_body_top","ci_body_bottom"].some((function(e){return!!d.project[e]}))},hasCustomCode:function(){return t.hasCodeInjection()},hasShots:function(){return t.hasShotsWidgets()},hasPermission:function(e){return r.me&&r.me.get("permissions")[e]},selectPagesRange:function(e){p((function(t){var n=t.lastSelectedPage&&t.selectedPages.includes(t.lastSelectedPage)?t.lastSelectedPage:r.getCurrentPageId();if(n){var a=t.pagesTree.reduce((function(e,t){return e.push(t),t.children?e.concat(t.children):e}),[]),o=a.findIndex((function(t){return t._id===e})),i=a.findIndex((function(e){return e._id===n})),c=a.slice(Math.min(o,i),Math.max(o,i)+1).map((function(e){return e._id})).filter((function(e){return!t.selectedPages.includes(e)})),l=[].concat(Yc(t.selectedPages),Yc(c));return Xc(Xc({},t),{},{selectedPages:l,lastSelectedPage:e})}return Xc(Xc({},t),{},{lastSelectedPage:e})}))},selectPage:function(e){p((function(t){var r=Yc(t.selectedPages);return r.includes(e)?r.splice(r.indexOf(e),1):r.push(e),Xc(Xc({},t),{},{selectedPages:r,lastSelectedPage:e})}))},deselectPages:function(){p((function(e){return Xc(Xc({},e),{},{selectedPages:[]})}))},takeOverCurrentPage:function(){var e=r.getCurrentPageId(),n=t.pages.find((function(t){return t.attributes._id===e}));r.unlockPage(n)},updateUrl:function(){r.updateUrl(),r.triggerPageChange()},changeWorkspace:function(e){r.showWorkspace(e)},loadTeamworkData:function(e){return Vc(regeneratorRuntime.mark((function t(){var r,n,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,$i.a.get("/api/team");case 2:return r=t.sent,t.next=5,$i.a.get("/api/readymags/user");case 5:return n=t.sent,a=n.mags,t.abrupt("return",{team:r,allProjects:a,teamworkProjects:a.filter((function(t){return t.num_id===e})),projectTeam:r.filter((function(t){return t.projectNumIds.includes(e)}))});case 8:case"end":return t.stop()}}),t)})))()},updateTeam:function(e,t){p((function(r){return Xc(Xc({},r),{},{team:e,projectTeam:e.filter((function(e){return e.projectNumIds.includes(t)}))})}))},loadUserProjectsLinks:function(e,t){var n=e||(r.me?r.me.get("_id"):"");return Object(ke.m)(n,t||{})},setProjectPrivacy:function(e){var r=t.get("num_id");return e.numId&&(r=e.numId,delete e.numId),Object(ke.A)(r,e.isPrivate,e.password).then((function(){var r=e.isPrivate,n=e.password,a=n||t.get("pass");t.set({is_private:r,pass:a})}))},setProjectOptions:function(e,r){return Vc(regeneratorRuntime.mark((function n(){var a,o,i,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=Object.keys(e)[0],o=Object.values(e)[0],i=Xc(Xc({},e),!1===e.menubutton&&{projectinfo:!1}),c=Xc(Xc({},d.project.opts),i),["arrows","menubutton","projectinfo","sharebutton","pagecounter","controlsontop","controlsontop","endpage","slidein","scalableviewer"].includes(a)?window.RM.analytics&&window.RM.analytics.sendEvent("Viewer Options Toggle","".concat(a," ").concat(o?"on":"off")):"viewertype"===a&&window.RM.analytics&&window.RM.analytics.sendEvent("Viewer Type Toggle",o),t.set("opts",Xc(Xc({},t.get("opts")),i),r),n.abrupt("return",el(t.get("num_id"),c));case 7:case"end":return n.stop()}}),n)})))()},checkDomain:function(e){var t=this;return Object(ke.a)(d.project.num_id,e).then((function(r){return t.projectSet({last_checked_domain:e},{silent:!0}),r}))},mapDomain:function(e){var t=this;return Object(ke.q)(d.project.num_id,e).then((function(r){return t.projectSet({domain:e},{silent:!0}),r}),(function(e){throw console.log("errorData",e),new Error("server error")}))},unmapDomain:function(){var e=this;return Object(ke.C)(d.project.num_id).then((function(t){return e.projectUnset("domain",{silent:!0}),t}),(function(e){throw console.log("errorData",e),new Error("server error")}))}},w=function(e,t){e&&p((function(r){var n=e.pages.models.map((function(e){return s(e)})).filter((function(e){return t.includes(e._id)}));n.sort((function(e,t){return e.num-t.num}));var a=tl(n,null);return Xc(Xc({},r),{},{project:e.attributes,pages:n,pagesTree:a,pagesParams:rl(a,r.pagesParams)})}))},j=function(e,t){e&&p((function(t){return Xc(Xc({},t),{},{project:e.attributes})}))},S=function(e){e&&(e.changed&&(e.changed.num||e.changed.parentPage)||p((function(t){var r=function(e,t){var r=t.findIndex((function(t){return t._id===e.get("_id")}));if(r>=0){var n=Yc(t);return n[r]&&(n[r]=s(e)),n}return t}(e,t.pages);r.sort((function(e,t){return e.num-t.num}));var n=tl(r,null);return Xc(Xc({},t),{},{pages:r,pagesTree:n,pagesParams:rl(n,t.pagesParams)})})))},O=function(e){e&&p((function(t){var r=Array.from(t.trashPages);return r.unshift(e.attributes),Xc(Xc({},t),{},{trashPages:r})}))},E=function(e){e&&p((function(t){var r=Array.from(t.trashPages),n=r.findIndex((function(t){return t._id===e.get("_id")}));return n>-1&&r.splice(n,1),Xc(Xc({},t),{},{trashPages:r})}))};Object(i.useEffect)((function(){return t.on(nl(),j),t.on("change:pids",w),t.pages.on(al(),S),t.trashPages.on("add",O),t.trashPages.on("remove",E),v.loadTeamworkData(t.attributes.num_id).then((function(e){p((function(t){return Xc(Xc({},t),e)}))})),function(){t.off(nl(),j),t.off("change:pids",w),t.pages.off(al(),S),t.trashPages.off("add",O),t.trashPages.off("remove",E)}}),[t]);var _=function(e){p((function(t){return Xc(Xc({},t),{},{currentPageNum:e.getPageNum(),currentPageId:e.getPageId()})}))};Object(i.useEffect)((function(){return r.on("pageChange",_),function(){r.off("pageChange",_)}}),[r]);var P,C=Object(i.useCallback)((function(e,t){p((function(r){return Xc(Xc({},r),{},{lockedPages:Xc(Xc({},r.lockedPages),{},qc({},e,t))})}))}),[]),k=Object(i.useCallback)((function(e){p((function(t){var r=t.lockedPages,n=(r[e],Gc(r,[e].map(Hc)));return Xc(Xc({},t),{},{lockedPages:n})}))}),[]),I=Object(i.useCallback)((function(e){var t=e.list;p((function(e){return Xc(Xc({},e),{},{collaborators:t||[]})}))}),[]);Object(i.useEffect)((function(){return f.a.on("page:locked",C),f.a.on("page:unlocked",k),f.a.on("sockets:connect",I),function(){f.a.off("page:locked",C),f.a.off("page:unlocked",k),f.a.off("sockets:connect",I)}}),[C,k]);var A=function(){p((function(e){return Xc(Xc({},e),{},{pageRecentlyDeleted:!0})})),P&&clearTimeout(P),P=setTimeout((function(){R()}),3e3)},R=function(){p((function(e){return Xc(Xc({},e),{},{pageRecentlyDeleted:!1})}))};return c.a.createElement(Qc.Provider,{value:Xc(Xc({},d),v)},n)},il=function(e){var t=e.model,r=e.domElement,n=e.router,a=e.projectSettingsPanel;s.a.render(c.a.createElement(u.Ab,null,c.a.createElement(ol,{project:t,router:n},c.a.createElement(O,{magModel:t,router:n},c.a.createElement(So,{model:t},c.a.createElement(Nc,{projectSettingsPanel:a}))))),r)},cl=function(e){var t=e.constructorModel,r=e.domElement,n=e.router,a=e.viewerModel;s.a.render(c.a.createElement(u.Ab,null,c.a.createElement(ol,{project:t,router:n},c.a.createElement(O,{magModel:t,router:n},c.a.createElement(So,{model:a},c.a.createElement(ul,null))))),r)},ll=function(e){s.a.unmountComponentAtNode(e),e&&e.parentNode&&e.parentNode.removeChild(e)},sl=Object(o.e)(Ho).withConfig({displayName:"SettingsController___StyledToolbar"})(["z-index:",";"],(function(e){return e._css})),ul=function(){var e=Object(i.useContext)(v),t=e.inPreview&&e.isMagMenuOpen?"horizontal"===e.magMenuOrientation?"translateY(-184px)":"translateX(-240px)":"translate(0px, 0px)";return c.a.createElement(sl,{previewOnly:!0,transform:t,_css:St+1})};r.d(t,"ProjectContext",(function(){return Qc})),r.d(t,"ProjectContextProvider",(function(){return ol})),r.d(t,"renderSettings",(function(){return il})),r.d(t,"renderPreviewToolbar",(function(){return cl})),r.d(t,"destroyElement",(function(){return ll})),r.d(t,"GridSize",(function(){return n})),r.d(t,"SettingsActionTypes",(function(){return a})),r.d(t,"SettingsContext",(function(){return v})),r.d(t,"CreateSettingsContextProvider",(function(){return O}))},hB7q:function(e,t,r){"use strict";r.r(t),r.d(t,"CodeExportModalWithContext",(function(){return m}));var n=r("vOnD"),a=r("q1tI"),o=r.n(a),i=r("8AXF"),c=r("wEEd"),l=r("iC7s");function s(e,t,r,n,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,a)}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var p=Object(n.e)(l.C).withConfig({displayName:"export___StyledFlex"})(["transition:margin-left 0.35s ease-in-out;"]),f=function(e){var t=e.numId,r=e.email,n=void 0===r?"your email":r,i=e.onDestroyed,d=u(Object(a.useState)(""),2),f=d[0],m=d[1],g=u(Object(a.useState)(!1),2),b=g[0],h=g[1],y=u(Object(a.useState)(!0),2),v=y[0],w=y[1],j=u(Object(a.useState)(!1),2),S=j[0],O=j[1],x=u(Object(a.useState)(!1),2),E=x[0],_=x[1],P=Object(c.d)(v,null,{from:{top:0,left:0,width:"100%",height:"100%",zIndex:9999,position:"absolute",opacity:0},enter:{opacity:1},leave:{opacity:0},onDestroyed:function(){i&&i()}}),C=function(){w(!1)},k=function(e){e.target===e.currentTarget&&C()},I=function(){var e,r=(e=regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),f&&!b){e.next=3;break}return e.abrupt("return");case 3:return h(!0),e.prev=4,e.next=7,fetch("/api/mag/".concat(t,"/export?origin=").concat(f));case 7:h(!1),_(!0),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(4),h(!1),O(!0),setTimeout((function(){O(!1)}),5e3);case 16:case"end":return e.stop()}}),e,null,[[4,11]])})),function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){s(o,n,a,i,c,"next",e)}function c(e){s(o,n,a,i,c,"throw",e)}i(void 0)}))});return function(e){return r.apply(this,arguments)}}(),A=o.a.createElement(l.m,{width:"100%"},o.a.createElement(l.m,{p:"0 32px"},o.a.createElement("div",{className:"message"},"Please provide a full URL where the project will be hosted. ",o.a.createElement("br",null)," Typekit fonts will only work on this domain."),o.a.createElement("form",{onSubmit:I},o.a.createElement("input",{className:"domain-input",type:"text",placeholder:"domain.com or domain.com/page",value:f,onChange:function(e){return m(e.target.value)},disabled:b}),o.a.createElement("button",{className:"download ".concat(S?"error":""," ").concat(b?"preloader":""),type:"submit",disabled:S||!f},o.a.createElement("span",null,S?"Error":"Create Export"),o.a.createElement("div",{className:"rmpreloader"},o.a.createElement("div",{className:"arc"})))),o.a.createElement("ul",{className:"alerts"},o.a.createElement("li",{className:"alert-item alert-forms"},o.a.createElement("div",{className:"alert-item-icon"},o.a.createElement("span",{className:"notification-sign"},"!")),o.a.createElement("div",{className:"alert-text"},"1. Forms will not send submitted data to emails, Google Docs, or Mailchimp. Only URL option will work.",o.a.createElement("br",null),"2. In an exported project, sharing customization per page won’t work. Instead, first page settings would be used for the whole project.",o.a.createElement("br",null),"3. Exported projects can’t be password-protected.",o.a.createElement("br",null),o.a.createElement("a",{href:"https://help.readymag.com/hc/en-us/articles/360020647452-Code-export",className:"alert-learn-more",target:"_blank",rel:"noopener noreferrer"},"Learn more")))))),R=o.a.createElement(l.C,{width:"100%",height:"100%",justifyContent:"center",alignItems:"center"},o.a.createElement(l.m,{width:240},o.a.createElement("div",{className:"message"},"Your project is being converted.",o.a.createElement("br",null),"We will send you the download link",o.a.createElement("br",null),"to ",n," when it’s ready."),o.a.createElement("button",{className:"download",onClick:C},o.a.createElement("span",null,"Done"))));return o.a.createElement(o.a.Fragment,null,P.map((function(e){var t=e.item,r=e.key,n=e.props;return t&&o.a.createElement(c.a.div,{key:r,style:n},o.a.createElement("div",{className:"export-code-popup",style:{opacity:1},role:"dialog","aria-labelledby":"export-code-title","aria-modal":"true"},o.a.createElement("div",{className:"panel-wrapper",onClick:k},o.a.createElement("div",{className:"close",onClick:C}),o.a.createElement("div",{className:"panel ".concat(E?"panel-done":"")},o.a.createElement("div",{id:"export-code-title",className:"header"},"Export code"),o.a.createElement(p,{width:"200%",ml:E?"-100%":0},A,R)))))})))},m=function(){var e=Object(a.useContext)(i.BackboneContext),t=e.model,r=e.destroy;return(o.a.createElement(f,{numId:t.num_id,email:t.user&&t.user.email,onDestroyed:r}))};t.default=f},tyue:function(e,t,r){e.exports=r.p+"9cc31e7b4a5f7e87355c71b496221174.jpg"}}]);